<!DOCTYPE html>
<!-- saved from url=(0088)https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/ -->
<html lang="en-US" class=" js csstransforms3d csstransitions"><script type="text/javascript" async="" src="./Autoregression Models for Time Series Forecasting With Python_files/client.js.download"></script><script id="twitter-wjs" src="./Autoregression Models for Time Series Forecasting With Python_files/widgets.js.download"></script><script id="twitcount_plugins" src="./Autoregression Models for Time Series Forecasting With Python_files/twitcount.js.download"></script><script type="text/javascript" async="" src="./Autoregression Models for Time Series Forecasting With Python_files/9556588.js.download"></script><script src="./Autoregression Models for Time Series Forecasting With Python_files/834324500844861" async=""></script><script async="" src="./Autoregression Models for Time Series Forecasting With Python_files/fbevents.js.download"></script><script type="text/javascript">// Promises 													
var _tp_promises = {};														
//Get Message From content script 											
window.addEventListener("message", function(event) { 						
		if(event.source !== window) return;			 						
		if(event.data.src && (event.data.src === "content.js")) { 			
			console.log("Page received: "); 								
			console.log(event.data); 										
			// Get the promise												
			if(event.data.nonce) {											
				 var p = _tp_promises[event.data.nonce]; 					
				 // resolve													
				 if(event.data.status_cd === 1){							
					p.resolve(event.data.result);							
				 }else{														
				 	p.reject(new Error(event.data.result));					
				 }															
				 delete _tp_promises[event.data.nonce];						
			}else {  														
				console.log("No nonce in event msg");						
			}																
		}																	
	});																		
																			
    var SignerDigital= new TpCrypto();										
	function TpCrypto (){													
																			
	var OSName = GetOS();													
	var OSSupported = (OSName == "Windows" || OSName == "Linux") ? true : false; 
	function nonce() {														
	  var val = ""; 														
	  var hex = "abcdefghijklmnopqrstuvwxyz0123456789";	         			
	  for(var i = 0; i < 16; i++)							     			
		val += hex.charAt(Math.floor(Math.random() * hex.length));			
	  return val;															
	}																		
																			
	function messagePromise(msg) { 											
		return new Promise(async function(sdResolve, sdReject) { 			
			if (msg["action"] == "GenCSR" || msg["action"] == "ImportCER")	
			{																
			   if (!OSSupported)											
			   {																
				 sdReject(new Error(OSName + " OS Not Supported."));	
				 return;														
			   }																
				if(!(await checkSDEnrolledCA(msg["certIssuer"])))			
				{															
					sdReject(new Error("This Certifying Authority is not enrolled in Signer.Digital Browser Extension for Certificate Enrollment/Download. Contact your Certifying Authority."));	
					return;													
				}															
			}																
			// amend with necessary metadata 								
			msg["nonce"] = nonce(); 										
			msg["src"] = "user_page.js"; 									
			msg["browser"] = "chrome"; 										
			// send message 												
			window.postMessage(msg, "*"); 									
			// and store promise callbacks 									
			_tp_promises[msg.nonce] = {										
				resolve: sdResolve, 										
				reject: sdReject				 							
			}; 																
		}); 																
	}																		
																			
	async function checkSDEnrolledCA(certIssuer)							
	{																		
		var caList = ["AD5HAb+Ij2mmK1hTWpGGdK/xbGLtpQDerMJx35zmSJI=",	//CISPL Signer.Digital DEMO	
			//add Enrolled CA to this list	
					  "VQyiIqC/d6dSmSBWTgqLxDZzb5x9eQMKBlO/MdxjeqM=",	//SafeScrypt sub-CA for RCAI 
					  "s2fPQ4sVgi70hCFo9S5W2HIRXT7TXsX2CwNBcAHxdPk=",	//UAT - PantaSign CA 2014 
					  "tDnFOxBvx6hejWvsmFpNC6CulfWvekxWHiJKPac65Rw=",	//PantaSign CA 2014 
					  "bxNw5YwP/ythQXBuv6OhWOCuPOGq1P0mz1VvCaBpaXE="];	//IDSign sub CA for Consumers 2014 
		const sha256OfIssuer = await SDGetSha256(certIssuer);				
		if (caList.includes(sha256OfIssuer))								
			return true;													
		else																
			return false;													
	}																		
	async function SDGetSha256(message)										
	{																		
		// encode as UTF-8													
		const msgBuffer = new TextEncoder().encode(message);				
		// hash the message													
		const hashBuffer = await crypto.subtle.digest("SHA-256", msgBuffer);
		const bytes = new Uint8Array(hashBuffer);							
		var binary = "";													
		for (var i = 0; i < bytes.byteLength; i++) {						
			binary += String.fromCharCode(bytes[i]);						
		}																	
		return window.btoa(binary);											
	};																		
																			
	//Extension Action Methods												
	this.signGstHash = function(hash, certThumbPrint = "", x509RevocationMode = 0){					
		var msg= { action:"GSTReturnSign", hash:hash, certThumbPrint:certThumbPrint, x509RevocationMode:x509RevocationMode };	
		return messagePromise(msg);											
	}																		
	this.signITHash = function(hash, PAN, certThumbPrint = "", x509RevocationMode = 0){				
		var msg= { action:"ITReturnSign", hash:hash, PAN:PAN, certThumbPrint:certThumbPrint, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.signIceGate = function(b64Data, certThumbPrint = "", x509RevocationMode = 0){				
		var msg= { action:"IceGateSignJson", b64Data:b64Data, certThumbPrint:certThumbPrint, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.getSelectedCertificate = function(certThumbPrint = "", showExpired = false, keyUsageFilter = 128, x509RevocationMode = 0){					
		var msg= { action:"GetSelCertFromToken", certThumbPrint:certThumbPrint, showExpired:showExpired, keyUsageFilter:keyUsageFilter, x509RevocationMode:x509RevocationMode};		
		return messagePromise(msg);											
	}																		
	this.signPdfHash = function(hash,certThumbPrint,certAlgorithm, x509RevocationMode = 0){			
		var msg= { action:"PdfSignFromToken", hash:hash,certThumbPrint:certThumbPrint,hashAlgorithm:certAlgorithm, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.signAuthToken = function(authtoken, certAlgorithm, certThumbPrint = "", showExpired = false, x509RevocationMode = 0){			
		var msg= { action:"SignAuthToken", authToken:authtoken, hashAlgorithm:certAlgorithm, certThumbPrint:certThumbPrint, showExpired:showExpired, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.signHash = function(hash, certAlgorithm, certThumbPrint = "", x509RevocationMode = 0){		
		var msg= { action:"SignHash", hash:hash, hashAlgorithm:certAlgorithm, certThumbPrint:certThumbPrint };	
		return messagePromise(msg);											
	}																		
	this.signHashCms = function(hash, certAlgorithm, certIncludeOptions = 2, certThumbPrint = "", x509RevocationMode = 0){		
		var msg= { action:"SignHashCms", hash:hash, hashAlgorithm:certAlgorithm, certIncludeOptions:certIncludeOptions, certThumbPrint:certThumbPrint, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.signXML = function(xmlDoc, xmlSignParms, certThumbPrint, x509RevocationMode = 0){			
		var msg= { action:"SignXML", xmlDoc:xmlDoc, xmlSignParms:xmlSignParms, certThumbPrint:certThumbPrint, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.encryptB64Data = function(b64Data, useOAEPPadding, certThumbPrint = "", showExpired = false, keyUsageFilter = 32, x509RevocationMode = 0){			
		var msg= { action:"EncryptB64Data", b64Data:b64Data, useOAEPPadding:useOAEPPadding, certThumbPrint:certThumbPrint, showExpired:showExpired, keyUsageFilter:keyUsageFilter, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.decryptB64Data = function(b64Data, useOAEPPadding, certThumbPrint = "", showExpired = false, keyUsageFilter = 32, x509RevocationMode = 0){			
		var msg= { action:"DecryptB64Data", b64Data:b64Data, useOAEPPadding:useOAEPPadding, certThumbPrint:certThumbPrint, showExpired:showExpired, keyUsageFilter:keyUsageFilter, x509RevocationMode:x509RevocationMode};	
		return messagePromise(msg);											
	}																		
	this.getPCSCReaders = function(onlyConnected = true){				
		var msg= { action:"GetPCSCReaders", onlyConnected:onlyConnected};			
		return messagePromise(msg);											
	}																		
	this.genCSR = function(PKCS11Lib, certSubject, certIssuer, keyBits = 2048, hashAlgorithm = "SHA256", forceUserPinChangeIfDefault = false, extensions = null){				
		var msg= { action:"GenCSR", PKCS11Lib:PKCS11Lib, certSubject:certSubject, certIssuer:certIssuer, keyBits:keyBits, hashAlgorithm:hashAlgorithm, forceUserPinChangeIfDefault:forceUserPinChangeIfDefault, extensions:extensions};			
		return messagePromise(msg);											
	}																		
	this.importCer = function(PKCS11Lib, b64Payload, certIssuer){		
		var msg= { action:"ImportCER", PKCS11Lib:PKCS11Lib, b64Data:b64Payload, certIssuer:certIssuer};		
		return messagePromise(msg);											
	}																		
	this.getHostDetails = function(){										
		var msg= { action:"GetHostDetails"};								
		return messagePromise(msg);											
	}																		
	this.sm = function(msg){												
		return messagePromise(msg);											
	}																		
	this.OSName = GetOS();													
	this.OSSupported = (this.OSName == "Windows" || this.OSName == "Linux") ? true : false; 
	this.getPkcsLibByProvider = function(ProviderName)								
        {																	
            let winHashMap = new Map([										
                ["EnterSafe ePass2003 CSP v2.0", "eps2003csp11v2.dll"],		
                ["eToken Base Cryptographic Provider", "eTPKCS11.dll"],		
                ["PROXKey CSP India V1.0", "SignatureP11.dll"],				
                ["Bit4id Universal Middleware Provider", "bit4ipki.dll"],	
                ["mToken CryptoID CSP", "CryptoIDA_pkcs11.dll"] 			
            ]);																
            let linuxHashMap = new Map([									
                ["EnterSafe ePass2003 CSP v2.0", "libcastle_v2.so.1.0.0"],					
                ["eToken Base Cryptographic Provider", "libeTPkcs11.so"],				
                ["PROXKey CSP India V1.0", "libwdpkcs_SignatureP11.so"],							
                ["mToken CryptoID CSP", "libcryptoid_pkcs11.so"]							
            ]);																
			var providerNotEnrolledMsg = "Provider Not enrolled in Signer.Digital Browser Extension. Can still be used by passing pkcs#11 driver lib name in PKCS11Lib param."	 
            if (this.OSName == "Windows") {										
                if (ProviderName.startsWith("Microsoft"))					
                    return ProviderName;									
                else if (winHashMap.has(ProviderName))				
                    return winHashMap.get(ProviderName);					
				else														
					return providerNotEnrolledMsg; 	
            }																
            if (this.OSName = "Linux") {											
				if (linuxHashMap.has(ProviderName))							
					return linuxHashMap.get(ProviderName);					
				else														
					return providerNotEnrolledMsg; 							
			}																
			else {															
                return "OS Not Supported";									
            }																
        }																	
	this.getPkcsLibBySCName = function(SCName)								
        {																	
            let winHashMap = new Map([										
                ["HyperSecu ePass2003", "eps2003csp11v2.dll"],				
                ["SafeNet eToken", "eTPKCS11.dll"],							
                ["PROXKey Watchdata", "SignatureP11.dll"],					
                ["Bit4id tokenME", "bit4ipki.dll"],							
                ["Longmai mToken", "CryptoIDA_pkcs11.dll"],					
                ["Gemalto USB", ".dll"]						
            ]);																
            let linuxHashMap = new Map([									
                ["HyperSecu ePass2003", "libcastle_v2.so.1.0.0"],					
                ["SafeNet eToken", "/usr/lib/libeTPkcs11.so"],				
                ["PROXKey Watchdata", "/usr/lib/WatchData/ProxKey/lib/libwdpkcs_SignatureP11.so"],							
                ["Longmai mToken", "/opt/CryptoIDATools/bin/lib/libcryptoid_pkcs11.so"]							
            ]);																
			var SCNotEnrolledMsg = "Smartcard Not enrolled in Signer.Digital Browser Extension. Can still be used by passing pkcs#11 driver lib name in PKCS11Lib param."	 
            if (this.OSName == "Windows") {										
                if (SCName == "Windows Certificate Store")					
                    return "Microsoft Enhanced RSA and AES Cryptographic Provider";									
                else if (winHashMap.has(SCName))				
                    return winHashMap.get(SCName);					
				else														
					return SCNotEnrolledMsg; 	
            }																
            if (this.OSName = "Linux") {											
				if (linuxHashMap.has(SCName))							
					return linuxHashMap.get(SCName);					
				else														
					return SCNotEnrolledMsg; 							
			}																
			else {															
                return "OS Not Supported";									
            }																
        }																	
	this.getSCNameByReaderName = function(ReaderName)						
        {																	
            let winHashMap = new Map([										
                ["HYPERSECU USB TOKEN 0", "HyperSecu ePass2003"],			
                ["FT ePass2003Auto 0", "HyperSecu ePass2003"],				
                ["FS USB Token 0", "HyperSecu ePass2003"],					
				["feitian ePass2003 0", "HyperSecu ePass2003"],             
                ["AKS ifdh 0", "SafeNet eToken"],							
                ["AKS ifdh 1", "SafeNet eToken"],							
                ["SafeNet Token JC 0", "SafeNet eToken"],					
                ["SafeNet Token JC 1", "SafeNet eToken"],					
                ["Aladdin Token JC 0", "SafeNet eToken"],					
                ["Aladdin Token JC 1", "SafeNet eToken"],					
                ["Watchdata WDIND USB CCID Key 0", "PROXKey Watchdata"],	
                ["Bit4id tokenME FIPS 0", "Bit4id tokenME"],				
                ["Longmai mToken CryptoIDA 0", "Longmai mToken"],			
				["Gemplus USB SmartCard Reader 0", "Gemalto USB"]			
            ]);																
            let linuxHashMap = new Map([									
                ["Feitian ePass2003", "HyperSecu ePass2003"],				
                ["FT ePass2003Auto", "HyperSecu ePass2003"],				
                ["SafeNet eToken 5100", "SafeNet eToken"],					
                ["Watchdata USB Key", "PROXKey Watchdata"]					
            ]);																
            if (this.OSName == "Windows") {									
                if (winHashMap.has(ReaderName))								
                    return winHashMap.get(ReaderName);						
				else														
					return ReaderName; 	
            }																
            if (this.OSName = "Linux") {											
				if (linuxHashMap.has(ReaderName))							
					return linuxHashMap.get(ReaderName);					
				else														
					return ReaderName; 							
			}																
			else {															
                return ReaderName;									
            }																
        }																	
		function GetOS()													
		{																	
            if (navigator.appVersion.indexOf("Win") != -1) return "Windows";
            else if (navigator.appVersion.indexOf("Mac") != -1) return "MacOS";	
            else if (navigator.appVersion.indexOf("X11") != -1) return "UNIX";	
            else if (navigator.appVersion.indexOf("Linux") != -1) return "Linux";
			else return "Unknown OS";										
		}																	
}//End of TpCrypto class													
</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style data-bar-style="default" type="text/css">
  .lp-bar__iframe {
    width: 100%;
    height: 0;
    vertical-align: middle;
    border: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    transform: translate3d(0, 0, 0);
  }

  .lp-bar__iframe-wrapper {
    display: block;
    width: 100%;
    height: 0;
    transition: top .2s;
    position: fixed;
    z-index: 12;
    top: 0;
    transform: translate(0, -100%);
    overflow: hidden;
  }

  .lp-bar__pusher {
    position: relative;
    height: 0;
    transition: height .2s;
    transform: translate3d(0, 0, 0);
  }
</style><style data-bar-style="dynamic" type="text/css">
      .lp-bar__iframe { 
        height: 54px;
        
       }
      .lp-bar__iframe-wrapper { 
        height: 54px;
        transform: none;
        transition: none;
        top: 0px;
          position: absolute;
       }
      .lp-bar__pusher { 
        height: 54px;
       }
    </style><script type="text/javascript">if(navigator.userAgent.match(/MSIE|Internet Explorer/i)||navigator.userAgent.match(/Trident\/7\..*?rv:11/i)){var href=document.location.href;if(!href.match(/[?&]nowprocket/)){if(href.indexOf("?")==-1){if(href.indexOf("#")==-1){document.location.href=href+"?nowprocket=1"}else{document.location.href=href.replace("#","?nowprocket=1#")}}else{if(href.indexOf("#")==-1){document.location.href=href+"&nowprocket=1"}else{document.location.href=href.replace("#","&nowprocket=1#")}}}}</script><script type="text/javascript">class RocketLazyLoadScripts{constructor(e){this.triggerEvents=e,this.eventOptions={passive:!0},this.userEventListener=this.triggerListener.bind(this),this.delayedScripts={normal:[],async:[],defer:[]},this.allJQueries=[]}_addUserInteractionListener(e){this.triggerEvents.forEach((t=>window.addEventListener(t,e.userEventListener,e.eventOptions)))}_removeUserInteractionListener(e){this.triggerEvents.forEach((t=>window.removeEventListener(t,e.userEventListener,e.eventOptions)))}triggerListener(){this._removeUserInteractionListener(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this._loadEverythingNow.bind(this)):this._loadEverythingNow()}async _loadEverythingNow(){this._delayEventListeners(),this._delayJQueryReady(this),this._handleDocumentWrite(),this._registerAllDelayedScripts(),this._preloadAllScripts(),await this._loadScriptsFromList(this.delayedScripts.normal),await this._loadScriptsFromList(this.delayedScripts.defer),await this._loadScriptsFromList(this.delayedScripts.async),await this._triggerDOMContentLoaded(),await this._triggerWindowLoad(),window.dispatchEvent(new Event("rocket-allScriptsLoaded"))}_registerAllDelayedScripts(){document.querySelectorAll("script[type=rocketlazyloadscript]").forEach((e=>{e.hasAttribute("src")?e.hasAttribute("async")&&!1!==e.async?this.delayedScripts.async.push(e):e.hasAttribute("defer")&&!1!==e.defer||"module"===e.getAttribute("data-rocket-type")?this.delayedScripts.defer.push(e):this.delayedScripts.normal.push(e):this.delayedScripts.normal.push(e)}))}async _transformScript(e){return await this._requestAnimFrame(),new Promise((t=>{const n=document.createElement("script");let r;[...e.attributes].forEach((e=>{let t=e.nodeName;"type"!==t&&("data-rocket-type"===t&&(t="type",r=e.nodeValue),n.setAttribute(t,e.nodeValue))})),e.hasAttribute("src")?(n.addEventListener("load",t),n.addEventListener("error",t)):(n.text=e.text,t()),e.parentNode.replaceChild(n,e)}))}async _loadScriptsFromList(e){const t=e.shift();return t?(await this._transformScript(t),this._loadScriptsFromList(e)):Promise.resolve()}_preloadAllScripts(){var e=document.createDocumentFragment();[...this.delayedScripts.normal,...this.delayedScripts.defer,...this.delayedScripts.async].forEach((t=>{const n=t.getAttribute("src");if(n){const t=document.createElement("link");t.href=n,t.rel="preload",t.as="script",e.appendChild(t)}})),document.head.appendChild(e)}_delayEventListeners(){let e={};function t(t,n){!function(t){function n(n){return e[t].eventsToRewrite.indexOf(n)>=0?"rocket-"+n:n}e[t]||(e[t]={originalFunctions:{add:t.addEventListener,remove:t.removeEventListener},eventsToRewrite:[]},t.addEventListener=function(){arguments[0]=n(arguments[0]),e[t].originalFunctions.add.apply(t,arguments)},t.removeEventListener=function(){arguments[0]=n(arguments[0]),e[t].originalFunctions.remove.apply(t,arguments)})}(t),e[t].eventsToRewrite.push(n)}function n(e,t){let n=e[t];Object.defineProperty(e,t,{get:()=>n||function(){},set(r){e["rocket"+t]=n=r}})}t(document,"DOMContentLoaded"),t(window,"DOMContentLoaded"),t(window,"load"),t(window,"pageshow"),t(document,"readystatechange"),n(document,"onreadystatechange"),n(window,"onload"),n(window,"onpageshow")}_delayJQueryReady(e){let t=window.jQuery;Object.defineProperty(window,"jQuery",{get:()=>t,set(n){if(n&&n.fn&&!e.allJQueries.includes(n)){n.fn.ready=n.fn.init.prototype.ready=function(t){e.domReadyFired?t.bind(document)(n):document.addEventListener("rocket-DOMContentLoaded",(()=>t.bind(document)(n)))};const t=n.fn.on;n.fn.on=n.fn.init.prototype.on=function(){if(this[0]===window){function e(e){return e.split(" ").map((e=>"load"===e||0===e.indexOf("load.")?"rocket-jquery-load":e)).join(" ")}"string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=e(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach((t=>{delete Object.assign(arguments[0],{[e(t)]:arguments[0][t]})[t]}))}return t.apply(this,arguments),this},e.allJQueries.push(n)}t=n}})}async _triggerDOMContentLoaded(){this.domReadyFired=!0,await this._requestAnimFrame(),document.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._requestAnimFrame(),window.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._requestAnimFrame(),document.dispatchEvent(new Event("rocket-readystatechange")),await this._requestAnimFrame(),document.rocketonreadystatechange&&document.rocketonreadystatechange()}async _triggerWindowLoad(){await this._requestAnimFrame(),window.dispatchEvent(new Event("rocket-load")),await this._requestAnimFrame(),window.rocketonload&&window.rocketonload(),await this._requestAnimFrame(),this.allJQueries.forEach((e=>e(window).trigger("rocket-jquery-load"))),window.dispatchEvent(new Event("rocket-pageshow")),await this._requestAnimFrame(),window.rocketonpageshow&&window.rocketonpageshow()}_handleDocumentWrite(){const e=new Map;document.write=document.writeln=function(t){const n=document.currentScript,r=document.createRange(),i=n.parentElement;let o=e.get(n);void 0===o&&(o=n.nextSibling,e.set(n,o));const a=document.createDocumentFragment();r.setStart(a,0),a.appendChild(r.createContextualFragment(t)),i.insertBefore(a,o)}}async _requestAnimFrame(){return new Promise((e=>requestAnimationFrame(e)))}static run(){const e=new RocketLazyLoadScripts(["keydown","mousemove","touchmove","touchstart","touchend","wheel"]);e._addUserInteractionListener(e)}}RocketLazyLoadScripts.run();</script>



<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

	<!-- This site is optimized with the Yoast SEO plugin v17.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Autoregression Models for Time Series Forecasting With Python</title><link rel="stylesheet" href="./Autoregression Models for Time Series Forecasting With Python_files/b2abe47abf743f13754c3bae78c9c056.css" media="all" data-minify="1">
	<link rel="canonical" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Autoregression Models for Time Series Forecasting With Python">
	<meta property="og:description" content="Autoregression is a time series model that uses observations from previous time steps as input to a regression equation to […]">
	<meta property="og:url" content="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/">
	<meta property="og:site_name" content="Machine Learning Mastery">
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:published_time" content="2017-01-01T18:00:56+00:00">
	<meta property="article:modified_time" content="2021-09-06T20:28:19+00:00">
	<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg">
	<meta property="og:image:width" content="640">
	<meta property="og:image:height" content="425">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Jason Brownlee">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="14 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://machinelearningmastery.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#primaryimage","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg","width":640,"height":425,"caption":"Autoregression Models for Time Series Forecasting With Python Photo by Umberto Salvagnin, some rights reserved."},{"@type":"WebPage","@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#webpage","url":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/","name":"Autoregression Models for Time Series Forecasting With Python","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#primaryimage"},"datePublished":"2017-01-01T18:00:56+00:00","dateModified":"2021-09-06T20:28:19+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/"]}]},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://machinelearningmastery.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://machinelearningmastery.com/blog/"},{"@type":"ListItem","position":3,"name":"Autoregression Models for Time Series Forecasting With Python"}]},{"@type":"Article","@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#article","isPartOf":{"@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"Autoregression Models for Time Series Forecasting With Python","datePublished":"2017-01-01T18:00:56+00:00","dateModified":"2021-09-06T20:28:19+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#webpage"},"wordCount":2004,"commentCount":195,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg","articleSection":["Time Series"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["http://MachineLearningMastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"],"url":"https://machinelearningmastery.com/author/jasonb/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://cdn.jsdelivr.net/">
<link rel="dns-prefetch" href="https://ads.adthrive.com/">
<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="dns-prefetch" href="https://loadeu.exelator.com/">
<link rel="dns-prefetch" href="https://sync.crwdcntrl.net/">
<link rel="dns-prefetch" href="https://gdpr-wrapper.privacymanager.io/">
<link rel="dns-prefetch" href="https://securepubads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://gdpr.privacymanager.io/">
<link rel="dns-prefetch" href="https://sb.scorecardresearch.com/">
<link rel="dns-prefetch" href="https://confiant-integrations.global.ssl.fastly.net/">

<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Autoregression Models for Time Series Forecasting With Python Comments Feed" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/feed/">
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	









<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/jquery.min.js.download" id="jquery-core-js" defer=""></script>
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/jquery-migrate.min.js.download" id="jquery-migrate-js" defer=""></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.26","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/urvanov_syntax_highlighter.min.js.download" id="urvanov_syntax_highlighter_js-js" defer=""></script>
<script type="text/javascript" id="ssb-front-js-js-extra">
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"c86dc53a84"};
/* ]]> */
</script>
<script data-minify="1" type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/front.js.download" id="ssb-front-js-js" defer=""></script>
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/third-party.min.js.download" id="third-party-js" defer=""></script>
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/modernizr.min.js.download" id="modernizr-js" defer=""></script>
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/general.min.js.download" id="general-js" defer=""></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/"><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/3570"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=3570">
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fautoregression-models-time-series-forecasting-python%2F">
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fautoregression-models-time-series-forecasting-python%2F&amp;format=xml">
<style type="text/css">.crp_title {
    font-size: medium;
}
.group.portfolio-img img {
    height: auto;
    padding: 3px;
	  border: 0px solid #fff;
    background: rgba(255,255,255,.7);
}
.crp_related ul li {
    background: #fff;
    padding: 3px;
    margin: 0 0 1em;
    width: 100%;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-shadow: 0 0px 0px 0 rgb(0 0 0 / 18%);
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border: 0px solid #fff;
    animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -webkit-animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -moz-animation: wzslideup .8s ease-out,wzfadein 1s ease;
    font-size: 1em;
    text-align: center;
    display: inline-block;
}</style>    <style type="text/css">

      .mpcs-classroom .nav-back i,
      .mpcs-classroom .navbar-section a.btn,
      .mpcs-classroom .navbar-section a,
      .mpcs-classroom .navbar-section button {
        color: rgba(255, 255, 255) !important;
      }

      .mpcs-classroom .navbar-section .dropdown .menu a {
        color: rgba(44, 54, 55) !important;
      }

      .mpcs-classroom .mpcs-progress-ring {
        background-color: rgba(29, 166, 154) !important;
      }

      .mpcs-classroom .mpcs-course-filter .dropdown .btn span,
      .mpcs-classroom .mpcs-course-filter .dropdown .btn i,
      .mpcs-classroom .mpcs-course-filter .input-group .input-group-btn,
      .mpcs-classroom .mpcs-course-filter .input-group .mpcs-search,
      .mpcs-classroom .mpcs-course-filter .input-group input[type=text],
      .mpcs-classroom .mpcs-course-filter .dropdown a,
      .mpcs-classroom .pagination,
      .mpcs-classroom .pagination i,
      .mpcs-classroom .pagination a {
        color: rgba(44, 54, 55) !important;
        border-color: rgba(44, 54, 55) !important;
      }

      /* body.mpcs-classroom a{
        color: rgba();
      } */

      #mpcs-navbar,
      #mpcs-navbar button#previous_lesson_link,
      #mpcs-navbar button#previous_lesson_link:hover {
        background: rgba(44, 54, 55);
      }

      .course-progress .user-progress,
      .btn-green,
      #mpcs-navbar button:not(#previous_lesson_link){
        background: rgba(29, 166, 154, 0.9);
      }

      .btn-green:hover,
      #mpcs-navbar button:not(#previous_lesson_link):focus,
      #mpcs-navbar button:not(#previous_lesson_link):hover{
        background: rgba(29, 166, 154);
      }

      .btn-green{border: rgba(29, 166, 154)}

      .course-progress .progress-text,
      .mpcs-lesson i.mpcs-circle-regular {
        color: rgba(29, 166, 154)
      }

      #mpcs-main #bookmark, .mpcs-lesson.current{background: rgba(29, 166, 154, 0.3)}

      .mpcs-instructor .tile-subtitle{
        color: rgba(29, 166, 154, 1)
      }

    </style>
     <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 3.2.4 -->
<meta property="og:title" content="Autoregression Models for Time Series Forecasting With Python - Machine Learning Mastery">
<meta property="og:description" content="Autoregression is a time series model that uses observations from previous time steps as input to a regression equation to predict the value at the next time step.

It is a very simple idea that can result in accurate forecasts on a range of time series problems.

In this tutorial, you will discover how to implement an autoregressive model for time series">
<meta property="og:url" content="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="Autoregression is a time series model that uses observations from previous time steps as input to a regression equation to predict the value at the next time step.

It is a very simple idea that can result in accurate forecasts on a range of time series problems.

In this tutorial, you will discover how to implement an autoregressive model for time series">
<meta name="twitter:title" content="Autoregression Models for Time Series Forecasting With Python - Machine Learning Mastery">
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg">
    
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin="">
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png">
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->


<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44039733-3', 'auto',{'allowLinker': true });
ga('require', 'linker');
ga('linker:autoLink',['samcart.com']);
ga('send', 'pageview');
</script>
<script async="" src="./Autoregression Models for Time Series Forecasting With Python_files/analytics.js.download"></script><link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>	<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '834324500844861');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=834324500844861&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->
	
	
<link href="./Autoregression Models for Time Series Forecasting With Python_files/jquery.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/jquery-migrate.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/urvanov_syntax_highlighter.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/front.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/third-party.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/modernizr.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/general.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/comment-reply.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/tex-chtml.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/q2w3-fixed-widget.min.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/analytics.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/embed.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/embed.js.download" rel="preload" as="script"><link href="./Autoregression Models for Time Series Forecasting With Python_files/embed.js(1).download" rel="preload" as="script"><link rel="stylesheet" type="text/css" href="./Autoregression Models for Time Series Forecasting With Python_files/twitcount.css" media="all"><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(116,174,203) !important;
    background: rgba(116,174,203,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 .drip-submit-button:disabled {
    background-color: #808080 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field,
  #drip-2211 .drip-radio-buttons,
  #drip-2211 .drip-dropdown-select {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt.label-for-type-text,
  .drip-tab dl.no-labels dt.label-for-type-dropdown,
  .drip-tab dl.no-labels dt.label-for-type-email {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-lightbox input {
    box-sizing: border-box;
  }

  .drip-tab .drip-date-field,
  .drip-tab .drip-text-field {
    margin: 0 !important;
    height: 34px !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field,
  .drip-tab .drip-dropdown-select select {
    padding: 6px !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors:not(:empty) {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  /* RADIOS */

  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-radio-buttons * {
    box-sizing: border-box;
  }
  .drip-tab .drip-radio-buttons h4 {
    font-family: inherit;
    font-weight: bold;
    font-size: 15px;
    margin: 0 0 3px;
    padding: 0;
  }

  .drip-tab .drip-radio-button {
    width: 100%;
    display: block;
    position: relative;
    margin-bottom: 6px;
  }

  .drip-tab .drip-radio-button input[type="radio"] {
    height: 0;
    width: 0;
    opacity: 0;
    position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    border: none;
    padding: 0;
    margin: 0;
  }

  .drip-tab .drip-radio-button label {
    font-size: 15px;
    padding-left: 30px;
    color: #262626;
    white-space: normal;
    word-break: normal;
    cursor: pointer;
  }

  .drip-tab .drip-radio-button label:before {
    content: "";
    display: block;
    background: #f5f5f5;
    width: 18px;
    height: 18px;
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    border-radius: 9px;
    border: 1px solid #cccccc;
    box-sizing: border-box;
    padding: 1px;
    transition: background 300ms ease-out, border-color 300ms, border-width 300ms ease-in;
  }
  .drip-tab .drip-radio-button label:hover:before {
    border-color: #000000;
  }

  .drip-tab .drip-radio-button input[type="radio"]:checked ~ label:before {
    background-color: #ffffff;
    border: 5px solid #000000;
  }

  /* DROPDOWNS */

  /* stylelint-disable */

.drip-tab .drip-dropdown-select h4 {
  font-family: inherit;
  font-weight: bold;
  font-size: 15px;
  margin: 0 0 3px;
  padding: 0;
}

.drip-tab .drip-dropdown-select select {
  display: block;
  box-shadow: none;
  position: relative;
  border: 1px solid #A8ACB9;
  outline: none;
  border-radius: 3px;
  line-height: inherit;
  font-family: inherit;
  color: #262626;
  transition: border-color 300ms;
  width: 100%;
  max-width: 100%; /* useful when width is set to anything other than 100% */
  box-sizing: border-box;

  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background-color: #fff;
  /* note: bg image below uses 2 urls. The first is an svg data uri for the arrow
    icon, and the second is the gradient. for the icon, if you want to change the
    color, be sure to use `%23` instead of `#`, since it's a url. You can also
    swap in a different svg icon or an external image reference
  */
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23262626%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%, #ffffff 100%);
  background-repeat: no-repeat, repeat;
  /* arrow icon position (1em from the right, 50% vertical) , then gradient position*/
  background-position: right 12px top 50%, 0 0;
  /* icon size, then gradient */
  background-size: 12px auto, 100%;
}

/* Hide arrow icon in IE browsers */
.drip-tab .drip-dropdown-select select::-ms-expand {
  display: none;
}

/* Hover style */
.drip-tab .drip-dropdown-select select:hover {
  border-color: #888;
}

/* Focus style */
.drip-tab .drip-dropdown-select select:focus {
  border-color: #A8ACB9;
  /* It'd be nice to use -webkit-focus-ring-color here but it doesn't work on box-shadow */
  /* box-shadow: 0 0 1px 3px rgba(59, 153, 252, .7);
  box-shadow: 0 0 0 3px -moz-mac-focusring;
  color: #222; */
  outline: none;
}

/* Set options to normal weight */
.drip-tab .drip-dropdown-select select option {
  font-weight:normal;
}

/* Support for rtl text, explicit support for Arabic and Hebrew */
*[dir="rtl"] .drip-tab .drip-dropdown-select select,
:root:lang(ar) .drip-tab .drip-dropdown-select select,
:root:lang(iw) .drip-tab .drip-dropdown-select select {
  background-position: left 12px top 50%, 0 0;
  padding: .6em .8em .5em 1.4em;
}

/* Disabled styles */
.drip-tab .drip-dropdown-select select:disabled,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  color: graytext;
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22graytext%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%,#e5e5e5 100%);
}
.drip-tab .drip-dropdown-select select:disabled:hover,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  border-color: #aaa;
}

/* stylelint-enable */


  /* SUBMIT BUTTON */

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* telephone input */
  /* stylelint-disable */

.drip-tab .iti + .zenput--checkbox {
  margin-top: 10px;
}

.drip-tab .iti {
  position: relative;
  display: block;
}

.drip-tab .iti * {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
}

.drip-tab .iti__hide {
  display: none;
}

.drip-tab .iti__v-hide {
  visibility: hidden;
}

.drip-tab .iti input,
.drip-tab .iti input[type=text],
.drip-tab .iti input[type=tel] {
  position: relative;
  z-index: 0;
  width: 100%;
  padding: 0 0 0 36px;
  margin: 0 !important;
}

  .drip-tab .iti input,
  .drip-tab .iti input[type=text],
  .drip-tab .iti input[type=tel] {
    height: 34px;
    border: 1px solid #c4c4c4 !important;
    border-radius: 4px !important;
    box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.18) !important;
  }

.drip-tab .iti__flag-container {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  padding: 1px;
}

.drip-tab .iti__selected-flag {
  z-index: 1;
  position: relative;
  display: flex;
  align-items: center;
  height: 100%;
  padding: 0 6px 0 8px;
}

.drip-tab .iti__arrow {
  margin-left: 6px;
  width: 0;
  height: 0;
  border-left: 3px solid transparent;
  border-right: 3px solid transparent;
  border-top: 4px solid #555;
}

.drip-tab .iti__arrow--up {
  border-top: none;
  border-bottom: 4px solid #555;
}

.drip-tab .iti__country-list {
  position: absolute;
  z-index: 2;
  list-style: none;
  text-align: left;
  padding: 0;
  margin: 0 0 0 -1px;
  box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
  background-color: white;
  border: 1px solid #CCC;
  white-space: nowrap;
  max-height: 200px;
  width: 320px;
  overflow-y: scroll;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

.drip-tab .iti__country-list--dropup {
  bottom: 100%;
  margin-bottom: -1px;
}

@media (max-width: 500px) {
  .drip-tab .iti__country-list {
    white-space: normal;
  }
}

.drip-tab .iti__flag-box {
  display: inline-block;
  width: 20px;
}

.drip-tab .iti__divider {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px solid #CCC;
}

.drip-tab .iti__country {
  padding: 5px 10px;
  outline: none;
}

.drip-tab .iti__dial-code {
  color: #999;
}

.drip-tab .iti__country.iti__highlight {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name,
.drip-tab .iti__dial-code {
  vertical-align: middle;
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name {
  margin-right: 6px;
}

.drip-tab .iti--allow-dropdown input,
.drip-tab .iti--allow-dropdown input[type=text],
.drip-tab .iti--allow-dropdown input[type=tel],
.drip-tab .iti--separate-dial-code input,
.drip-tab .iti--separate-dial-code input[type=text],
.drip-tab .iti--separate-dial-code input[type=tel] {
  padding-right: 6px;
  padding-left: 52px;
  margin-left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container,
.drip-tab .iti--separate-dial-code .iti__flag-container {
  right: auto;
  left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover {
  cursor: pointer;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover {
  cursor: default;
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover .iti__selected-flag,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover .iti__selected-flag {
  background-color: transparent;
}

.drip-tab .iti--separate-dial-code .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--separate-dial-code .iti__selected-dial-code {
  margin-left: 6px;
}

.drip-tab .iti--container {
  position: absolute;
  top: -1000px;
  left: -1000px;
  z-index: 1060;
  padding: 1px;
}

.drip-tab .iti--container:hover {
  cursor: pointer;
}

.iti-mobile .drip-tab  .iti--container {
  top: 30px;
  bottom: 30px;
  left: 30px;
  right: 30px;
  position: fixed;
}

.iti-mobile .drip-tab .iti__country-list {
  max-height: 100%;
  width: 100%;
}

.iti-mobile .drip-tab .iti__country {
  padding: 10px 10px;
  line-height: 1.5em;
}

.drip-tab .sms-subtext {
  margin-top: .75em;
  font-size: .75em;
  line-height: 1.4;
  display: inline-block;
}

.drip-tab .sms-subtext a {
  text-decoration: underline;
  cursor: pointer;
}

.drip-tab .iti__flag {
  width: 20px;
}

.drip-tab .iti__flag.iti__be {
  width: 18px;
}

.drip-tab .iti__flag.iti__ch {
  width: 15px;
}

.drip-tab .iti__flag.iti__mc {
  width: 19px;
}

.drip-tab .iti__flag.iti__ne {
  width: 18px;
}

.drip-tab .iti__flag.iti__np {
  width: 13px;
}

.drip-tab .iti__flag.iti__va {
  width: 15px;
}

@media (-webkit-min-device-pixel-ratio: 2),
(min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-size: 5652px 15px;
  }
}

.drip-tab .iti__flag.iti__ac {
    height: 10px;
    background-position: 0px 0px;
  }

.drip-tab .iti__flag.iti__ad {
    height: 14px;
    background-position: -22px 0px;
  }

.drip-tab .iti__flag.iti__ae {
    height: 10px;
    background-position: -44px 0px;
  }

.drip-tab .iti__flag.iti__af {
    height: 14px;
    background-position: -66px 0px;
  }

.drip-tab .iti__flag.iti__ag {
    height: 14px;
    background-position: -88px 0px;
  }

.drip-tab .iti__flag.iti__ai {
    height: 10px;
    background-position: -110px 0px;
  }

.drip-tab .iti__flag.iti__al {
    height: 15px;
    background-position: -132px 0px;
  }

.drip-tab .iti__flag.iti__am {
    height: 10px;
    background-position: -154px 0px;
  }

.drip-tab .iti__flag.iti__ao {
    height: 14px;
    background-position: -176px 0px;
  }

.drip-tab .iti__flag.iti__aq {
    height: 14px;
    background-position: -198px 0px;
  }

.drip-tab .iti__flag.iti__ar {
    height: 13px;
    background-position: -220px 0px;
  }

.drip-tab .iti__flag.iti__as {
    height: 10px;
    background-position: -242px 0px;
  }

.drip-tab .iti__flag.iti__at {
    height: 14px;
    background-position: -264px 0px;
  }

.drip-tab .iti__flag.iti__au {
    height: 10px;
    background-position: -286px 0px;
  }

.drip-tab .iti__flag.iti__aw {
    height: 14px;
    background-position: -308px 0px;
  }

.drip-tab .iti__flag.iti__ax {
    height: 13px;
    background-position: -330px 0px;
  }

.drip-tab .iti__flag.iti__az {
    height: 10px;
    background-position: -352px 0px;
  }

.drip-tab .iti__flag.iti__ba {
    height: 10px;
    background-position: -374px 0px;
  }

.drip-tab .iti__flag.iti__bb {
    height: 14px;
    background-position: -396px 0px;
  }

.drip-tab .iti__flag.iti__bd {
    height: 12px;
    background-position: -418px 0px;
  }

.drip-tab .iti__flag.iti__be {
    height: 15px;
    background-position: -440px 0px;
  }

.drip-tab .iti__flag.iti__bf {
    height: 14px;
    background-position: -460px 0px;
  }

.drip-tab .iti__flag.iti__bg {
    height: 12px;
    background-position: -482px 0px;
  }

.drip-tab .iti__flag.iti__bh {
    height: 12px;
    background-position: -504px 0px;
  }

.drip-tab .iti__flag.iti__bi {
    height: 12px;
    background-position: -526px 0px;
  }

.drip-tab .iti__flag.iti__bj {
    height: 14px;
    background-position: -548px 0px;
  }

.drip-tab .iti__flag.iti__bl {
    height: 14px;
    background-position: -570px 0px;
  }

.drip-tab .iti__flag.iti__bm {
    height: 10px;
    background-position: -592px 0px;
  }

.drip-tab .iti__flag.iti__bn {
    height: 10px;
    background-position: -614px 0px;
  }

.drip-tab .iti__flag.iti__bo {
    height: 14px;
    background-position: -636px 0px;
  }

.drip-tab .iti__flag.iti__bq {
    height: 14px;
    background-position: -658px 0px;
  }

.drip-tab .iti__flag.iti__br {
    height: 14px;
    background-position: -680px 0px;
  }

.drip-tab .iti__flag.iti__bs {
    height: 10px;
    background-position: -702px 0px;
  }

.drip-tab .iti__flag.iti__bt {
    height: 14px;
    background-position: -724px 0px;
  }

.drip-tab .iti__flag.iti__bv {
    height: 15px;
    background-position: -746px 0px;
  }

.drip-tab .iti__flag.iti__bw {
    height: 14px;
    background-position: -768px 0px;
  }

.drip-tab .iti__flag.iti__by {
    height: 10px;
    background-position: -790px 0px;
  }

.drip-tab .iti__flag.iti__bz {
    height: 14px;
    background-position: -812px 0px;
  }

.drip-tab .iti__flag.iti__ca {
    height: 10px;
    background-position: -834px 0px;
  }

.drip-tab .iti__flag.iti__cc {
    height: 10px;
    background-position: -856px 0px;
  }

.drip-tab .iti__flag.iti__cd {
    height: 15px;
    background-position: -878px 0px;
  }

.drip-tab .iti__flag.iti__cf {
    height: 14px;
    background-position: -900px 0px;
  }

.drip-tab .iti__flag.iti__cg {
    height: 14px;
    background-position: -922px 0px;
  }

.drip-tab .iti__flag.iti__ch {
    height: 15px;
    background-position: -944px 0px;
  }

.drip-tab .iti__flag.iti__ci {
    height: 14px;
    background-position: -961px 0px;
  }

.drip-tab .iti__flag.iti__ck {
    height: 10px;
    background-position: -983px 0px;
  }

.drip-tab .iti__flag.iti__cl {
    height: 14px;
    background-position: -1005px 0px;
  }

.drip-tab .iti__flag.iti__cm {
    height: 14px;
    background-position: -1027px 0px;
  }

.drip-tab .iti__flag.iti__cn {
    height: 14px;
    background-position: -1049px 0px;
  }

.drip-tab .iti__flag.iti__co {
    height: 14px;
    background-position: -1071px 0px;
  }

.drip-tab .iti__flag.iti__cp {
    height: 14px;
    background-position: -1093px 0px;
  }

.drip-tab .iti__flag.iti__cr {
    height: 12px;
    background-position: -1115px 0px;
  }

.drip-tab .iti__flag.iti__cu {
    height: 10px;
    background-position: -1137px 0px;
  }

.drip-tab .iti__flag.iti__cv {
    height: 12px;
    background-position: -1159px 0px;
  }

.drip-tab .iti__flag.iti__cw {
    height: 14px;
    background-position: -1181px 0px;
  }

.drip-tab .iti__flag.iti__cx {
    height: 10px;
    background-position: -1203px 0px;
  }

.drip-tab .iti__flag.iti__cy {
    height: 14px;
    background-position: -1225px 0px;
  }

.drip-tab .iti__flag.iti__cz {
    height: 14px;
    background-position: -1247px 0px;
  }

.drip-tab .iti__flag.iti__de {
    height: 12px;
    background-position: -1269px 0px;
  }

.drip-tab .iti__flag.iti__dg {
    height: 10px;
    background-position: -1291px 0px;
  }

.drip-tab .iti__flag.iti__dj {
    height: 14px;
    background-position: -1313px 0px;
  }

.drip-tab .iti__flag.iti__dk {
    height: 15px;
    background-position: -1335px 0px;
  }

.drip-tab .iti__flag.iti__dm {
    height: 10px;
    background-position: -1357px 0px;
  }

.drip-tab .iti__flag.iti__do {
    height: 14px;
    background-position: -1379px 0px;
  }

.drip-tab .iti__flag.iti__dz {
    height: 14px;
    background-position: -1401px 0px;
  }

.drip-tab .iti__flag.iti__ea {
    height: 14px;
    background-position: -1423px 0px;
  }

.drip-tab .iti__flag.iti__ec {
    height: 14px;
    background-position: -1445px 0px;
  }

.drip-tab .iti__flag.iti__ee {
    height: 13px;
    background-position: -1467px 0px;
  }

.drip-tab .iti__flag.iti__eg {
    height: 14px;
    background-position: -1489px 0px;
  }

.drip-tab .iti__flag.iti__eh {
    height: 10px;
    background-position: -1511px 0px;
  }

.drip-tab .iti__flag.iti__er {
    height: 10px;
    background-position: -1533px 0px;
  }

.drip-tab .iti__flag.iti__es {
    height: 14px;
    background-position: -1555px 0px;
  }

.drip-tab .iti__flag.iti__et {
    height: 10px;
    background-position: -1577px 0px;
  }

.drip-tab .iti__flag.iti__eu {
    height: 14px;
    background-position: -1599px 0px;
  }

.drip-tab .iti__flag.iti__fi {
    height: 12px;
    background-position: -1621px 0px;
  }

.drip-tab .iti__flag.iti__fj {
    height: 10px;
    background-position: -1643px 0px;
  }

.drip-tab .iti__flag.iti__fk {
    height: 10px;
    background-position: -1665px 0px;
  }

.drip-tab .iti__flag.iti__fm {
    height: 11px;
    background-position: -1687px 0px;
  }

.drip-tab .iti__flag.iti__fo {
    height: 15px;
    background-position: -1709px 0px;
  }

.drip-tab .iti__flag.iti__fr {
    height: 14px;
    background-position: -1731px 0px;
  }

.drip-tab .iti__flag.iti__ga {
    height: 15px;
    background-position: -1753px 0px;
  }

.drip-tab .iti__flag.iti__gb {
    height: 10px;
    background-position: -1775px 0px;
  }

.drip-tab .iti__flag.iti__gd {
    height: 12px;
    background-position: -1797px 0px;
  }

.drip-tab .iti__flag.iti__ge {
    height: 14px;
    background-position: -1819px 0px;
  }

.drip-tab .iti__flag.iti__gf {
    height: 14px;
    background-position: -1841px 0px;
  }

.drip-tab .iti__flag.iti__gg {
    height: 14px;
    background-position: -1863px 0px;
  }

.drip-tab .iti__flag.iti__gh {
    height: 14px;
    background-position: -1885px 0px;
  }

.drip-tab .iti__flag.iti__gi {
    height: 10px;
    background-position: -1907px 0px;
  }

.drip-tab .iti__flag.iti__gl {
    height: 14px;
    background-position: -1929px 0px;
  }

.drip-tab .iti__flag.iti__gm {
    height: 14px;
    background-position: -1951px 0px;
  }

.drip-tab .iti__flag.iti__gn {
    height: 14px;
    background-position: -1973px 0px;
  }

.drip-tab .iti__flag.iti__gp {
    height: 14px;
    background-position: -1995px 0px;
  }

.drip-tab .iti__flag.iti__gq {
    height: 14px;
    background-position: -2017px 0px;
  }

.drip-tab .iti__flag.iti__gr {
    height: 14px;
    background-position: -2039px 0px;
  }

.drip-tab .iti__flag.iti__gs {
    height: 10px;
    background-position: -2061px 0px;
  }

.drip-tab .iti__flag.iti__gt {
    height: 13px;
    background-position: -2083px 0px;
  }

.drip-tab .iti__flag.iti__gu {
    height: 11px;
    background-position: -2105px 0px;
  }

.drip-tab .iti__flag.iti__gw {
    height: 10px;
    background-position: -2127px 0px;
  }

.drip-tab .iti__flag.iti__gy {
    height: 12px;
    background-position: -2149px 0px;
  }

.drip-tab .iti__flag.iti__hk {
    height: 14px;
    background-position: -2171px 0px;
  }

.drip-tab .iti__flag.iti__hm {
    height: 10px;
    background-position: -2193px 0px;
  }

.drip-tab .iti__flag.iti__hn {
    height: 10px;
    background-position: -2215px 0px;
  }

.drip-tab .iti__flag.iti__hr {
    height: 10px;
    background-position: -2237px 0px;
  }

.drip-tab .iti__flag.iti__ht {
    height: 12px;
    background-position: -2259px 0px;
  }

.drip-tab .iti__flag.iti__hu {
    height: 10px;
    background-position: -2281px 0px;
  }

.drip-tab .iti__flag.iti__ic {
    height: 14px;
    background-position: -2303px 0px;
  }

.drip-tab .iti__flag.iti__id {
    height: 14px;
    background-position: -2325px 0px;
  }

.drip-tab .iti__flag.iti__ie {
    height: 10px;
    background-position: -2347px 0px;
  }

.drip-tab .iti__flag.iti__il {
    height: 15px;
    background-position: -2369px 0px;
  }

.drip-tab .iti__flag.iti__im {
    height: 10px;
    background-position: -2391px 0px;
  }

.drip-tab .iti__flag.iti__in {
    height: 14px;
    background-position: -2413px 0px;
  }

.drip-tab .iti__flag.iti__io {
    height: 10px;
    background-position: -2435px 0px;
  }

.drip-tab .iti__flag.iti__iq {
    height: 14px;
    background-position: -2457px 0px;
  }

.drip-tab .iti__flag.iti__ir {
    height: 12px;
    background-position: -2479px 0px;
  }

.drip-tab .iti__flag.iti__is {
    height: 15px;
    background-position: -2501px 0px;
  }

.drip-tab .iti__flag.iti__it {
    height: 14px;
    background-position: -2523px 0px;
  }

.drip-tab .iti__flag.iti__je {
    height: 12px;
    background-position: -2545px 0px;
  }

.drip-tab .iti__flag.iti__jm {
    height: 10px;
    background-position: -2567px 0px;
  }

.drip-tab .iti__flag.iti__jo {
    height: 10px;
    background-position: -2589px 0px;
  }

.drip-tab .iti__flag.iti__jp {
    height: 14px;
    background-position: -2611px 0px;
  }

.drip-tab .iti__flag.iti__ke {
    height: 14px;
    background-position: -2633px 0px;
  }

.drip-tab .iti__flag.iti__kg {
    height: 12px;
    background-position: -2655px 0px;
  }

.drip-tab .iti__flag.iti__kh {
    height: 13px;
    background-position: -2677px 0px;
  }

.drip-tab .iti__flag.iti__ki {
    height: 10px;
    background-position: -2699px 0px;
  }

.drip-tab .iti__flag.iti__km {
    height: 12px;
    background-position: -2721px 0px;
  }

.drip-tab .iti__flag.iti__kn {
    height: 14px;
    background-position: -2743px 0px;
  }

.drip-tab .iti__flag.iti__kp {
    height: 10px;
    background-position: -2765px 0px;
  }

.drip-tab .iti__flag.iti__kr {
    height: 14px;
    background-position: -2787px 0px;
  }

.drip-tab .iti__flag.iti__kw {
    height: 10px;
    background-position: -2809px 0px;
  }

.drip-tab .iti__flag.iti__ky {
    height: 10px;
    background-position: -2831px 0px;
  }

.drip-tab .iti__flag.iti__kz {
    height: 10px;
    background-position: -2853px 0px;
  }

.drip-tab .iti__flag.iti__la {
    height: 14px;
    background-position: -2875px 0px;
  }

.drip-tab .iti__flag.iti__lb {
    height: 14px;
    background-position: -2897px 0px;
  }

.drip-tab .iti__flag.iti__lc {
    height: 10px;
    background-position: -2919px 0px;
  }

.drip-tab .iti__flag.iti__li {
    height: 12px;
    background-position: -2941px 0px;
  }

.drip-tab .iti__flag.iti__lk {
    height: 10px;
    background-position: -2963px 0px;
  }

.drip-tab .iti__flag.iti__lr {
    height: 11px;
    background-position: -2985px 0px;
  }

.drip-tab .iti__flag.iti__ls {
    height: 14px;
    background-position: -3007px 0px;
  }

.drip-tab .iti__flag.iti__lt {
    height: 12px;
    background-position: -3029px 0px;
  }

.drip-tab .iti__flag.iti__lu {
    height: 12px;
    background-position: -3051px 0px;
  }

.drip-tab .iti__flag.iti__lv {
    height: 10px;
    background-position: -3073px 0px;
  }

.drip-tab .iti__flag.iti__ly {
    height: 10px;
    background-position: -3095px 0px;
  }

.drip-tab .iti__flag.iti__ma {
    height: 14px;
    background-position: -3117px 0px;
  }

.drip-tab .iti__flag.iti__mc {
    height: 15px;
    background-position: -3139px 0px;
  }

.drip-tab .iti__flag.iti__md {
    height: 10px;
    background-position: -3160px 0px;
  }

.drip-tab .iti__flag.iti__me {
    height: 10px;
    background-position: -3182px 0px;
  }

.drip-tab .iti__flag.iti__mf {
    height: 14px;
    background-position: -3204px 0px;
  }

.drip-tab .iti__flag.iti__mg {
    height: 14px;
    background-position: -3226px 0px;
  }

.drip-tab .iti__flag.iti__mh {
    height: 11px;
    background-position: -3248px 0px;
  }

.drip-tab .iti__flag.iti__mk {
    height: 10px;
    background-position: -3270px 0px;
  }

.drip-tab .iti__flag.iti__ml {
    height: 14px;
    background-position: -3292px 0px;
  }

.drip-tab .iti__flag.iti__mm {
    height: 14px;
    background-position: -3314px 0px;
  }

.drip-tab .iti__flag.iti__mn {
    height: 10px;
    background-position: -3336px 0px;
  }

.drip-tab .iti__flag.iti__mo {
    height: 14px;
    background-position: -3358px 0px;
  }

.drip-tab .iti__flag.iti__mp {
    height: 10px;
    background-position: -3380px 0px;
  }

.drip-tab .iti__flag.iti__mq {
    height: 14px;
    background-position: -3402px 0px;
  }

.drip-tab .iti__flag.iti__mr {
    height: 14px;
    background-position: -3424px 0px;
  }

.drip-tab .iti__flag.iti__ms {
    height: 10px;
    background-position: -3446px 0px;
  }

.drip-tab .iti__flag.iti__mt {
    height: 14px;
    background-position: -3468px 0px;
  }

.drip-tab .iti__flag.iti__mu {
    height: 14px;
    background-position: -3490px 0px;
  }

.drip-tab .iti__flag.iti__mv {
    height: 14px;
    background-position: -3512px 0px;
  }

.drip-tab .iti__flag.iti__mw {
    height: 14px;
    background-position: -3534px 0px;
  }

.drip-tab .iti__flag.iti__mx {
    height: 12px;
    background-position: -3556px 0px;
  }

.drip-tab .iti__flag.iti__my {
    height: 10px;
    background-position: -3578px 0px;
  }

.drip-tab .iti__flag.iti__mz {
    height: 14px;
    background-position: -3600px 0px;
  }

.drip-tab .iti__flag.iti__na {
    height: 14px;
    background-position: -3622px 0px;
  }

.drip-tab .iti__flag.iti__nc {
    height: 10px;
    background-position: -3644px 0px;
  }

.drip-tab .iti__flag.iti__ne {
    height: 15px;
    background-position: -3666px 0px;
  }

.drip-tab .iti__flag.iti__nf {
    height: 10px;
    background-position: -3686px 0px;
  }

.drip-tab .iti__flag.iti__ng {
    height: 10px;
    background-position: -3708px 0px;
  }

.drip-tab .iti__flag.iti__ni {
    height: 12px;
    background-position: -3730px 0px;
  }

.drip-tab .iti__flag.iti__nl {
    height: 14px;
    background-position: -3752px 0px;
  }

.drip-tab .iti__flag.iti__no {
    height: 15px;
    background-position: -3774px 0px;
  }

.drip-tab .iti__flag.iti__np {
    height: 15px;
    background-position: -3796px 0px;
  }

.drip-tab .iti__flag.iti__nr {
    height: 10px;
    background-position: -3811px 0px;
  }

.drip-tab .iti__flag.iti__nu {
    height: 10px;
    background-position: -3833px 0px;
  }

.drip-tab .iti__flag.iti__nz {
    height: 10px;
    background-position: -3855px 0px;
  }

.drip-tab .iti__flag.iti__om {
    height: 10px;
    background-position: -3877px 0px;
  }

.drip-tab .iti__flag.iti__pa {
    height: 14px;
    background-position: -3899px 0px;
  }

.drip-tab .iti__flag.iti__pe {
    height: 14px;
    background-position: -3921px 0px;
  }

.drip-tab .iti__flag.iti__pf {
    height: 14px;
    background-position: -3943px 0px;
  }

.drip-tab .iti__flag.iti__pg {
    height: 15px;
    background-position: -3965px 0px;
  }

.drip-tab .iti__flag.iti__ph {
    height: 10px;
    background-position: -3987px 0px;
  }

.drip-tab .iti__flag.iti__pk {
    height: 14px;
    background-position: -4009px 0px;
  }

.drip-tab .iti__flag.iti__pl {
    height: 13px;
    background-position: -4031px 0px;
  }

.drip-tab .iti__flag.iti__pm {
    height: 14px;
    background-position: -4053px 0px;
  }

.drip-tab .iti__flag.iti__pn {
    height: 10px;
    background-position: -4075px 0px;
  }

.drip-tab .iti__flag.iti__pr {
    height: 14px;
    background-position: -4097px 0px;
  }

.drip-tab .iti__flag.iti__ps {
    height: 10px;
    background-position: -4119px 0px;
  }

.drip-tab .iti__flag.iti__pt {
    height: 14px;
    background-position: -4141px 0px;
  }

.drip-tab .iti__flag.iti__pw {
    height: 13px;
    background-position: -4163px 0px;
  }

.drip-tab .iti__flag.iti__py {
    height: 11px;
    background-position: -4185px 0px;
  }

.drip-tab .iti__flag.iti__qa {
    height: 8px;
    background-position: -4207px 0px;
  }

.drip-tab .iti__flag.iti__re {
    height: 14px;
    background-position: -4229px 0px;
  }

.drip-tab .iti__flag.iti__ro {
    height: 14px;
    background-position: -4251px 0px;
  }

.drip-tab .iti__flag.iti__rs {
    height: 14px;
    background-position: -4273px 0px;
  }

.drip-tab .iti__flag.iti__ru {
    height: 14px;
    background-position: -4295px 0px;
  }

.drip-tab .iti__flag.iti__rw {
    height: 14px;
    background-position: -4317px 0px;
  }

.drip-tab .iti__flag.iti__sa {
    height: 14px;
    background-position: -4339px 0px;
  }

.drip-tab .iti__flag.iti__sb {
    height: 10px;
    background-position: -4361px 0px;
  }

.drip-tab .iti__flag.iti__sc {
    height: 10px;
    background-position: -4383px 0px;
  }

.drip-tab .iti__flag.iti__sd {
    height: 10px;
    background-position: -4405px 0px;
  }

.drip-tab .iti__flag.iti__se {
    height: 13px;
    background-position: -4427px 0px;
  }

.drip-tab .iti__flag.iti__sg {
    height: 14px;
    background-position: -4449px 0px;
  }

.drip-tab .iti__flag.iti__sh {
    height: 10px;
    background-position: -4471px 0px;
  }

.drip-tab .iti__flag.iti__si {
    height: 10px;
    background-position: -4493px 0px;
  }

.drip-tab .iti__flag.iti__sj {
    height: 15px;
    background-position: -4515px 0px;
  }

.drip-tab .iti__flag.iti__sk {
    height: 14px;
    background-position: -4537px 0px;
  }

.drip-tab .iti__flag.iti__sl {
    height: 14px;
    background-position: -4559px 0px;
  }

.drip-tab .iti__flag.iti__sm {
    height: 15px;
    background-position: -4581px 0px;
  }

.drip-tab .iti__flag.iti__sn {
    height: 14px;
    background-position: -4603px 0px;
  }

.drip-tab .iti__flag.iti__so {
    height: 14px;
    background-position: -4625px 0px;
  }

.drip-tab .iti__flag.iti__sr {
    height: 14px;
    background-position: -4647px 0px;
  }

.drip-tab .iti__flag.iti__ss {
    height: 10px;
    background-position: -4669px 0px;
  }

.drip-tab .iti__flag.iti__st {
    height: 10px;
    background-position: -4691px 0px;
  }

.drip-tab .iti__flag.iti__sv {
    height: 12px;
    background-position: -4713px 0px;
  }

.drip-tab .iti__flag.iti__sx {
    height: 14px;
    background-position: -4735px 0px;
  }

.drip-tab .iti__flag.iti__sy {
    height: 14px;
    background-position: -4757px 0px;
  }

.drip-tab .iti__flag.iti__sz {
    height: 14px;
    background-position: -4779px 0px;
  }

.drip-tab .iti__flag.iti__ta {
    height: 10px;
    background-position: -4801px 0px;
  }

.drip-tab .iti__flag.iti__tc {
    height: 10px;
    background-position: -4823px 0px;
  }

.drip-tab .iti__flag.iti__td {
    height: 14px;
    background-position: -4845px 0px;
  }

.drip-tab .iti__flag.iti__tf {
    height: 14px;
    background-position: -4867px 0px;
  }

.drip-tab .iti__flag.iti__tg {
    height: 13px;
    background-position: -4889px 0px;
  }

.drip-tab .iti__flag.iti__th {
    height: 14px;
    background-position: -4911px 0px;
  }

.drip-tab .iti__flag.iti__tj {
    height: 10px;
    background-position: -4933px 0px;
  }

.drip-tab .iti__flag.iti__tk {
    height: 10px;
    background-position: -4955px 0px;
  }

.drip-tab .iti__flag.iti__tl {
    height: 10px;
    background-position: -4977px 0px;
  }

.drip-tab .iti__flag.iti__tm {
    height: 14px;
    background-position: -4999px 0px;
  }

.drip-tab .iti__flag.iti__tn {
    height: 14px;
    background-position: -5021px 0px;
  }

.drip-tab .iti__flag.iti__to {
    height: 10px;
    background-position: -5043px 0px;
  }

.drip-tab .iti__flag.iti__tr {
    height: 14px;
    background-position: -5065px 0px;
  }

.drip-tab .iti__flag.iti__tt {
    height: 12px;
    background-position: -5087px 0px;
  }

.drip-tab .iti__flag.iti__tv {
    height: 10px;
    background-position: -5109px 0px;
  }

.drip-tab .iti__flag.iti__tw {
    height: 14px;
    background-position: -5131px 0px;
  }

.drip-tab .iti__flag.iti__tz {
    height: 14px;
    background-position: -5153px 0px;
  }

.drip-tab .iti__flag.iti__ua {
    height: 14px;
    background-position: -5175px 0px;
  }

.drip-tab .iti__flag.iti__ug {
    height: 14px;
    background-position: -5197px 0px;
  }

.drip-tab .iti__flag.iti__um {
    height: 11px;
    background-position: -5219px 0px;
  }

.drip-tab .iti__flag.iti__un {
    height: 14px;
    background-position: -5241px 0px;
  }

.drip-tab .iti__flag.iti__us {
    height: 11px;
    background-position: -5263px 0px;
  }

.drip-tab .iti__flag.iti__uy {
    height: 14px;
    background-position: -5285px 0px;
  }

.drip-tab .iti__flag.iti__uz {
    height: 10px;
    background-position: -5307px 0px;
  }

.drip-tab .iti__flag.iti__va {
    height: 15px;
    background-position: -5329px 0px;
  }

.drip-tab .iti__flag.iti__vc {
    height: 14px;
    background-position: -5346px 0px;
  }

.drip-tab .iti__flag.iti__ve {
    height: 14px;
    background-position: -5368px 0px;
  }

.drip-tab .iti__flag.iti__vg {
    height: 10px;
    background-position: -5390px 0px;
  }

.drip-tab .iti__flag.iti__vi {
    height: 14px;
    background-position: -5412px 0px;
  }

.drip-tab .iti__flag.iti__vn {
    height: 14px;
    background-position: -5434px 0px;
  }

.drip-tab .iti__flag.iti__vu {
    height: 12px;
    background-position: -5456px 0px;
  }

.drip-tab .iti__flag.iti__wf {
    height: 14px;
    background-position: -5478px 0px;
  }

.drip-tab .iti__flag.iti__ws {
    height: 10px;
    background-position: -5500px 0px;
  }

.drip-tab .iti__flag.iti__xk {
    height: 15px;
    background-position: -5522px 0px;
  }

.drip-tab .iti__flag.iti__ye {
    height: 14px;
    background-position: -5544px 0px;
  }

.drip-tab .iti__flag.iti__yt {
    height: 14px;
    background-position: -5566px 0px;
  }

.drip-tab .iti__flag.iti__za {
    height: 14px;
    background-position: -5588px 0px;
  }

.drip-tab .iti__flag.iti__zm {
    height: 14px;
    background-position: -5610px 0px;
  }

.drip-tab .iti__flag.iti__zw {
    height: 10px;
    background-position: -5632px 0px;
  }

.drip-tab .iti__flag {
    height: 15px;
    box-shadow: 0px 0px 1px 0px #888;
    background-image: url("flags.png");
    background-repeat: no-repeat;
    background-position: 20px 0;
  }

.drip-tab .iti__flag.iti__np {
  background-color: transparent;
}

.drip-tab .iti__flag {
  background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags.png");
};

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags@2x.png");
  }
}

/* stylelint-enable */


  /* preview settings */
  body.after-submit-preview .drip-panel:not(.drip-success) {
    display: none !important;
  }
  body.after-submit-preview .drip-success {
    display: block !important;
  }

  /* stylelint-enable */

</style><style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}
</style><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="prefetch" href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/"><link rel="prefetch" href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/"><link rel="prefetch" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/"></head>
<body class="post-template-default single single-post postid-3570 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960"><div class="lp-bar__iframe-wrapper" id="lp-bar-EKEpUWnBPSNWfo6eafZGYE"><iframe class="lp-bar__iframe" scrolling="no" frameborder="0" src="./Autoregression Models for Time Series Forecasting With Python_files/saved_resource.html" data-bar-frame-id="EKEpUWnBPSNWfo6eafZGYE" data-bar-frame-params-key="NO_PARAMS_20160921" data-bar-open-on-load="true"></iframe></div><div class="lp-bar__pusher" id="lp-bar-pusher-EKEpUWnBPSNWfo6eafZGYE"></div>
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img width="480" height="80" src="./Autoregression Models for Time Series Forecasting With Python_files/Header_smaller_text_better-1.webp" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-36" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<script src="./Autoregression Models for Time Series Forecasting With Python_files/embed.js.download" async="" defer=""></script> <a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/" data-leadbox-popup="XzMsunYnjcfQ5t8Csvp7z4" data-leadbox-domain="machinelearningmastery.lpages.co">Click to Take the FREE Time Series Crash-Course</a> 
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-12825" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12825"><a href="https://machinelearningmastery.com/category/optimization/">Optimization</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-3570 post type-post status-publish format-standard has-post-thumbnail hentry category-time-series">
	<header>
	<h1 class="title entry-title">Autoregression Models for Time Series Forecasting With Python</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-01-02T05:00:56+1100">January 2, 2017</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/time-series/" title="View all items in Time Series">Time Series</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3570 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Autoregression+Models+for+Time+Series+Forecasting+With+Python&amp;url=https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on September 7, 2021</p>
<p>Autoregression is a time series model that uses observations from previous time steps as input to a regression equation to predict the value at the next time step.</p>
<p>It is a very simple idea that can result in accurate forecasts on a range of time series problems.</p>
<p>In this tutorial, you will discover how to implement an autoregressive model for time series forecasting with Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to explore your time series data for autocorrelation.</li>
<li>How to develop an autocorrelation model and use it to make predictions.</li>
<li>How to use a developed autocorrelation model to make rolling predictions.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/">Time Series Forecasting With Python</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Updated May/2017</strong>: Fixed small typo in autoregression equation.</li>
<li><strong>Updated Apr/2019</strong>: Updated the link to dataset.</li>
<li><strong>Updated Aug/2019</strong>: Updated data loading to use new API.</li>
<li><strong>Updated Sep/2019</strong>: Updated examples to use latest plotting API.</li>
<li><strong>Updated Apr/2020</strong>: Changed AR to AutoReg due to API change.</li>
</ul>
<div id="attachment_3578" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3578" loading="lazy" class="size-full wp-image-3578" src="./Autoregression Models for Time Series Forecasting With Python_files/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg" alt="Autoregression Models for Time Series Forecasting With Python" width="640" height="425" srcset="https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2017/01/Autoregression-Models-for-Time-Series-Forecasting-With-Python-300x199.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"><p id="caption-attachment-3578" class="wp-caption-text">Autoregression Models for Time Series Forecasting With Python<br>Photo by <a href="https://www.flickr.com/photos/kaibara/6352376941/">Umberto Salvagnin</a>, some rights reserved.</p></div>
<h2>Autoregression</h2>
<p>A regression model, such as linear regression, models an output value based on a linear combination of input values.</p>
<p>For example:</p>
		<div id="urvanov-syntax-highlighter-61775fc354d92082277390" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">yhat = b0 + b1*X1</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d92082277390-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d92082277390-1">yhat = b0 + b1*X1</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Where yhat is the prediction, b0 and b1 are coefficients found by optimizing the model on training data, and X is an input value.</p>
<p>This technique can be used on time series where input variables are taken as observations at previous time steps, called lag variables.</p>
<p>For example, we can predict the value for the next time step (t+1) given the observations at the last two time steps (t-1 and t-2). As a regression model, this would look as follows:</p>
		<div id="urvanov-syntax-highlighter-61775fc354d98033582306" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">X(t+1) = b0 + b1*X(t-1) + b2*X(t-2)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d98033582306-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d98033582306-1">X(t+1) = b0 + b1*X(t-1) + b2*X(t-2)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Because the regression model uses data from the same input variable at previous time steps, it is referred to as an autoregression (regression of self).</p>
<p></p><div class="woo-sc-hr"></div><p></p>
<center>
<h3>Stop learning Time Series Forecasting the <em>slow way</em>!</h3>
<p>Take my free 7-day email course and discover how to get started (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><script src="./Autoregression Models for Time Series Forecasting With Python_files/embed.js.download" async="" defer=""></script> <button data-leadbox-popup="7U3pw6gCGRCSM5PTLfhiKQ" data-leadbox-domain="machinelearningmastery.lpages.co" style="background: rgb(255, 215, 18);border-color: rgb(255, 215, 18);border-radius: 20px;color: #FFFFFF;display: inline-block;vertical-align: middle;padding: 16px 32px;min-width: 192px;border: 1px solid rgb(255, 215, 18);font-size: 1rem;font-family: Helvetica, Arial, sans-serif;text-align: center;outline: 0;line-height: 1;cursor: pointer;-webkit-transition: background 0.3s, color 0.3s, border 0.3s;transition: background 0.3s, color 0.3s, border 0.3s;  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.6);">Start Your FREE Mini-Course Now!</button></p></center>
<p></p><div class="woo-sc-hr"></div><p></p>
<h2>Autocorrelation</h2>
<p>An autoregression model makes an assumption that the observations at previous time steps are useful to predict the value at the next time step.</p>
<p>This relationship between variables is called correlation.</p>
<p>If both variables change in the same direction (e.g. go up together or down together), this is called a positive correlation. If the variables move in opposite directions as values change (e.g. one goes up and one goes down), then this is called negative correlation.</p>
<p>We can use statistical measures to calculate the correlation between the output variable and values at previous time steps at various different lags. The stronger the correlation between the output variable and a specific lagged variable, the more weight that autoregression model can put on that variable when modeling.</p>
<p>Again, because the correlation is calculated between the variable and itself at previous time steps, it is called an autocorrelation. It is also called serial correlation because of the sequenced structure of time series data.</p>
<p>The correlation statistics can also help to choose which lag variables will be useful in a model and which will not.</p>
<p>Interestingly, if all lag variables show low or no correlation with the output variable, then it suggests that the time series problem may not be predictable. This can be very useful when getting started on a new dataset.</p>
<p>In this tutorial, we will investigate the autocorrelation of a univariate time series then develop an autoregression model and use it to make predictions.</p>
<p>Before we do that, let’s first review the Minimum Daily Temperatures data that will be used in the examples.</p>
<h2>Minimum Daily Temperatures Dataset</h2>
<p>This dataset describes the minimum daily temperatures over 10 years (1981-1990) in the city Melbourne, Australia.</p>
<p>The units are in degrees Celsius and there are 3,650 observations. The source of the data is credited as the Australian Bureau of Meteorology.</p>
<ul>
<li><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/daily-min-temperatures.csv">Download the dataset</a>.</li>
</ul>
<p>Download the dataset into your current working directory with the filename “<em>daily-min-temperatures.csv</em>“.</p>
<p>The code below will load the dataset as a Pandas Series.</p>
		<div id="urvanov-syntax-highlighter-61775fc354d99317039369" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -21.8px; display: none;"><div>Copied to the clipboard</div></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from pandas import read_csv
from matplotlib import pyplot
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0)
print(series.head())
series.plot()
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d99317039369-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d99317039369-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d99317039369-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d99317039369-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d99317039369-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d99317039369-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d99317039369-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d99317039369-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d99317039369-3"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d99317039369-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d99317039369-5"><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d99317039369-6"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example&nbsp;prints the first 5 rows from the loaded dataset.</p>
		<div id="urvanov-syntax-highlighter-61775fc354d9a762693685" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Date
1981-01-01 20.7
1981-01-02 17.9
1981-01-03 18.8
1981-01-04 14.6
1981-01-05 15.8
Name: Temp, dtype: float64</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9a762693685-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9a762693685-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9a762693685-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9a762693685-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9a762693685-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9a762693685-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9a762693685-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9a762693685-1">Date</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9a762693685-2">1981-01-01 20.7</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9a762693685-3">1981-01-02 17.9</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9a762693685-4">1981-01-03 18.8</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9a762693685-5">1981-01-04 14.6</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9a762693685-6">1981-01-05 15.8</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9a762693685-7">Name: Temp, dtype: float64</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>A line plot of the dataset is then created.</p>
<div id="attachment_3571" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3571" loading="lazy" class="size-full wp-image-3571" src="./Autoregression Models for Time Series Forecasting With Python_files/Minimum-Daily-Temperature-Dataset-Plot.webp" alt="Minimum Daily Temperature Dataset Plot" width="800" height="600" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/12/Minimum-Daily-Temperature-Dataset-Plot.png 800w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Minimum-Daily-Temperature-Dataset-Plot-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Minimum-Daily-Temperature-Dataset-Plot-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p id="caption-attachment-3571" class="wp-caption-text">Minimum Daily Temperature Dataset Plot</p></div>
<h2>Quick Check for Autocorrelation</h2>
<p>There is a quick, visual check that we can do to see if there is an autocorrelation in our time series dataset.</p>
<p>We can plot the observation at the previous time step (t-1) with the observation at the next time step (t+1) as a scatter plot.</p>
<p>This could be done manually by first creating a lag version of the time series dataset and using a built-in scatter plot function in the Pandas library.</p>
<p>But there is an easier way.</p>
<p>Pandas provides a built-in plot to do exactly this, called the&nbsp;<a href="https://pandas.pydata.org/pandas-docs/version/0.18.1/visualization.html#lag-plot">lag_plot()</a>&nbsp;function.</p>
<p>Below is an example of creating a lag plot of the Minimum Daily Temperatures dataset.</p>
		<div id="urvanov-syntax-highlighter-61775fc354d9b400619880" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -17.8px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from pandas import read_csv
from matplotlib import pyplot
from pandas.plotting import lag_plot
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0)
lag_plot(series)
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9b400619880-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9b400619880-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9b400619880-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9b400619880-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9b400619880-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9b400619880-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9b400619880-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9b400619880-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9b400619880-3"><span class="crayon-e">from </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">plotting </span><span class="crayon-e">import </span><span class="crayon-e">lag_plot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9b400619880-4"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9b400619880-5"><span class="crayon-e">lag_plot</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9b400619880-6"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example plots the temperature data (t) on the x-axis against the temperature on the previous day (t-1) on the y-axis.</p>
<div id="attachment_3572" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3572" loading="lazy" class="size-full wp-image-3572" src="./Autoregression Models for Time Series Forecasting With Python_files/Minimum-Daily-Temperature-Dataset-Lag-Plot.webp" alt="Minimum Daily Temperature Dataset Lag Plot" width="800" height="600" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/12/Minimum-Daily-Temperature-Dataset-Lag-Plot.png 800w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Minimum-Daily-Temperature-Dataset-Lag-Plot-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Minimum-Daily-Temperature-Dataset-Lag-Plot-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p id="caption-attachment-3572" class="wp-caption-text">Minimum Daily Temperature Dataset Lag Plot</p></div>
<p>We can see a large ball of observations along a diagonal line of the plot. It clearly shows a relationship or some <a href="https://machinelearningmastery.com/how-to-use-correlation-to-understand-the-relationship-between-variables/">correlation</a>.</p>
<p>This process could be repeated for any other lagged observation, such as if we wanted to review the relationship with the last 7 days or with the same day last month or last year.</p>
<p>Another quick check that we can do is to directly calculate the correlation between the observation and the lag variable.</p>
<p>We can use a statistical test like the <a href="https://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient">Pearson correlation coefficient</a>. This produces a number to summarize how correlated two variables are between -1 (negatively correlated) and +1 (positively correlated) with small values close to zero indicating low correlation and high values above 0.5 or below -0.5 showing high correlation.</p>
<p>Correlation can be calculated easily using the <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.corr.html">corr()</a> function on the DataFrame of the lagged dataset.</p>
<p>The example below creates a lagged version of the Minimum Daily Temperatures dataset and calculates a correlation matrix of each column with other columns, including itself.</p>
		<div id="urvanov-syntax-highlighter-61775fc354d9c990285164" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -17.8px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from pandas import read_csv
from pandas import DataFrame
from pandas import concat
from matplotlib import pyplot
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0)
values = DataFrame(series.values)
dataframe = concat([values.shift(1), values], axis=1)
dataframe.columns = ['t-1', 't+1']
result = dataframe.corr()
print(result)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9c990285164-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-5"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-6"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-7"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-8"><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'t-1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'t+1'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-9"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">corr</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9c990285164-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>This is a good confirmation for the plot above.</p>
<p>It shows a strong positive correlation (0.77) between the observation and the lag=1 value.</p>
		<div id="urvanov-syntax-highlighter-61775fc354d9d046104234" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">         t-1      t+1
t-1  1.00000  0.77487
t+1  0.77487  1.00000</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9d046104234-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9d046104234-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9d046104234-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9d046104234-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; t-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t+1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9d046104234-2">t-1&nbsp;&nbsp;1.00000&nbsp;&nbsp;0.77487</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9d046104234-3">t+1&nbsp;&nbsp;0.77487&nbsp;&nbsp;1.00000</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>This is good for one-off checks, but tedious if we want to check a large number of lag variables in our time series.</p>
<p>Next, we will look at a scaled-up version of this approach.</p>
<h2>Autocorrelation Plots</h2>
<p>We can plot the correlation coefficient for each lag variable.</p>
<p>This can very quickly give an idea of which lag variables may be good candidates for use in a predictive model and how the relationship between the observation and its historic values changes over time.</p>
<p>We could manually calculate the correlation values for each lag variable and plot the result. Thankfully, Pandas provides a built-in plot called the <a href="https://pandas.pydata.org/pandas-docs/version/0.18.1/visualization.html#autocorrelation-plot">autocorrelation_plot()</a> function.</p>
<p>The plot provides the lag number along the x-axis and the correlation coefficient value between -1 and 1 on the y-axis. The plot also includes solid and dashed lines that indicate the 95% and 99% confidence interval for the correlation values. Correlation values above these lines are more significant than those below the line, providing a threshold or cutoff for selecting more relevant lag values.</p>
		<div id="urvanov-syntax-highlighter-61775fc354d9e099771704" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button crayon-pressed" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -17.8px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 1; opacity: 1; overflow: hidden; height: 86.4px; display: inline-block;">from pandas import read_csv
from matplotlib import pyplot
from pandas.plotting import autocorrelation_plot
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0)
autocorrelation_plot(series)
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 0; overflow: hidden; opacity: 0;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9e099771704-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9e099771704-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9e099771704-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9e099771704-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9e099771704-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9e099771704-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9e099771704-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9e099771704-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9e099771704-3"><span class="crayon-e">from </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">plotting </span><span class="crayon-e">import </span><span class="crayon-e">autocorrelation_plot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9e099771704-4"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9e099771704-5"><span class="crayon-e">autocorrelation_plot</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9e099771704-6"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example shows the swing in positive and negative correlation as the temperature values change across summer and winter seasons each previous year.</p>
<div id="attachment_3573" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3573" loading="lazy" class="size-full wp-image-3573" src="./Autoregression Models for Time Series Forecasting With Python_files/Pandas-Autocorrelation-Plot.webp" alt="Pandas Autocorrelation Plot" width="800" height="600" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/12/Pandas-Autocorrelation-Plot.png 800w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Pandas-Autocorrelation-Plot-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Pandas-Autocorrelation-Plot-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p id="caption-attachment-3573" class="wp-caption-text">Pandas Autocorrelation Plot</p></div>
<p>The statsmodels library also provides a version of the plot in the <a href="http://statsmodels.sourceforge.net/devel/generated/statsmodels.graphics.tsaplots.plot_acf.html">plot_acf()</a> function as a line plot.</p>
		<div id="urvanov-syntax-highlighter-61775fc354d9f103667828" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -17.8px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from pandas import read_csv
from matplotlib import pyplot
from statsmodels.graphics.tsaplots import plot_acf
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0)
plot_acf(series, lags=31)
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9f103667828-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9f103667828-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9f103667828-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9f103667828-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354d9f103667828-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354d9f103667828-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9f103667828-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9f103667828-2"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9f103667828-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">graphics</span><span class="crayon-sy">.</span><span class="crayon-e">tsaplots </span><span class="crayon-e">import </span><span class="crayon-e">plot_acf</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9f103667828-4"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354d9f103667828-5"><span class="crayon-e">plot_acf</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lags</span><span class="crayon-o">=</span><span class="crayon-cn">31</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354d9f103667828-6"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>In this example, we limit the lag variables evaluated to 31 for readability.</p>
<div id="attachment_3574" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3574" loading="lazy" class="size-full wp-image-3574" src="./Autoregression Models for Time Series Forecasting With Python_files/Statsmodels-Autocorrelation-Plot.webp" alt="Statsmodels Autocorrelation Plot" width="800" height="600" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/12/Statsmodels-Autocorrelation-Plot.png 800w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Statsmodels-Autocorrelation-Plot-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Statsmodels-Autocorrelation-Plot-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p id="caption-attachment-3574" class="wp-caption-text">Statsmodels Autocorrelation Plot</p></div>
<p>Now that we know how to review the autocorrelation in our time series, let’s look at modeling it with an autoregression.</p>
<p>Before we do that, let’s establish a baseline performance.</p>
<h2>Persistence Model</h2>
<p>Let’s say that we want to develop a model to predict the last 7 days of minimum temperatures in the dataset given all prior observations.</p>
<p>The simplest model that we could use to make predictions would be to persist the last observation. We can call this a persistence model and it provides a baseline of performance for the problem that we can use for comparison with an autoregression model.</p>
<p>We can develop a test harness for the problem by splitting the observations into training and test sets, with only the last 7 observations in the dataset assigned to the test set as “unseen” data that we wish to predict.</p>
<p>The predictions are made using a walk-forward validation model so that we&nbsp;can persist the most recent observations for the next day. This means that we are not making a 7-day forecast, but 7 1-day forecasts.</p>
		<div id="urvanov-syntax-highlighter-61775fc354da0488365441" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -17.8px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">from pandas import read_csv
from pandas import DataFrame
from pandas import concat
from matplotlib import pyplot
from sklearn.metrics import mean_squared_error
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0)
# create lagged dataset
values = DataFrame(series.values)
dataframe = concat([values.shift(1), values], axis=1)
dataframe.columns = ['t-1', 't+1']
# split into train and test sets
X = dataframe.values
train, test = X[1:len(X)-7], X[len(X)-7:]
train_X, train_y = train[:,0], train[:,1]
test_X, test_y = test[:,0], test[:,1]

# persistence model
def model_persistence(x):
	return x

# walk-forward validation
predictions = list()
for x in test_X:
	yhat = model_persistence(x)
	predictions.append(yhat)
test_score = mean_squared_error(test_y, predictions)
print('Test MSE: %.3f' % test_score)
# plot predictions vs expected
pyplot.plot(test_y)
pyplot.plot(predictions, color='red')
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da0488365441-31">31</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-6"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-7"><span class="crayon-p"># create lagged dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-8"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-9"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-10"><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'t-1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'t+1'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-11"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-13"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-14"><span class="crayon-v">train_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-15"><span class="crayon-v">test_X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-17"><span class="crayon-p"># persistence model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-18"><span class="crayon-e">def </span><span class="crayon-e">model_persistence</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-19"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-21"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-22"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-23"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-24"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">model_persistence</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-25"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-26"><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-27"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test MSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">test_score</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-28"><span class="crayon-p"># plot predictions vs expected</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-29"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-30"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da0488365441-31"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example prints the mean squared error (MSE).</p>
<p>The value provides a baseline performance for the problem.</p>
		<div id="urvanov-syntax-highlighter-61775fc354da1420862845" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; z-index: 4; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Test MSE: 3.423</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da1420862845-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da1420862845-1">Test MSE: 3.423</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The expected values for the next 7 days are plotted (blue) compared to the predictions from the model (red).</p>
<div id="attachment_3575" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3575" loading="lazy" class="size-full wp-image-3575" src="./Autoregression Models for Time Series Forecasting With Python_files/Predictions-From-Persistence-Model.webp" alt="Predictions From Persistence Model" width="800" height="600" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Persistence-Model.png 800w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Persistence-Model-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Persistence-Model-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p id="caption-attachment-3575" class="wp-caption-text">Predictions From Persistence Model</p></div>
<h2>Autoregression Model</h2>
<p>An autoregression model is a linear regression model that uses lagged variables as input variables.</p>
<p>We could calculate the linear regression model manually using the LinearRegession class in scikit-learn and manually specify the lag input variables to use.</p>
<p>Alternately, the statsmodels library provides an autoregression model where you must specify an appropriate lag value and trains a linear regression model. It is provided in the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AutoReg.html">AutoReg</a>&nbsp;class.</p>
<p>We can use this model by first creating the model AutoReg() and then calling fit() to train it on our dataset. This returns an <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AutoRegResults.html">AutoRegResults</a> object.</p>
<p>Once fit, we can use the model to make a prediction by calling the predict() function for a number of observations in the future. This creates 1 7-day forecast, which is different from the persistence example above.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-61775fc354da2424627880" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -17.8px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># create and evaluate a static autoregressive model
from pandas import read_csv
from matplotlib import pyplot
from statsmodels.tsa.ar_model import AutoReg
from sklearn.metrics import mean_squared_error
from math import sqrt
# load dataset
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0, parse_dates=True, squeeze=True)
# split dataset
X = series.values
train, test = X[1:len(X)-7], X[len(X)-7:]
# train autoregression
model = AutoReg(train, lags=29)
model_fit = model.fit()
print('Coefficients: %s' % model_fit.params)
# make predictions
predictions = model_fit.predict(start=len(train), end=len(train)+len(test)-1, dynamic=False)
for i in range(len(predictions)):
	print('predicted=%f, expected=%f' % (predictions[i], test[i]))
rmse = sqrt(mean_squared_error(test, predictions))
print('Test RMSE: %.3f' % rmse)
# plot results
pyplot.plot(test)
pyplot.plot(predictions, color='red')
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da2424627880-25">25</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-1"><span class="crayon-p"># create and evaluate a static autoregressive model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-4"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">ar_model </span><span class="crayon-e">import </span><span class="crayon-e">AutoReg</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-6"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-i">sqrt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-7"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-8"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-9"><span class="crayon-p"># split dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-10"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-11"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-12"><span class="crayon-p"># train autoregression</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-13"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AutoReg</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lags</span><span class="crayon-o">=</span><span class="crayon-cn">29</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-14"><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Coefficients: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-v">params</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-16"><span class="crayon-p"># make predictions</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-17"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">start</span><span class="crayon-o">=</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">end</span><span class="crayon-o">=</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dynamic</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-18"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-19"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'predicted=%f, expected=%f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-20"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-21"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-22"><span class="crayon-p"># plot results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-23"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-24"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da2424627880-25"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example the list of coefficients in the trained linear regression model.</p>
<p>The 7 day forecast is then printed and the mean squared error of the forecast is summarized.</p>
		<div id="urvanov-syntax-highlighter-61775fc354da3608716908" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Coefficients: [ 5.57543506e-01  5.88595221e-01 -9.08257090e-02  4.82615092e-02
  4.00650265e-02  3.93020055e-02  2.59463738e-02  4.46675960e-02
  1.27681498e-02  3.74362239e-02 -8.11700276e-04  4.79081949e-03
  1.84731397e-02  2.68908418e-02  5.75906178e-04  2.48096415e-02
  7.40316579e-03  9.91622149e-03  3.41599123e-02 -9.11961877e-03
  2.42127561e-02  1.87870751e-02  1.21841870e-02 -1.85534575e-02
 -1.77162867e-03  1.67319894e-02  1.97615668e-02  9.83245087e-03
  6.22710723e-03 -1.37732255e-03]
predicted=11.871275, expected=12.900000
predicted=13.053794, expected=14.600000
predicted=13.532591, expected=14.000000
predicted=13.243126, expected=13.600000
predicted=13.091438, expected=13.500000
predicted=13.146989, expected=15.700000
predicted=13.176153, expected=13.000000
Test RMSE: 1.225</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da3608716908-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-1">Coefficients: [ 5.57543506e-01&nbsp;&nbsp;5.88595221e-01 -9.08257090e-02&nbsp;&nbsp;4.82615092e-02</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-2">&nbsp;&nbsp;4.00650265e-02&nbsp;&nbsp;3.93020055e-02&nbsp;&nbsp;2.59463738e-02&nbsp;&nbsp;4.46675960e-02</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-3">&nbsp;&nbsp;1.27681498e-02&nbsp;&nbsp;3.74362239e-02 -8.11700276e-04&nbsp;&nbsp;4.79081949e-03</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-4">&nbsp;&nbsp;1.84731397e-02&nbsp;&nbsp;2.68908418e-02&nbsp;&nbsp;5.75906178e-04&nbsp;&nbsp;2.48096415e-02</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-5">&nbsp;&nbsp;7.40316579e-03&nbsp;&nbsp;9.91622149e-03&nbsp;&nbsp;3.41599123e-02 -9.11961877e-03</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-6">&nbsp;&nbsp;2.42127561e-02&nbsp;&nbsp;1.87870751e-02&nbsp;&nbsp;1.21841870e-02 -1.85534575e-02</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-7"> -1.77162867e-03&nbsp;&nbsp;1.67319894e-02&nbsp;&nbsp;1.97615668e-02&nbsp;&nbsp;9.83245087e-03</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-8">&nbsp;&nbsp;6.22710723e-03 -1.37732255e-03]</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-9">predicted=11.871275, expected=12.900000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-10">predicted=13.053794, expected=14.600000</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-11">predicted=13.532591, expected=14.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-12">predicted=13.243126, expected=13.600000</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-13">predicted=13.091438, expected=13.500000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-14">predicted=13.146989, expected=15.700000</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-15">predicted=13.176153, expected=13.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da3608716908-16">Test RMSE: 1.225</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>A plot of the expected (blue) vs the predicted values (red) is made.</p>
<p>The forecast does look pretty good (about 1 degree Celsius out each day), with big deviation on day 5.</p>
<div id="attachment_3576" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3576" loading="lazy" class="size-full wp-image-3576" src="./Autoregression Models for Time Series Forecasting With Python_files/Predictions-From-Fixed-AR-Model.webp" alt="Predictions From Fixed AR Model" width="800" height="600" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Fixed-AR-Model.png 800w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Fixed-AR-Model-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Fixed-AR-Model-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p id="caption-attachment-3576" class="wp-caption-text">Predictions From Fixed AR Model</p></div>
<p>The statsmodels API does not make it easy to update the model as new observations become available.</p>
<p>One way would be to re-train the AutoReg model each day as new observations become available, and that may be a valid approach, if not computationally expensive.</p>
<p>An alternative would be to use the learned coefficients and manually make predictions. This requires that the history of 29 prior observations be kept and that the coefficients be retrieved from the model and used in the regression equation to come up with new forecasts.</p>
<p>The coefficients are provided in an array with the intercept term followed by the coefficients for each lag variable starting at t-1 to t-n. We simply need to use them in the right order on the history of observations, as follows:</p>
		<div id="urvanov-syntax-highlighter-61775fc354da4191647462" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">yhat = b0 + b1*X1 + b2*X2 ... bn*Xn</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da4191647462-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da4191647462-1">yhat = b0 + b1*X1 + b2*X2 ... bn*Xn</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Below is the complete example.</p>
		<div id="urvanov-syntax-highlighter-61775fc354da5418586232" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -17.8px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># create and evaluate an updated autoregressive model
from pandas import read_csv
from matplotlib import pyplot
from statsmodels.tsa.ar_model import AutoReg
from sklearn.metrics import mean_squared_error
from math import sqrt
# load dataset
series = read_csv('daily-min-temperatures.csv', header=0, index_col=0, parse_dates=True, squeeze=True)
# split dataset
X = series.values
train, test = X[1:len(X)-7], X[len(X)-7:]
# train autoregression
window = 29
model = AutoReg(train, lags=29)
model_fit = model.fit()
coef = model_fit.params
# walk forward over time steps in test
history = train[len(train)-window:]
history = [history[i] for i in range(len(history))]
predictions = list()
for t in range(len(test)):
	length = len(history)
	lag = [history[i] for i in range(length-window,length)]
	yhat = coef[0]
	for d in range(window):
		yhat += coef[d+1] * lag[window-d-1]
	obs = test[t]
	predictions.append(yhat)
	history.append(obs)
	print('predicted=%f, expected=%f' % (yhat, obs))
rmse = sqrt(mean_squared_error(test, predictions))
print('Test RMSE: %.3f' % rmse)
# plot
pyplot.plot(test)
pyplot.plot(predictions, color='red')
pyplot.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da5418586232-36">36</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-1"><span class="crayon-p"># create and evaluate an updated autoregressive model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-4"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">ar_model </span><span class="crayon-e">import </span><span class="crayon-e">AutoReg</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-6"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-i">sqrt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-7"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-8"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-min-temperatures.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-9"><span class="crayon-p"># split dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-10"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-11"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-12"><span class="crayon-p"># train autoregression</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-13"><span class="crayon-v">window</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">29</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-14"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AutoReg</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lags</span><span class="crayon-o">=</span><span class="crayon-cn">29</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-15"><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-16"><span class="crayon-v">coef</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-i">params</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-17"><span class="crayon-p"># walk forward over time steps in test</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-18"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">window</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-19"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-20"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-21"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-22"><span class="crayon-h">	</span><span class="crayon-v">length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-23"><span class="crayon-h">	</span><span class="crayon-v">lag</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">length</span><span class="crayon-o">-</span><span class="crayon-v">window</span><span class="crayon-sy">,</span><span class="crayon-v">length</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-24"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coef</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-25"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">window</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-26"><span class="crayon-h">		</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">coef</span><span class="crayon-sy">[</span><span class="crayon-v">d</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">lag</span><span class="crayon-sy">[</span><span class="crayon-v">window</span><span class="crayon-o">-</span><span class="crayon-v">d</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-27"><span class="crayon-h">	</span><span class="crayon-v">obs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-28"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-29"><span class="crayon-h">	</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">obs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-30"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'predicted=%f, expected=%f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">obs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-31"><span class="crayon-v">rmse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test RMSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">rmse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-33"><span class="crayon-p"># plot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-34"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-35"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da5418586232-36"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Again, running the example prints the forecast and the mean squared error.</p>
		<div id="urvanov-syntax-highlighter-61775fc354da6094506326" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">predicted=11.871275, expected=12.900000
predicted=13.659297, expected=14.600000
predicted=14.349246, expected=14.000000
predicted=13.427454, expected=13.600000
predicted=13.374877, expected=13.500000
predicted=13.479991, expected=15.700000
predicted=14.765146, expected=13.000000
Test RMSE: 1.204</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc354da6094506326-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-1">predicted=11.871275, expected=12.900000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-2">predicted=13.659297, expected=14.600000</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-3">predicted=14.349246, expected=14.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-4">predicted=13.427454, expected=13.600000</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-5">predicted=13.374877, expected=13.500000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-6">predicted=13.479991, expected=15.700000</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-7">predicted=14.765146, expected=13.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc354da6094506326-8">Test RMSE: 1.204</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can see a small improvement in the forecast when comparing the error scores.</p>
<div id="attachment_3577" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3577" loading="lazy" class="size-full wp-image-3577" src="./Autoregression Models for Time Series Forecasting With Python_files/Predictions-From-Rolling-AR-Model.webp" alt="Predictions From Rolling AR Model" width="800" height="600" srcset="https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Rolling-AR-Model.png 800w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Rolling-AR-Model-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2016/12/Predictions-From-Rolling-AR-Model-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px"><p id="caption-attachment-3577" class="wp-caption-text">Predictions From Rolling AR Model</p></div>
<h2>Further Reading</h2>
<p>This section provides&nbsp;some resources if you are looking to dig deeper into autocorrelation and autoregression.</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Autocorrelation">Autocorrelation</a> on Wikipedia</li>
<li><a href="https://en.wikipedia.org/wiki/Autoregressive_model">Autoregressive</a> model on Wikipedia</li>
<li>Chapter 7 – Regression-Based Models: Autocorrelation and External Information, <a href="https://amzn.to/33YCJag">Practical Time Series Forecasting with R: A Hands-On Guide</a>.</li>
<li>Section 4.5 – Autoregressive Models, <a href="https://amzn.to/2XYS8DD">Introductory Time Series with R</a>.</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to make autoregression forecasts for time series data using Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>About autocorrelation and autoregression and how they can be used to better understand time series data.</li>
<li>How to explore the autocorrelation in a time series using plots and statistical tests.</li>
<li>How to train an autoregression model in Python and use it to make short-term and rolling forecasts.</li>
</ul>
<p>Do you have any questions about autoregression, or about this tutorial?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="widget_text awac-wrapper" id="custom_html-64"><div class="widget_text awac widget custom_html-64"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Want to Develop Time Series Forecasts with Python?</h2>
<a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" rel="nofollow"><img width="220" height="311" src="./Autoregression Models for Time Series Forecasting With Python_files/Introduction-to-Time-Series-Forecasting-With-Python-220.png" alt="Introduction to Time Series Forecasting With Python" align="left" style="border: 0;"></a>
<h4>Develop Your Own Forecasts in Minutes</h4>

...with just a few lines of python code

<p>Discover how in my new Ebook:<br>
	<a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" rel="nofollow">Introduction to Time Series Forecasting With Python</a></p>

<p>It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:
	<em>Loading data, visualization, modeling, algorithm tuning,</em> and much more...</p>

<h4>Finally Bring Time Series Forecasting to<br>
Your Own Projects</h4>

	<p>Skip the Academics. Just Results.</p>

<a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" class="woo-sc-button  red"><span class="woo-">See What's Inside</span></a>

<div class="woo-sc-hr"></div>
</div></div></div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3570 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Autoregression+Models+for+Time+Series+Forecasting+With+Python&amp;url=https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<div class="crp_related  "><h3>More On This Topic</h3><ul><li><a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" class="crp_link post-3522"><figure><img loading="lazy" width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/How-To-Backtest-Machine-Learning-Models-for-Time-Series-Forecasting-150x150.jpg" class="crp_thumb crp_featured" alt="How To Backtest Machine Learning Models for Time Series Forecasting" title="How To Backtest Machine Learning Models for Time Series Forecasting"></figure><span class="crp_title">How To Backtest Machine Learning Models for Time…</span></a></li><li><a href="https://machinelearningmastery.com/simple-time-series-forecasting-models/" class="crp_link post-3858"><figure><img loading="lazy" width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/Line-Plot-of-Predicted-Values-vs-Test-Dataset-for-the-t-12-Persistence-Model-150x150.webp" class="crp_thumb crp_featured" alt="Simple Time Series Forecasting Models to Test So That You Don&#39;t Fool Yourself" title="Simple Time Series Forecasting Models to Test So That You Don&#39;t Fool Yourself"></figure><span class="crp_title">Simple Time Series Forecasting Models to Test So…</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/" class="crp_link post-6286"><figure><img loading="lazy" width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/How-to-Develop-LSTM-Models-for-Multi-Step-Time-Series-Forecasting-of-Household-Power-Consumption-150x150.jpg" class="crp_thumb crp_featured" alt="Multi-Step LSTM Time Series Forecasting Models for Power Usage" title="Multi-Step LSTM Time Series Forecasting Models for Power Usage"></figure><span class="crp_title">Multi-Step LSTM Time Series Forecasting Models for…</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-autoregressive-forecasting-models-for-multi-step-air-pollution-time-series-forecasting/" class="crp_link post-6323"><figure><img loading="lazy" width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/Impact-of-Dataset-Size-on-Deep-Learning-Model-Skill-And-Performance-Estimates-150x150.jpg" class="crp_thumb crp_featured" alt="How to Develop Multi-Step Time Series Forecasting Models for Air Pollution" title="How to Develop Multi-Step Time Series Forecasting Models for Air Pollution"></figure><span class="crp_title">How to Develop Multi-Step Time Series Forecasting…</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-machine-learning-models-for-multivariate-multi-step-air-pollution-time-series-forecasting/" class="crp_link post-6333"><figure><img loading="lazy" width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/How-to-Develop-Machine-Learning-Models-for-Multivariate-Multi-Step-Air-Pollution-Time-Series-Forecasting-150x150.jpg" class="crp_thumb crp_featured" alt="How to Develop Multivariate Multi-Step Time Series Forecasting Models for Air Pollution" title="How to Develop Multivariate Multi-Step Time Series Forecasting Models for Air Pollution"></figure><span class="crp_title">How to Develop Multivariate Multi-Step Time Series…</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-deep-learning-models-for-univariate-time-series-forecasting/" class="crp_link post-6365"><figure><img loading="lazy" width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/Line-Plot-of-Monthly-Car-Sales-150x150.webp" class="crp_thumb crp_featured" alt="Deep Learning Models for Univariate Time Series Forecasting" title="Deep Learning Models for Univariate Time Series Forecasting"></figure><span class="crp_title">Deep Learning Models for Univariate Time Series Forecasting</span></a></li></ul><div class="crp_clear"></div></div>	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a.png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80" loading="lazy"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/time-series-data-stationary-python/" rel="prev"><i class="fa fa-angle-left"></i> How to Check if Time Series Data is Stationary with Python</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/time-series-data-visualization-with-python/" rel="next">Time Series Data Visualization with Python <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">195 Responses to <em>Autoregression Models for Time Series Forecasting With Python</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-380420" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-380420" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/38d5c41300a1c4df8a44f40a2639ce99.jpeg" srcset="https://secure.gravatar.com/avatar/38d5c41300a1c4df8a44f40a2639ce99?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://garybake.com/" rel="external nofollow ugc" class="url">Gary Bake</a></span>
	                <span class="date">January 5, 2017 at 11:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-380420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason for the awesome article</p>
<p>In case anyone hits the same problem I had –<br>
I downloaded the data from the link above as a csv file.<br>
It was failing to be imported due to three rows in the temperature column containing ‘?’.<br>
Once these were removed the data imported ok.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-380420" data-commentid="380420" data-postid="3570" data-belowelement="comment-380420" data-respondelement="respond" data-replyto="Reply to Gary Bake" aria-label="Reply to Gary Bake">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-380509" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-380509" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 6, 2017 at 9:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-380509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the heads up Gary.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-380509" data-commentid="380509" data-postid="3570" data-belowelement="comment-380509" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515422" class="comment even depth-3 parent">

	      	<div id="li-comment-515422" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/42255a9c47341afb4060e7e7847e18a8.png" srcset="https://secure.gravatar.com/avatar/42255a9c47341afb4060e7e7847e18a8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">yaser alsultan</span>
	                <span class="date">December 16, 2019 at 3:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-515422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi man , what do you think the best model that can deal with hour</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-515422" data-commentid="515422" data-postid="3570" data-belowelement="comment-515422" data-respondelement="respond" data-replyto="Reply to yaser alsultan" aria-label="Reply to yaser alsultan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515496" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-515496" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 17, 2019 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-515496" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are no best algorithms. I recommend testing a suite of methods in order to discover what works best for your specific dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-515496" data-commentid="515496" data-postid="3570" data-belowelement="comment-515496" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381999" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-381999" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/591c635d47119dd2e0f121b5e5b70918.png" srcset="https://secure.gravatar.com/avatar/591c635d47119dd2e0f121b5e5b70918?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tim Melino</span>
	                <span class="date">January 14, 2017 at 10:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-381999" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, thanks for the article. How would you go about forecasting from the end of the file when expected value is not known?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-381999" data-commentid="381999" data-postid="3570" data-belowelement="comment-381999" data-respondelement="respond" data-replyto="Reply to Tim Melino" aria-label="Reply to Tim Melino">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-382144" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-382144" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 15, 2017 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-382144" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Tim, you can use mode.predict() as in the example and specify the index of the time step to be predicted.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-382144" data-commentid="382144" data-postid="3570" data-belowelement="comment-382144" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451714" class="comment even depth-3 parent">

	      	<div id="li-comment-451714" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/63631aa96765d66c7b41d92de828de15.jpeg" srcset="https://secure.gravatar.com/avatar/63631aa96765d66c7b41d92de828de15?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Siddhant Bhambri</span>
	                <span class="date">October 16, 2018 at 12:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451714" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, I am not clear with the use of model.predict(). If you could help me on this in predicting the values for the next 10 days if the model has learned the values till today.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451714" data-commentid="451714" data-postid="3570" data-belowelement="comment-451714" data-respondelement="respond" data-replyto="Reply to Siddhant Bhambri" aria-label="Reply to Siddhant Bhambri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451739" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-451739" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 16, 2018 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451739" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, see this post:<br>
<a href="https://machinelearningmastery.com/make-sample-forecasts-arima-python/" rel="nofollow ugc">https://machinelearningmastery.com/make-sample-forecasts-arima-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451739" data-commentid="451739" data-postid="3570" data-belowelement="comment-451739" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-384084" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-384084" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b8029b71424fd2751bdd1f8ca454c68e.png" srcset="https://secure.gravatar.com/avatar/b8029b71424fd2751bdd1f8ca454c68e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Farrukh Jalali</span>
	                <span class="date">January 25, 2017 at 4:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-384084" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for all of your wonderful blogs. They are really helping a lot. One question regarding this post is that I believe that AR modeling also presume that time series is stationary as the observations should be i.i.d. .Does that AR function from statsmodels library checks for stationary and use the de-trended de-seasonalized time series by itself if required? Also, if we use sckit learn library for AR model as you described do we need to check for and make adjustments by ourselfs for this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-384084" data-commentid="384084" data-postid="3570" data-belowelement="comment-384084" data-respondelement="respond" data-replyto="Reply to Farrukh Jalali" aria-label="Reply to Farrukh Jalali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384212" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-384212" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 26, 2017 at 4:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-384212" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Farrukh, great question.</p>
<p>The AR in statsmodels does assume that the data is stationary. </p>
<p>If your data is not stationary, you must make it stationary (e.g. differencing and other transforms).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-384212" data-commentid="384212" data-postid="3570" data-belowelement="comment-384212" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385168" class="comment even depth-3 parent">

	      	<div id="li-comment-385168" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b8029b71424fd2751bdd1f8ca454c68e.png" srcset="https://secure.gravatar.com/avatar/b8029b71424fd2751bdd1f8ca454c68e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Farrukh Jalali</span>
	                <span class="date">January 31, 2017 at 12:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-385168" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the answer. Though we did not conduct proper test here for trend/seasonal stationarity check in the example above but from figure apparently it seems like that there is a seasonal effect. So in that case whether applying AR model is good to go?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-385168" data-commentid="385168" data-postid="3570" data-belowelement="comment-385168" data-respondelement="respond" data-replyto="Reply to Farrukh Jalali" aria-label="Reply to Farrukh Jalali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-385409" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-385409" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2017 at 10:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-385409" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question Farrukh.</p>
<p>AR is designed to be used on stationary data, meaning data with no seasonal or trend information.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-385409" data-commentid="385409" data-postid="3570" data-belowelement="comment-385409" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-385261" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-385261" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/bb823af8cc4abd7f4cce662fb8a4317b.png" srcset="https://secure.gravatar.com/avatar/bb823af8cc4abd7f4cce662fb8a4317b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Farrukh Jalali</span>
	                <span class="date">January 31, 2017 at 11:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-385261" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Or to be specific, is it OK to apply AR model direct here on the given data without checking the seasonality and removing it if present which is showing some signs in first graph apparently?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-385261" data-commentid="385261" data-postid="3570" data-belowelement="comment-385261" data-respondelement="respond" data-replyto="Reply to Farrukh Jalali" aria-label="Reply to Farrukh Jalali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-574325" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-574325" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a512d58fccd034af4e04628880fce333.png" srcset="https://secure.gravatar.com/avatar/a512d58fccd034af4e04628880fce333?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muneeb</span>
	                <span class="date">November 11, 2020 at 4:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-574325" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi. I am working on something similar and i have the same question? in the above AR model, the normal non transformed time series has been used and it has not been made stationary? is that correct and applicable?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-574325" data-commentid="574325" data-postid="3570" data-belowelement="comment-574325" data-respondelement="respond" data-replyto="Reply to Muneeb" aria-label="Reply to Muneeb">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-574357" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-574357" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 11, 2020 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-574357" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is a good idea to make the series stationary before using an AR model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-574357" data-commentid="574357" data-postid="3570" data-belowelement="comment-574357" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391743" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-391743" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4cacef8937b1a3db309c7ba456c6f66a.png" srcset="https://secure.gravatar.com/avatar/4cacef8937b1a3db309c7ba456c6f66a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony of Sydney</span>
	                <span class="date">March 8, 2017 at 5:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391743" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr Jason,<br>
I had a go at the ‘persistence model’ section.<br>
The dataset I used was the sp500.csv dataset.<br>
From your code</p>
		<div id="urvanov-syntax-highlighter-61775fc359338549537050" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># persistence model
def model_persistence(x):
	return x
 
# walk-forward validation
predictions = list()
for x in test_X:
	yhat = model_persistence(x)
	predictions.append(yhat)
test_score = mean_squared_error(test_y, predictions)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359338549537050-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359338549537050-1"><span class="crayon-p"># persistence model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359338549537050-2"><span class="crayon-e">def </span><span class="crayon-e">model_persistence</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359338549537050-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359338549537050-4"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359338549537050-5"><span class="crayon-p"># walk-forward validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359338549537050-6"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359338549537050-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test_X</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359338549537050-8"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">model_persistence</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359338549537050-9"><span class="crayon-h">	</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359338549537050-10"><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>As soon as I try to compute the “test_score”, I get the following error,</p>
		<div id="urvanov-syntax-highlighter-61775fc359339417597574" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Traceback (most recent call last):
  File "", line 1, in 
    test_score = mean_squared_error(test_y,predictions)
  File "C:\Python34\lib\site-packages\sklearn\metrics\regression.py", line 232, in mean_squared_error
    output_errors = np.average((y_true - y_pred) ** 2, axis=0,
TypeError: ufunc 'subtract' did not contain a loop with signature matching types dtype('&lt;U32') dtype('&lt;U32') dtype('&lt;U32')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359339417597574-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359339417597574-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359339417597574-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359339417597574-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359339417597574-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359339417597574-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359339417597574-1"><span class="crayon-e">Traceback</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">most </span><span class="crayon-e">recent </span><span class="crayon-e">call </span><span class="crayon-v">last</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359339417597574-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">File</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">line</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359339417597574-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359339417597574-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">File</span><span class="crayon-h"> </span><span class="crayon-s">"C:\Python34\lib\site-packages\sklearn\metrics\regression.py"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">line</span><span class="crayon-h"> </span><span class="crayon-cn">232</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359339417597574-5"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">output_errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">average</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y_true</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">y_pred</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359339417597574-6"><span class="crayon-v">TypeError</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">ufunc</span><span class="crayon-h"> </span><span class="crayon-s">'subtract'</span><span class="crayon-h"> </span><span class="crayon-e">did </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">contain</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">loop </span><span class="crayon-e">with </span><span class="crayon-e">signature </span><span class="crayon-e">matching </span><span class="crayon-e">types </span><span class="crayon-e">dtype</span><span class="crayon-sy">(</span><span class="crayon-s">'&lt;U32'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">dtype</span><span class="crayon-sy">(</span><span class="crayon-s">'&lt;U32'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">dtype</span><span class="crayon-sy">(</span><span class="crayon-s">'&lt;U32'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Any idea,<br>
Anthony of Sydney NSW</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391743" data-commentid="391743" data-postid="3570" data-belowelement="comment-391743" data-respondelement="respond" data-replyto="Reply to Anthony of Sydney" aria-label="Reply to Anthony of Sydney">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391775" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-391775" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2017 at 9:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391775" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It looks like you need to convert your data to floating point values.</p>
<p>E.g. in numpy this might be:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-61775fc3592d7645705572" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">X = X.astype('float32')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc3592d7645705572-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc3592d7645705572-1"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391775" data-commentid="391775" data-postid="3570" data-belowelement="comment-391775" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391747" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-391747" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4cacef8937b1a3db309c7ba456c6f66a.png" srcset="https://secure.gravatar.com/avatar/4cacef8937b1a3db309c7ba456c6f66a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony of Sydney who noticed that it was a string not a float</span>
	                <span class="date">March 8, 2017 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391747" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr Jason,<br>
Fixed the problem. You cannot assume that all *.csv numbers are floats or ints. For some reason, the numbers seem to be enclosed in quotes. Note that the data is is for the sp500.csv not the above exercise.<br>
Note the numbers in the output are enclosed in quotes:</p>
		<div id="urvanov-syntax-highlighter-61775fc359321146708506" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">test_y
array(['1.331', '1.412', '1.474', '1.559', '1.585', '1.788', '1.817'], dtype=object)
&gt;&gt;&gt; predictions
['1.24', '1.331', '1.412', '1.474', '1.559', '1.585', '1.788']
&gt;&gt;&gt; test_y = [float(i) for i in test_y] # convert string to float
&gt;&gt;&gt; predictions = [float(i) for i in predictions]  # convert string to float
&gt;&gt;&gt; test_score = mean_squared_error(test_y,predictions)
&gt;&gt;&gt; test_score
0.009805285714285716</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359321146708506-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359321146708506-1"><span class="crayon-e">test_y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359321146708506-2"><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'1.331'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.412'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.474'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.559'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.585'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.788'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.817'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-t">object</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359321146708506-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-i">predictions</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359321146708506-4"><span class="crayon-sy">[</span><span class="crayon-s">'1.24'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.331'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.412'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.474'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.559'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.585'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.788'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359321146708506-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-p"># convert string to float</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359321146708506-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-p"># convert string to float</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359321146708506-7"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359321146708506-8"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>score</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359321146708506-9"><span class="crayon-cn">0.009805285714285716</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>It works now,<br>
Regards<br>
Anthony from Sydney</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391747" data-commentid="391747" data-postid="3570" data-belowelement="comment-391747" data-respondelement="respond" data-replyto="Reply to Anthony of Sydney who noticed that it was a string not a float" aria-label="Reply to Anthony of Sydney who noticed that it was a string not a float">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391776" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-391776" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2017 at 9:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391776" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear you fixed it Anthony.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391776" data-commentid="391776" data-postid="3570" data-belowelement="comment-391776" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391749" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-391749" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4cacef8937b1a3db309c7ba456c6f66a.png" srcset="https://secure.gravatar.com/avatar/4cacef8937b1a3db309c7ba456c6f66a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony from Sydney</span>
	                <span class="date">March 8, 2017 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391749" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Dr Jason,<br>
The problem has been fixed. The values in the array were strings, so I had to convert them to strings.</p>
		<div id="urvanov-syntax-highlighter-61775fc3592ff963169052" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">test_y
array(['1.331', '1.412', '1.474', '1.559', '1.585', '1.788', '1.817'], dtype=object)
&gt;&gt;&gt; predictions
['1.24', '1.331', '1.412', '1.474', '1.559', '1.585', '1.788']</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc3592ff963169052-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc3592ff963169052-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc3592ff963169052-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc3592ff963169052-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc3592ff963169052-1"><span class="crayon-e">test_y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc3592ff963169052-2"><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'1.331'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.412'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.474'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.559'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.585'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.788'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.817'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-t">object</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc3592ff963169052-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-i">predictions</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc3592ff963169052-4"><span class="crayon-sy">[</span><span class="crayon-s">'1.24'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.331'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.412'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.474'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.559'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.585'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'1.788'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>So I converted the strings in each array to float.</p>
		<div id="urvanov-syntax-highlighter-61775fc359301345941515" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; test_y = [float(i) for i in test_y]
&gt;&gt;&gt; predictions = [float(i) for i in predictions]
&gt;&gt;&gt; test_score = mean_squared_error(test_y,predictions)
&gt;&gt;&gt; test_score
0.009805285714285716</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359301345941515-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359301345941515-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359301345941515-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc359301345941515-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc359301345941515-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359301345941515-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test_y</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359301345941515-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359301345941515-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">test_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test_y</span><span class="crayon-sy">,</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc359301345941515-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>score</div><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc359301345941515-5"><span class="crayon-cn">0.009805285714285716</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Hope that helps others trying to convert values to appropriate data types in order to do numerical calculations.<br>
Anthony from Sydney NSW</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-391749" data-commentid="391749" data-postid="3570" data-belowelement="comment-391749" data-respondelement="respond" data-replyto="Reply to Anthony from Sydney" aria-label="Reply to Anthony from Sydney">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-396667" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-396667" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/031f62d3b95d4b8e2fadebce9fd1c660.png" srcset="https://secure.gravatar.com/avatar/031f62d3b95d4b8e2fadebce9fd1c660?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Johnson S</span>
	                <span class="date">April 17, 2017 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-396667" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how can I show my prediction as date, instead of log, for example I have data set incident number for each week, I want to predict the following week<br>
week1 669<br>
week2 443<br>
week3 555</p>
<p>so on april week 1 I want to show time series the prediction of week1 week2 of April</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-396667" data-commentid="396667" data-postid="3570" data-belowelement="comment-396667" data-respondelement="respond" data-replyto="Reply to Johnson S" aria-label="Reply to Johnson S">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-396773" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-396773" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 18, 2017 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-396773" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I’m not sure I understand. Perhaps you can give a fuller example of inputs and outputs?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-396773" data-commentid="396773" data-postid="3570" data-belowelement="comment-396773" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398021" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-398021" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/1de7cb3ce23fa4409cd195c19bd12674.png" srcset="https://secure.gravatar.com/avatar/1de7cb3ce23fa4409cd195c19bd12674?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chika</span>
	                <span class="date">April 30, 2017 at 2:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-398021" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this wonderful tutorial. I discovered your articles on facebook last year. Since then I have been following all your tutorials and I must confess that, though I started learning about machine learning in less than a year, my knowledge base has tremendously increased as a result of this free services you have been posting for all to see on the website.<br>
Thanks once more for this generosity Dr Jason.</p>
<p>My question is that, I have carefully followed all your procedures in this article on my data set that was recorded every 10mins for 2 months. Please I would like to know which time lag is appropriate for forecasting to see the next 7 days value or more or less. </p>
<p>My time series is a stationary one according to the test statistics and histogram I have applied on it. but I still don’t know if a reasonable conclusion can be reached with a data set that was recorded for 2 months every 10mins daily.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-398021" data-commentid="398021" data-postid="3570" data-belowelement="comment-398021" data-respondelement="respond" data-replyto="Reply to Chika" aria-label="Reply to Chika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398040" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-398040" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 30, 2017 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-398040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done on your progress!</p>
<p>This post gives you some ideas on how to select suitable q and p values (lag vars):<br>
<a href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow ugc">http://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>
<p>I hope that helps as a start.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-398040" data-commentid="398040" data-postid="3570" data-belowelement="comment-398040" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399609" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-399609" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/d483b162ef39f2663c9a42d4abecbc12.png" srcset="https://secure.gravatar.com/avatar/d483b162ef39f2663c9a42d4abecbc12?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Soy</span>
	                <span class="date">May 14, 2017 at 4:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-399609" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr Jason,<br>
Thank you so much for this post.  I have finally learned how to go from theory to practice.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-399609" data-commentid="399609" data-postid="3570" data-belowelement="comment-399609" data-respondelement="respond" data-replyto="Reply to Soy" aria-label="Reply to Soy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399634" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-399634" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 14, 2017 at 7:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-399634" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m so glad to hear that Soy, thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-399634" data-commentid="399634" data-postid="3570" data-belowelement="comment-399634" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-401897" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-401897" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4580a6a0fa2888f7b28d2e8da4e6b891.png" srcset="https://secure.gravatar.com/avatar/4580a6a0fa2888f7b28d2e8da4e6b891?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akshit Mantri</span>
	                <span class="date">June 8, 2017 at 10:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-401897" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dr Jason, How do i predict the low and high confidence interval of prediction of an AR model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-401897" data-commentid="401897" data-postid="3570" data-belowelement="comment-401897" data-respondelement="respond" data-replyto="Reply to Akshit Mantri" aria-label="Reply to Akshit Mantri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401942" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-401942" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 9, 2017 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-401942" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post will help:<br>
<a href="https://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/" rel="nofollow ugc">http://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-401942" data-commentid="401942" data-postid="3570" data-belowelement="comment-401942" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401993" class="comment even depth-3 parent">

	      	<div id="li-comment-401993" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4580a6a0fa2888f7b28d2e8da4e6b891.png" srcset="https://secure.gravatar.com/avatar/4580a6a0fa2888f7b28d2e8da4e6b891?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akshit Mantri</span>
	                <span class="date">June 9, 2017 at 5:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-401993" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply. It was a very good post. But, it was for ARIMA model. I am having some problem with the ARIMA model I cannot use it. Is there such a confidence interval forecasting for AR model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-401993" data-commentid="401993" data-postid="3570" data-belowelement="comment-401993" data-respondelement="respond" data-replyto="Reply to Akshit Mantri" aria-label="Reply to Akshit Mantri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402071" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-402071" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 10, 2017 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402071" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I believe the same approach applies. Use the forecast() function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402071" data-commentid="402071" data-postid="3570" data-belowelement="comment-402071" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402221" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-402221" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/93cfcfd4301040716d5a98980091d3e0.png" srcset="https://secure.gravatar.com/avatar/93cfcfd4301040716d5a98980091d3e0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Daoud</span>
	                <span class="date">June 11, 2017 at 9:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402221" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>ValueError: On entry to DLASCL parameter number 4 had an illegal value<br>
I ma found above error when i use<br>
model = AR(train) ## no error<br>
model_fit = model.fit() ## show above error</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402221" data-commentid="402221" data-postid="3570" data-belowelement="comment-402221" data-respondelement="respond" data-replyto="Reply to Daoud" aria-label="Reply to Daoud">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-402558" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-402558" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c0ed995ea1b7a6bada0f2bb3c8769144.png" srcset="https://secure.gravatar.com/avatar/c0ed995ea1b7a6bada0f2bb3c8769144?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samuel N</span>
	                <span class="date">June 15, 2017 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great write-up Jason. One question though , I am interested in doing an autoregression on my timeseries data every nth days. For example. Picking the first 20 days and predicting the value of the 20th day. Then picking the next 20 days (shift 1 over) and predict the value of the 21st day and so forth until the end of my dataset. How can this be achieved in code? Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402558" data-commentid="402558" data-postid="3570" data-belowelement="comment-402558" data-respondelement="respond" data-replyto="Reply to Samuel N" aria-label="Reply to Samuel N">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402587" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-402587" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 15, 2017 at 8:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402587" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider using a variation of walk forward validation:<br>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402587" data-commentid="402587" data-postid="3570" data-belowelement="comment-402587" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402620" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-402620" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b334674fc91705160eb6d88be41ae562.png" srcset="https://secure.gravatar.com/avatar/b334674fc91705160eb6d88be41ae562?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhineshkumar</span>
	                <span class="date">June 15, 2017 at 5:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your article. I have few doubts. </p>
<p>1) We do analysis on the autocorrelation plots and auto-correlation function only after making the time series stationary right?</p>
<p>2) For the time series above, the correlation value is maximum for lag=1. So is it like the value at t-1 is given more weight while doing Autoregression?</p>
<p>3) When the AR model says, for lag-29 model the MSE is minimum. Does it mean the regression model constructed with values from t to t-29 gave minimum MSE?</p>
<p>Please clarify.</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402620" data-commentid="402620" data-postid="3570" data-belowelement="comment-402620" data-respondelement="respond" data-replyto="Reply to Dhineshkumar" aria-label="Reply to Dhineshkumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402691" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-402691" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 16, 2017 at 7:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402691" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>1. Ideally, yes, analysis after the data is stationary.</p>
<p>2. Yes.</p>
<p>3. Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402691" data-commentid="402691" data-postid="3570" data-belowelement="comment-402691" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402750" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-402750" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b334674fc91705160eb6d88be41ae562.png" srcset="https://secure.gravatar.com/avatar/b334674fc91705160eb6d88be41ae562?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhineshkumar</span>
	                <span class="date">June 16, 2017 at 6:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402750" data-commentid="402750" data-postid="3570" data-belowelement="comment-402750" data-respondelement="respond" data-replyto="Reply to Dhineshkumar" aria-label="Reply to Dhineshkumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402831" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-402831" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 17, 2017 at 7:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402831" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-402831" data-commentid="402831" data-postid="3570" data-belowelement="comment-402831" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-403156" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-403156" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/659126a0695929bc84e5c91d65f259f7.jpeg" srcset="https://secure.gravatar.com/avatar/659126a0695929bc84e5c91d65f259f7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TaeWoo Kim</span>
	                <span class="date">June 20, 2017 at 10:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403156" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason. Thanks for the awesome tutorial. </p>
<p>in this line…</p>
<p>print(‘Lag: %s’ % model_fit.k_ar)<br>
print(‘Coefficients: %s’ % model_fit.params)</p>
<p>What is the “layman” explanation of what lag and coeffcients are?</p>
<p>Is it that “lag” is what the AR model determined that the significance ends (i.e. after this number, the autocorrelation isn’t “strong enough) and that the coeff. are the p-value of null hypotehsis on “intensity” of the autocorrelation?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403156" data-commentid="403156" data-postid="3570" data-belowelement="comment-403156" data-respondelement="respond" data-replyto="Reply to TaeWoo Kim" aria-label="Reply to TaeWoo Kim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403254" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-403254" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2017 at 8:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Lag observations are observations at prior time steps.</p>
<p>Lag coefficients are the weightings on those lag observations.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403254" data-commentid="403254" data-postid="3570" data-belowelement="comment-403254" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403359" class="comment odd alt depth-3">

	      	<div id="li-comment-403359" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/659126a0695929bc84e5c91d65f259f7.jpeg" srcset="https://secure.gravatar.com/avatar/659126a0695929bc84e5c91d65f259f7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TaeWoo Kim</span>
	                <span class="date">June 22, 2017 at 5:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403359" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason. That answer has still gotten me more confused. 🙂</p>
<p>The section where you manually calculate the predictions.. you’re specifying history.append(obs). So does this mean that the test data up to t0 is required to predict t1?</p>
<p>In another words, this model can only predict 1 time period away ? </p>
<p>If I am  wrong, how do I tweak the code to predict up to n periods away?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403359" data-commentid="403359" data-postid="3570" data-belowelement="comment-403359" data-respondelement="respond" data-replyto="Reply to TaeWoo Kim" aria-label="Reply to TaeWoo Kim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-403360" class="comment even depth-3 parent">

	      	<div id="li-comment-403360" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/659126a0695929bc84e5c91d65f259f7.jpeg" srcset="https://secure.gravatar.com/avatar/659126a0695929bc84e5c91d65f259f7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TaeWoo Kim</span>
	                <span class="date">June 22, 2017 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403360" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i think i answered my own after reading this… <a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow ugc">http://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>Example you gave with statsmodels.tsa.ar_model.AR is for single step prediction, am I correct?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403360" data-commentid="403360" data-postid="3570" data-belowelement="comment-403360" data-respondelement="respond" data-replyto="Reply to TaeWoo Kim" aria-label="Reply to TaeWoo Kim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403375" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-403375" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 22, 2017 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403375" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct, but the forecast() function for ARIMA (and maybe AR) can make a multi-step forecast. It might just not be very good.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-403375" data-commentid="403375" data-postid="3570" data-belowelement="comment-403375" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415116" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-415116" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/baf9c76c92d159ff6775fa94cc44ee51.png" srcset="https://secure.gravatar.com/avatar/baf9c76c92d159ff6775fa94cc44ee51?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://n/a" rel="external nofollow ugc" class="url">Yigit Yazicioglu</a></span>
	                <span class="date">September 30, 2017 at 12:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-415116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason</p>
<p>Thanks for this wonderful guideline. I have a problem with my dataset and I am digging in time series modeling.</p>
<p>I try to model a physical model such that</p>
<p>y(t+1) = y(t) + f(a(t), b(t), c(t))  with AR models.</p>
<p>Actually problem is predict metal temperature using basic heat transfer where y means metal Temperature and f is a function of some sensors data like coolant mass flow rate, coolant temperaute, gas flowrate and gas temperatue.</p>
<p>Which model do you advise to use?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-415116" data-commentid="415116" data-postid="3570" data-belowelement="comment-415116" data-respondelement="respond" data-replyto="Reply to Yigit Yazicioglu" aria-label="Reply to Yigit Yazicioglu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415166" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-415166" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2017 at 7:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-415166" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds like a great problem. I would recommend testing a suite of different methods to see what works best for your specific data, given your specific modeling requirements.</p>
<p>I recommend this process generally:<br>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#process</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-415166" data-commentid="415166" data-postid="3570" data-belowelement="comment-415166" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416469" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-416469" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/700773399ea8ef688b2fb01ab4ef2894.png" srcset="https://secure.gravatar.com/avatar/700773399ea8ef688b2fb01ab4ef2894?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Monika</span>
	                <span class="date">October 13, 2017 at 3:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416469" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason…<br>
I read your few articles and found very helpful. I am very new to machine learning and would like to ask the meaning of these prediction points such as predicted=14.349246 so what is the meaning of this value does it mean???</p>
<p>how does it help to understanding the prediction?</p>
<p>please post about cross regression also if you have posted any.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416469" data-commentid="416469" data-postid="3570" data-belowelement="comment-416469" data-respondelement="respond" data-replyto="Reply to Monika" aria-label="Reply to Monika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416492" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-416492" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 13, 2017 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416492" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t follow. Perhaps you can rephrase your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416492" data-commentid="416492" data-postid="3570" data-belowelement="comment-416492" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416842" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416842" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/746201ba61ea26d2667d659c7d016ed3.png" srcset="https://secure.gravatar.com/avatar/746201ba61ea26d2667d659c7d016ed3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shantanu</span>
	                <span class="date">October 16, 2017 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the wonderful article.<br>
I have a question: How can we make a prediction based on multiple columns by AR?<br>
For an example, there are columns of<br>
Date, Pricing, ABC, PQR<br>
ABC, PQR contribute in predicting prices. So I want to predict pricing based on these columns as well.<br>
Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416842" data-commentid="416842" data-postid="3570" data-belowelement="comment-416842" data-respondelement="respond" data-replyto="Reply to Shantanu" aria-label="Reply to Shantanu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-416883" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-416883" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 16, 2017 at 3:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416883" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may be possible, but I do not have a worked example, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-416883" data-commentid="416883" data-postid="3570" data-belowelement="comment-416883" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417464" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-417464" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/e151c36bd662cda745a9673736f0306a.png" srcset="https://secure.gravatar.com/avatar/e151c36bd662cda745a9673736f0306a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ryan Berger</span>
	                <span class="date">October 22, 2017 at 4:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-417464" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How could you make this a Deep Autoregressive Network  with Keras?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-417464" data-commentid="417464" data-postid="3570" data-belowelement="comment-417464" data-respondelement="respond" data-replyto="Reply to Ryan Berger" aria-label="Reply to Ryan Berger">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417484" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-417484" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2017 at 5:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-417484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A deep MLP will do the trick!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-417484" data-commentid="417484" data-postid="3570" data-belowelement="comment-417484" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419555" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-419555" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c58696a79141bb4e1b1ce8753d7b70c4.png" srcset="https://secure.gravatar.com/avatar/c58696a79141bb4e1b1ce8753d7b70c4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Forouq</span>
	                <span class="date">November 10, 2017 at 3:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-419555" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the amazing tutorial<br>
I have a question though. According to Pandas’ Autocorrelation plot, the maximum correlation is gained when lag=1. But the AR model selects lag=29 to build the autoregression.<br>
I checked this code on my dataset, and the autoregression with lag=1 performed much better on test case that lag=14 chosen by AR model. Can you explain this? I thought that autocorrelation checks for linear relationship, thus, the autoregression which maps a linear function to the data should naturally perform best on the lag variable giving the maximum Pearson correlation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-419555" data-commentid="419555" data-postid="3570" data-belowelement="comment-419555" data-respondelement="respond" data-replyto="Reply to Forouq" aria-label="Reply to Forouq">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419587" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-419587" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 10, 2017 at 10:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-419587" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the method was confused by noise in the data or small sample size?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-419587" data-commentid="419587" data-postid="3570" data-belowelement="comment-419587" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420490" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-420490" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/0b39faaf71eb22579bd9ba00fde0662d.png" srcset="https://secure.gravatar.com/avatar/0b39faaf71eb22579bd9ba00fde0662d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Duplec</span>
	                <span class="date">November 19, 2017 at 12:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-420490" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What if time is also included along with the date?<br>
1981-01-01,20.7 is like 1981-01-01 03:00:00,20.7</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-420490" data-commentid="420490" data-postid="3570" data-belowelement="comment-420490" data-respondelement="respond" data-replyto="Reply to Duplec" aria-label="Reply to Duplec">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420538" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420538" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 19, 2017 at 11:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-420538" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-420538" data-commentid="420538" data-postid="3570" data-belowelement="comment-420538" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421218" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-421218" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4fe3d93026508e6047c55004f8081fb9.png" srcset="https://secure.gravatar.com/avatar/4fe3d93026508e6047c55004f8081fb9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sam</span>
	                <span class="date">November 26, 2017 at 11:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-421218" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi great tutorial. Just wanted to ask how would I change the order or lag in the code? Also if you had any tutorials for understanding how to use the statsmodels library.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-421218" data-commentid="421218" data-postid="3570" data-belowelement="comment-421218" data-respondelement="respond" data-replyto="Reply to sam" aria-label="Reply to sam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421281" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-421281" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 27, 2017 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-421281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My book is the best source of material on the topic:<br>
<a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" rel="nofollow ugc">https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/</a></p>
<p>You can either difference your code directly or use the d parameter in the ARIMA model to control the differencing order. I have tutorials on both, perhaps start here:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-421281" data-commentid="421281" data-postid="3570" data-belowelement="comment-421281" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425224" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-425224" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/0d11114de46a24f0d8284b4d52c6e2e4.png" srcset="https://secure.gravatar.com/avatar/0d11114de46a24f0d8284b4d52c6e2e4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">At</span>
	                <span class="date">December 31, 2017 at 4:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-425224" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot! I ran into a problem while developing the AR model when some of the dates were dropped. I had to mention the frequency parameter even though I was already supplying the date-times</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-425224" data-commentid="425224" data-postid="3570" data-belowelement="comment-425224" data-respondelement="respond" data-replyto="Reply to At" aria-label="Reply to At">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425237" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-425237" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 31, 2017 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-425237" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting. Did it fix your issues?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-425237" data-commentid="425237" data-postid="3570" data-belowelement="comment-425237" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432070" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432070" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/999db3b51c385d9af8e14bd130858968.png" srcset="https://secure.gravatar.com/avatar/999db3b51c385d9af8e14bd130858968?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carolyn</span>
	                <span class="date">March 14, 2018 at 1:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-432070" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Excellent article! Any chance of a blog post on how to do vector autoregression with big data? Sometimes an LSTM is overkill, and even a vanilla RNN can be overkill, so something with just plain old autoregression would be great. </p>
<p>The VAR package in Python does this, but it runs into memory issues very quickly with large, sparse datasets. </p>
<p>If you know of any other tools for vector autoregression, any insight you have would be appreciated!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-432070" data-commentid="432070" data-postid="3570" data-belowelement="comment-432070" data-respondelement="respond" data-replyto="Reply to Carolyn" aria-label="Reply to Carolyn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432112" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432112" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-432112" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion Carolyn.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-432112" data-commentid="432112" data-postid="3570" data-belowelement="comment-432112" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435712" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-435712" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b3d3e1671f9b2a8ba9784edf28b4582e.png" srcset="https://secure.gravatar.com/avatar/b3d3e1671f9b2a8ba9784edf28b4582e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harshil</span>
	                <span class="date">April 23, 2018 at 7:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-435712" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>                    Thank you so much for your wonderful article. I have a doubt regarding Data driven forecasting. I need to forecast appliance energy which depends upon 26 variables.I have data of appliance energy along with 26 variables of 3 months. With the help of 26 variables How can I forecast appliance energy for future?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-435712" data-commentid="435712" data-postid="3570" data-belowelement="comment-435712" data-respondelement="respond" data-replyto="Reply to Harshil" aria-label="Reply to Harshil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435759" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-435759" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 24, 2018 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-435759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>You can transform the data into a supervised learning problem and try a suite of machine learning algorithms:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow ugc">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<p>I hope to provide more information on this topic in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-435759" data-commentid="435759" data-postid="3570" data-belowelement="comment-435759" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438836" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438836" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/f39792fd30e32aaa9cdf7d1b1c604242.png" srcset="https://secure.gravatar.com/avatar/f39792fd30e32aaa9cdf7d1b1c604242?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Praveen</span>
	                <span class="date">May 27, 2018 at 10:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-438836" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason!<br>
Thank you for the article. I have a doubt regarding this. How can I make predictions for future dates, that are not present in the dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-438836" data-commentid="438836" data-postid="3570" data-belowelement="comment-438836" data-respondelement="respond" data-replyto="Reply to Praveen" aria-label="Reply to Praveen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438874" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438874" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 28, 2018 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-438874" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Call model.predict() and specify the dates or index.</p>
<p>This tutorial will show you how:<br>
<a href="https://machinelearningmastery.com/make-sample-forecasts-arima-python/" rel="nofollow ugc">https://machinelearningmastery.com/make-sample-forecasts-arima-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-438874" data-commentid="438874" data-postid="3570" data-belowelement="comment-438874" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441549" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-441549" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/f86da80f1da839df3d4215aa35fffec5.png" srcset="https://secure.gravatar.com/avatar/f86da80f1da839df3d4215aa35fffec5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashish</span>
	                <span class="date">June 21, 2018 at 5:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-441549" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can you please provide me a detaile example over VAR model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-441549" data-commentid="441549" data-postid="3570" data-belowelement="comment-441549" data-respondelement="respond" data-replyto="Reply to Ashish" aria-label="Reply to Ashish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441597" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-441597" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 22, 2018 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-441597" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I hope to cover the method in the future, thanks for the suggestion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-441597" data-commentid="441597" data-postid="3570" data-belowelement="comment-441597" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443136" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443136" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c8e2b6e4f96473aeeed7ae6299e3fbdf.png" srcset="https://secure.gravatar.com/avatar/c8e2b6e4f96473aeeed7ae6299e3fbdf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bhaskar Sharan</span>
	                <span class="date">July 10, 2018 at 6:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-443136" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>from pandas import Series<br>
from matplotlib import pyplot<br>
series = Series.from_csv(‘G:\Study_Material\daily-minimum-temperatures.csv’)<br>
print(series.head())<br>
series.plot()<br>
pyplot.show()</p>
<p>ha an error as : Empty ‘DataFrame’: no numeric data to plot</p>
<p>how to resolve it sir?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-443136" data-commentid="443136" data-postid="3570" data-belowelement="comment-443136" data-respondelement="respond" data-replyto="Reply to Bhaskar Sharan" aria-label="Reply to Bhaskar Sharan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443171" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-443171" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2018 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-443171" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps double check you have loaded the data correctly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-443171" data-commentid="443171" data-postid="3570" data-belowelement="comment-443171" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444772" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-444772" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/767aef895c9b533895d2e5225999243f.png" srcset="https://secure.gravatar.com/avatar/767aef895c9b533895d2e5225999243f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vijay</span>
	                <span class="date">July 30, 2018 at 10:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-444772" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Its a wonderful post that I came across and thanks a lot putting up great content with great examples. I am new to machine learning and I have a question regarding the use of ARIMA for sparse timeseries.  I have events that can recur every day, week, once a few weeks, or monthly. Typical example of this could be business meetings. Different meetings could happen at different frequencies. Is it appropriate to use ARIMA for predicting the underlying pattern. My real world problem involves predicting the size of virtual meetings based on their past history. Lets assume a service like hangout. I am trying to see if ARIMA would be an appropriate algorithm for predicting resource requirement for a virtual meeting based on its history. I tried ARIMA based on this tutorial but the results weren’t convincing. I wasn’t sure if its appropriate to model this problem as a time series problem and is ARIMA a good choice for such problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-444772" data-commentid="444772" data-postid="3570" data-belowelement="comment-444772" data-respondelement="respond" data-replyto="Reply to Vijay" aria-label="Reply to Vijay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444787" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444787" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 30, 2018 at 2:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-444787" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it as a starting point.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-444787" data-commentid="444787" data-postid="3570" data-belowelement="comment-444787" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445459" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-445459" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/08a482f6ddaddbba360b7baac61e449e.png" srcset="https://secure.gravatar.com/avatar/08a482f6ddaddbba360b7baac61e449e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tim Boons</span>
	                <span class="date">August 7, 2018 at 6:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-445459" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m trying to work out o AR model to forecast a series using a lag of 192.</p>
<p>The series has a datapoint every 15 min but the you receive the data, the day after it was measured.<br>
So you have to forecast the next day (D+1) with data of the previous day (D-1) hence a lag of 192 in datapoints that are 15 min apart.</p>
<p>Is there a way to contrain the AR() function to all datapoints before t-192 ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-445459" data-commentid="445459" data-postid="3570" data-belowelement="comment-445459" data-respondelement="respond" data-replyto="Reply to Tim Boons" aria-label="Reply to Tim Boons">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445510" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-445510" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 8, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-445510" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps fit a regularized linear regression model directly on your chosen lags?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-445510" data-commentid="445510" data-postid="3570" data-belowelement="comment-445510" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446094" class="comment even depth-3 parent">

	      	<div id="li-comment-446094" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9c89c3334467c15412ec6d754d6a0daa.png" srcset="https://secure.gravatar.com/avatar/9c89c3334467c15412ec6d754d6a0daa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tim Boons</span>
	                <span class="date">August 14, 2018 at 10:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-446094" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply!</p>
<p>Were can I find some more information about a regularized lineair regression model ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-446094" data-commentid="446094" data-postid="3570" data-belowelement="comment-446094" data-respondelement="respond" data-replyto="Reply to Tim Boons" aria-label="Reply to Tim Boons">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446128" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-446128" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-446128" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Any good book on machine learning, for example:<br>
<a href="https://amzn.to/2KSoQ0a" rel="nofollow ugc">https://amzn.to/2KSoQ0a</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-446128" data-commentid="446128" data-postid="3570" data-belowelement="comment-446128" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447058" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-447058" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/25ecfeeb867f23cc962b6bcfa4dcd2b3.jpeg" srcset="https://secure.gravatar.com/avatar/25ecfeeb867f23cc962b6bcfa4dcd2b3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kamal Pokharel</span>
	                <span class="date">August 27, 2018 at 4:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot for this lovely article</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447058" data-commentid="447058" data-postid="3570" data-belowelement="comment-447058" data-respondelement="respond" data-replyto="Reply to Kamal Pokharel" aria-label="Reply to Kamal Pokharel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447092" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-447092" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 28, 2018 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m happy it helped.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447092" data-commentid="447092" data-postid="3570" data-belowelement="comment-447092" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447116" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447116" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/6a577ffea4b4f3ca67cbb727f37a008e.jpeg" srcset="https://secure.gravatar.com/avatar/6a577ffea4b4f3ca67cbb727f37a008e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Allison</span>
	                <span class="date">August 28, 2018 at 1:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Brownlee,</p>
<p>Fantastic article — I’m following along step by step and it’s helping.</p>
<p>at the step:<br>
model.fit()</p>
<p>I get this error:<br>
TypeError: Cannot find a common data type.</p>
<p>Where could this come from?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447116" data-commentid="447116" data-postid="3570" data-belowelement="comment-447116" data-respondelement="respond" data-replyto="Reply to Allison" aria-label="Reply to Allison">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447170" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-447170" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2018 at 7:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447170" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is odd. Are you using the code and data from the tutorial?</p>
<p>Did you replace the “?” chars in the data file?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-447170" data-commentid="447170" data-postid="3570" data-belowelement="comment-447170" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-450157" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-450157" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b38376e8266417ab4576f2c68671b605.png" srcset="https://secure.gravatar.com/avatar/b38376e8266417ab4576f2c68671b605?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Phil</span>
	                <span class="date">September 29, 2018 at 4:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-450157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Shouldn’t your first equation be:</p>
<p>X(t) = b0 + b1*X(t-1) + b2*X(t-2)</p>
<p>Instead of:</p>
<p>X(t+1) = b0 + b1*X(t-1) + b2*X(t-2)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-450157" data-commentid="450157" data-postid="3570" data-belowelement="comment-450157" data-respondelement="respond" data-replyto="Reply to Phil" aria-label="Reply to Phil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450181" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-450181" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 29, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-450181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Then where is “t”?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-450181" data-commentid="450181" data-postid="3570" data-belowelement="comment-450181" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498745" class="comment even depth-3 parent">

	      	<div id="li-comment-498745" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b3fab977c148e4516b671c3c9e8a9357.png" srcset="https://secure.gravatar.com/avatar/b3fab977c148e4516b671c3c9e8a9357?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">asieh</span>
	                <span class="date">August 28, 2019 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-498745" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have the same question as Phil, and I’m not sure what you mean by the answer. When you wrote: “we can predict the value for the next time step (t+1) given the observations at the last two time steps (t-1 and t-2)”, the last two time steps for (t+1) are t, t-1 not t-1 and t-2.<br>
Why did you jump over t?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-498745" data-commentid="498745" data-postid="3570" data-belowelement="comment-498745" data-respondelement="respond" data-replyto="Reply to asieh" aria-label="Reply to asieh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498754" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-498754" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b3fab977c148e4516b671c3c9e8a9357.png" srcset="https://secure.gravatar.com/avatar/b3fab977c148e4516b671c3c9e8a9357?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">asieh</span>
	                <span class="date">August 28, 2019 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-498754" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>also, in the following sentence you said it the right way: </p>
<p>“We can plot the observation at the previous time step (t-1) with the observation at the next time step (t+1) as a scatter plot.”</p>
<p>So you are talking of current time (t) vs previous step (t-1) vs next step (t+1). </p>
<p>That’s why I don’t think the formula should be as Phil mentioned.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-498754" data-commentid="498754" data-postid="3570" data-belowelement="comment-498754" data-respondelement="respond" data-replyto="Reply to asieh" aria-label="Reply to asieh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498771" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-498771" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 28, 2019 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-498771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, thanks.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451374" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-451374" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/ca6ad6364c425d8d8ece64eb4e33599a.png" srcset="https://secure.gravatar.com/avatar/ca6ad6364c425d8d8ece64eb4e33599a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ML Uros</span>
	                <span class="date">October 12, 2018 at 2:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451374" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Great job with your blog and this article!<br>
I was wondering if you could help me with the following question: in your example, you choose 7 points as your test set and the AR model has a lower MSE for these points than the persistence model. However, if I make the test set larger, say a couple hundred points, and make AR predictions, I get a higher MSE with the AR model. I know a couple hundred points means like a year of data points and the AR model could be updated in between to obtain better results, but I was just wondering what is your view on this matter. Does it mean that the AR model is not suitable for predictions too far in the future?<br>
Also, if I use the AR model for predicting about 180 points, AR’s MSE value rises quite significantly, to roughly 9. Interestingly, if the test set is enlarged even more to about 350 points, MSE value falls to about 7. Persistence model’s MSE has lower variability. What does this changing MSE say about the data and applying AR to it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451374" data-commentid="451374" data-postid="3570" data-belowelement="comment-451374" data-respondelement="respond" data-replyto="Reply to ML Uros" aria-label="Reply to ML Uros">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451398" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-451398" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 12, 2018 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451398" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The further you predict into the future, the worse the performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451398" data-commentid="451398" data-postid="3570" data-belowelement="comment-451398" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451543" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-451543" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/13aa94b80474cd28d6c27ac315956162.png" srcset="https://secure.gravatar.com/avatar/13aa94b80474cd28d6c27ac315956162?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dieu Do</span>
	                <span class="date">October 13, 2018 at 1:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451543" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Dr. Jason Brownlee,</p>
<p>Thanks a lot for your excellent article.<br>
I have a question related to predicted results.<br>
Why the predicted solution at i-th point is very close the expected solution at (i-1)-th point ?<br>
In all most your article, I have seen this.<br>
I don’t understand why? Can you help me answer this question, please?</p>
<p>Thank you so much Dr Jason Brownlee.</p>
<p>Best,<br>
Dieu Do</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451543" data-commentid="451543" data-postid="3570" data-belowelement="comment-451543" data-respondelement="respond" data-replyto="Reply to Dieu Do" aria-label="Reply to Dieu Do">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451580" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-451580" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451580" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is a common question that I answer here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-451580" data-commentid="451580" data-postid="3570" data-belowelement="comment-451580" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-452300" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-452300" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/81c88f52b6177f17044325ed3e4986c8.png" srcset="https://secure.gravatar.com/avatar/81c88f52b6177f17044325ed3e4986c8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yingfei</span>
	                <span class="date">October 22, 2018 at 1:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-452300" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for your sharing. </p>
<p>I am trying to use AR model to predict a complex-valued time series. I used a series as below and replace the tempreature data in your example code:</p>
<p>series = Series([1, 1+1j, 2, 3, 4, 5, 8, 1+2j, 3, 5])</p>
<p>However, it reports an error message like this:</p>
<p>/anaconda/lib/python3.6/site-packages/statsmodels/tsa/tsatools.py in lagmat(x, maxlag, trim, original, use_pandas)<br>
    377         dropidx = nvar<br>
    378     if maxlag &gt;= nobs:<br>
–&gt; 379         raise ValueError(“maxlag should be &lt; nobs")<br>
    380     lm = np.zeros((nobs + maxlag, nvar * (maxlag + 1)))<br>
    381     for k in range(0, int(maxlag + 1)):</p>
<p>ValueError: maxlag should be &lt; nobs</p>
<p>Please shed a light on how to correct it.</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-452300" data-commentid="452300" data-postid="3570" data-belowelement="comment-452300" data-respondelement="respond" data-replyto="Reply to Yingfei" aria-label="Reply to Yingfei">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-452318" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-452318" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-452318" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The error suggests you may need to change the configuration of the model to suite your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-452318" data-commentid="452318" data-postid="3570" data-belowelement="comment-452318" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455812" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-455812" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/086098c2a73350ef62d97cdb640746eb.png" srcset="https://secure.gravatar.com/avatar/086098c2a73350ef62d97cdb640746eb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">NikosLamp</span>
	                <span class="date">November 22, 2018 at 9:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-455812" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>In the section “Quick Check for Autocorrelation”, you shifted the data by one position back and you named the columns ‘t-1’ and ‘t+1’. In the article ‘https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/’ in the section ‘Pandas shift() Function’ you have the code line: ‘df[‘t-1’] = df[‘t’].shift(1)’  that is shifted by one means 1 time difference(t-1, t). Can you explain which one is correct? What  point have I missed?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-455812" data-commentid="455812" data-postid="3570" data-belowelement="comment-455812" data-respondelement="respond" data-replyto="Reply to NikosLamp" aria-label="Reply to NikosLamp">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455826" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-455826" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2018 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-455826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Really it should be ‘t’ and ‘t-1.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-455826" data-commentid="455826" data-postid="3570" data-belowelement="comment-455826" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458405" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-458405" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/e33f6ecd7beea8294d60885449db31d7.png" srcset="https://secure.gravatar.com/avatar/e33f6ecd7beea8294d60885449db31d7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yannick</span>
	                <span class="date">December 13, 2018 at 9:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-458405" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Brownlee,</p>
<p>I have used your tutorial to make some predictions on a dataset which records every minute the number of used parking spaces for 2017. For the Persistence model I get a test MSE score of 12.7 and for the Autoregression model a test MSE score of 74. Could you tell me if it is good or bad? In the meantime, could you give me more details on how the MSE results work on your code does it run on the entire dataset?</p>
<p>Regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-458405" data-commentid="458405" data-postid="3570" data-belowelement="comment-458405" data-respondelement="respond" data-replyto="Reply to Yannick" aria-label="Reply to Yannick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458445" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-458445" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 14, 2018 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-458445" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good or bad is only knowable in comparison to the persistence model.</p>
<p>You can answer this question yourself.</p>
<p>74 &gt; 12 == bad.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-458445" data-commentid="458445" data-postid="3570" data-belowelement="comment-458445" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459310" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-459310" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c7f502beee8201f264e17bb8bf7f01bd.png" srcset="https://secure.gravatar.com/avatar/c7f502beee8201f264e17bb8bf7f01bd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Awibawa</span>
	                <span class="date">December 20, 2018 at 1:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459310" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Brownlee,<br>
Is there any references and example code of NARX (Non-Linear AutoRegressive with eXogenous inputs) ? I apologize if this is out of topic probably you have experience about this</p>
<p>regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459310" data-commentid="459310" data-postid="3570" data-belowelement="comment-459310" data-respondelement="respond" data-replyto="Reply to Awibawa" aria-label="Reply to Awibawa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459324" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-459324" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2018 at 2:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459324" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459324" data-commentid="459324" data-postid="3570" data-belowelement="comment-459324" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459759" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-459759" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c7a0f1b5244053e52dc9481c149d8bf7.png" srcset="https://secure.gravatar.com/avatar/c7a0f1b5244053e52dc9481c149d8bf7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Markus</span>
	                <span class="date">December 23, 2018 at 10:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When we say that a given model makes use of lag value of 3, which one of the followings is the given model equation:</p>
<p>X(t) = b0 + b1*X(t-1) + b2*X(t-2)+ b3*X(t-3)<br>
X(t) = b0 + b3*X(t-3)</p>
<p>I assume it’s the first one, but I’m not sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459759" data-commentid="459759" data-postid="3570" data-belowelement="comment-459759" data-respondelement="respond" data-replyto="Reply to Markus" aria-label="Reply to Markus">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459801" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-459801" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 24, 2018 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459801" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It will be a linear function of three prior time steps to the step being predictions.</p>
<p>The specifics of the linear function will vary across algorithms.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-459801" data-commentid="459801" data-postid="3570" data-belowelement="comment-459801" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-470392" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-470392" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/af2a0e4f9262af053bb2b6c13eb0940f.png" srcset="https://secure.gravatar.com/avatar/af2a0e4f9262af053bb2b6c13eb0940f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Victor</span>
	                <span class="date">February 25, 2019 at 1:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470392" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>How can I change the order for the AR model using this code.</p>
<p>E.g. AR(1), AR(2) etc?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470392" data-commentid="470392" data-postid="3570" data-belowelement="comment-470392" data-respondelement="respond" data-replyto="Reply to Victor" aria-label="Reply to Victor">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470446" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-470446" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 25, 2019 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Create the AR model and provide an integer for the order.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470446" data-commentid="470446" data-postid="3570" data-belowelement="comment-470446" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470464" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-470464" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/af2a0e4f9262af053bb2b6c13eb0940f.png" srcset="https://secure.gravatar.com/avatar/af2a0e4f9262af053bb2b6c13eb0940f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Victor</span>
	                <span class="date">February 25, 2019 at 9:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470464" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t really understand what you mean?</p>
<p>I’d just like to know how to do it based on the example you gave. Wouldn’t it just be a single line where I add the extra parameter as ‘order number’?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470464" data-commentid="470464" data-postid="3570" data-belowelement="comment-470464" data-respondelement="respond" data-replyto="Reply to Victor" aria-label="Reply to Victor">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470496" class="comment even depth-4 parent">

	      	<div id="li-comment-470496" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/af2a0e4f9262af053bb2b6c13eb0940f.png" srcset="https://secure.gravatar.com/avatar/af2a0e4f9262af053bb2b6c13eb0940f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Victor</span>
	                <span class="date">February 25, 2019 at 1:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470496" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>model = AR(train, order = 1)</p>
<p>would it be like that, based on the code above</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470496" data-commentid="470496" data-postid="3570" data-belowelement="comment-470496" data-respondelement="respond" data-replyto="Reply to Victor" aria-label="Reply to Victor">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470512" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-470512" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 25, 2019 at 2:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470512" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, use maxlag on the fit() function or use an ARIMA without d or q elements.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-470506" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-470506" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 25, 2019 at 2:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470506" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see, yes, you set the “maxlag” argument on the call to fit(). More here:<br>
<a href="http://www.statsmodels.org/devel/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit" rel="nofollow ugc">http://www.statsmodels.org/devel/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit</a></p>
<p>Alternately, you can use an ARIMA and set the order as (n, 0, 0).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-470506" data-commentid="470506" data-postid="3570" data-belowelement="comment-470506" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472659" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-472659" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4a6676041b7fde6d7e30054b64b24c58.png" srcset="https://secure.gravatar.com/avatar/4a6676041b7fde6d7e30054b64b24c58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">WiseNetAI</span>
	                <span class="date">March 6, 2019 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-472659" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you please explain why it’s not “cheating”, so to speak, to append the observation at a time step to the history list. Isn’t this equivalent to feeding the model part of the data it is trying to predict? Is this possible in real life situations where we may not know the actual value of the thing we are trying to predict? I am referring to line 26 in the code which generates the “Predictions From Rolling AR Model.” I will appreciate it you could enlighten me about this please. Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-472659" data-commentid="472659" data-postid="3570" data-belowelement="comment-472659" data-respondelement="respond" data-replyto="Reply to WiseNetAI" aria-label="Reply to WiseNetAI">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472710" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-472710" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2019 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-472710" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No.</p>
<p>It is called walk-forward validation and under this model we are assuming that the true observation becomes available after the prediction was made, and in turn can be used by the model.</p>
<p>If this assumption does not hold for your data, you can design a walk forward validation strategy that captures the assumptions for your specific forecast problem.</p>
<p>More on walk forward validation here:<br>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-472710" data-commentid="472710" data-postid="3570" data-belowelement="comment-472710" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472991" class="comment odd alt depth-3">

	      	<div id="li-comment-472991" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4a6676041b7fde6d7e30054b64b24c58.png" srcset="https://secure.gravatar.com/avatar/4a6676041b7fde6d7e30054b64b24c58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">WiseNetAI</span>
	                <span class="date">March 7, 2019 at 11:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-472991" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you. That helped resolve my uncertainty.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-472991" data-commentid="472991" data-postid="3570" data-belowelement="comment-472991" data-respondelement="respond" data-replyto="Reply to WiseNetAI" aria-label="Reply to WiseNetAI">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474561" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-474561" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/609d2701337af32f2588692c68e88562.png" srcset="https://secure.gravatar.com/avatar/609d2701337af32f2588692c68e88562?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nihar Dharia</span>
	                <span class="date">March 16, 2019 at 1:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474561" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>model.predict(start , end) always gives me the same value and I end up getting a straight line prediction. So I used the history method shown above and kept adding yhat to test for the number of out of sample predictions I wanted (code below). Is it correct?</p>
<p>for t in range(len(test)+number_of_values_to_predict):<br>
		length = len(history)<br>
		lag = [history[i] for i in range(length-window,length)]<br>
		yhat = coef[0]<br>
		for d in range(window):<br>
			yhat += coef[d+1] * lag[window-d-1]<br>
		obs = test[t]<br>
		predictions.append(yhat)<br>
		history.append(obs)<br>
		test = np.append(test,yhat)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474561" data-commentid="474561" data-postid="3570" data-belowelement="comment-474561" data-respondelement="respond" data-replyto="Reply to Nihar Dharia" aria-label="Reply to Nihar Dharia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474619" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-474619" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2019 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474619" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not really sure what you’re trying to achieve?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474619" data-commentid="474619" data-postid="3570" data-belowelement="comment-474619" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474642" class="comment even depth-3 parent">

	      	<div id="li-comment-474642" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/609d2701337af32f2588692c68e88562.png" srcset="https://secure.gravatar.com/avatar/609d2701337af32f2588692c68e88562?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nihar Dharia</span>
	                <span class="date">March 16, 2019 at 11:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am trying to achieve out of sample forecasting like forecasting the value for the next 7 days. Using predict() gives me the same predicted value and gives me a straight line prediction. Hence I tried to use the code above. Do you think it is correct to do that?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474642" data-commentid="474642" data-postid="3570" data-belowelement="comment-474642" data-respondelement="respond" data-replyto="Reply to Nihar Dharia" aria-label="Reply to Nihar Dharia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474745" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-474745" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2019 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474745" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try a different model or use different data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-474745" data-commentid="474745" data-postid="3570" data-belowelement="comment-474745" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-478464" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-478464" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a88830747dfd818d01074956daa7a59d.png" srcset="https://secure.gravatar.com/avatar/a88830747dfd818d01074956daa7a59d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maysaa</span>
	                <span class="date">April 4, 2019 at 6:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-478464" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br>
You are only providing an autoregression model in a case that you only have one label or one input which is previous records of the same output.  What if for example we are concerned about the prediction of energy consumption of a house and we have different input labels like inddor temp, outdoor temp and taking into considertion the home architecture and previous records.<br>
How can we develop such a model?<br>
do you have an example for that?<br>
Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-478464" data-commentid="478464" data-postid="3570" data-belowelement="comment-478464" data-respondelement="respond" data-replyto="Reply to Maysaa" aria-label="Reply to Maysaa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-478550" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-478550" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 5, 2019 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-478550" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, I refer to this as a multivariate time series problem, and you can find examples here:<br>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-478550" data-commentid="478550" data-postid="3570" data-belowelement="comment-478550" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-480851" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-480851" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9623b177d66e4602e2c9d1cf4e9da52f.png" srcset="https://secure.gravatar.com/avatar/9623b177d66e4602e2c9d1cf4e9da52f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Haiyang Duan</span>
	                <span class="date">April 17, 2019 at 10:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-480851" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, I’m following your tutorial using my own dataset. But I have some questions about the results. (1)what does the Lag , that is the value of model_fit.k_ar, mean for your dataset?(2)what is the meaning of the period of Figure “Pandas Autocorrelation Plot” ? Could you take a moment to tell me something about them? Thank you very much.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-480851" data-commentid="480851" data-postid="3570" data-belowelement="comment-480851" data-respondelement="respond" data-replyto="Reply to Haiyang Duan" aria-label="Reply to Haiyang Duan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-480882" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-480882" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2019 at 2:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-480882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Lag is a prior observation, perhaps this will help:<br>
<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow ugc">https://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>
<p>More about autocorrelation here:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow ugc">https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-480882" data-commentid="480882" data-postid="3570" data-belowelement="comment-480882" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481441" class="comment even depth-3 parent">

	      	<div id="li-comment-481441" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9623b177d66e4602e2c9d1cf4e9da52f.png" srcset="https://secure.gravatar.com/avatar/9623b177d66e4602e2c9d1cf4e9da52f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Haiyang Duan</span>
	                <span class="date">April 20, 2019 at 11:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481441" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you please explain the relation between the Lag(model_fit.k_ar) and the period of dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481441" data-commentid="481441" data-postid="3570" data-belowelement="comment-481441" data-respondelement="respond" data-replyto="Reply to Haiyang Duan" aria-label="Reply to Haiyang Duan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481560" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-481560" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 21, 2019 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481560" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How so?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481560" data-commentid="481560" data-postid="3570" data-belowelement="comment-481560" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481443" class="comment even depth-3 parent">

	      	<div id="li-comment-481443" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9623b177d66e4602e2c9d1cf4e9da52f.png" srcset="https://secure.gravatar.com/avatar/9623b177d66e4602e2c9d1cf4e9da52f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Haiyang Duan</span>
	                <span class="date">April 20, 2019 at 12:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481443" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>or how can I get the period of the time series dataset except Fast Fourier Transform?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481443" data-commentid="481443" data-postid="3570" data-belowelement="comment-481443" data-respondelement="respond" data-replyto="Reply to Haiyang Duan" aria-label="Reply to Haiyang Duan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481561" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-481561" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 21, 2019 at 8:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481561" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see, you could review a plot of the series.</p>
<p>You could use domain knowledge.</p>
<p>You could use a grid search on a simple polynomial function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-481561" data-commentid="481561" data-postid="3570" data-belowelement="comment-481561" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482385" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-482385" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9ea832a1fb121c949eda00f4adcc189b.png" srcset="https://secure.gravatar.com/avatar/9ea832a1fb121c949eda00f4adcc189b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dav</span>
	                <span class="date">April 24, 2019 at 8:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-482385" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi </p>
<p>Thanks for this useful article. Where can I get the data file “daily-minimum-temperatures.csv”? I can’t reach the target site when I click on “Learn more about the dataset here”. </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-482385" data-commentid="482385" data-postid="3570" data-belowelement="comment-482385" data-respondelement="respond" data-replyto="Reply to Dav" aria-label="Reply to Dav">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482463" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-482463" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 25, 2019 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-482463" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can download it directly from here:<br>
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/daily-min-temperatures.csv" rel="nofollow ugc">https://raw.githubusercontent.com/jbrownlee/Datasets/master/daily-min-temperatures.csv</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-482463" data-commentid="482463" data-postid="3570" data-belowelement="comment-482463" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483484" class="comment even depth-3">

	      	<div id="li-comment-483484" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9ea832a1fb121c949eda00f4adcc189b.png" srcset="https://secure.gravatar.com/avatar/9ea832a1fb121c949eda00f4adcc189b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dav</span>
	                <span class="date">May 1, 2019 at 3:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-483484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>got it, thanks for your hlep</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-483484" data-commentid="483484" data-postid="3570" data-belowelement="comment-483484" data-respondelement="respond" data-replyto="Reply to Dav" aria-label="Reply to Dav">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-487998" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-487998" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/5ae44352defc990d717970f078b836ff.png" srcset="https://secure.gravatar.com/avatar/5ae44352defc990d717970f078b836ff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thibault de Wit</span>
	                <span class="date">June 6, 2019 at 5:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-487998" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Quick question here. Why do we start the train dataset at 1 and not 0? </p>
<p>In your code we have: train, test = X[1:len(X)-7], X[len(X)-7:]<br>
But having this instead:  train, test = X[:len(X)-7], X[len(X)-7:] would allow the model to train on 1 more value (starting at index 0 instead of starting at index 1).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-487998" data-commentid="487998" data-postid="3570" data-belowelement="comment-487998" data-respondelement="respond" data-replyto="Reply to Thibault de Wit" aria-label="Reply to Thibault de Wit">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488035" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-488035" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 6, 2019 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-488035" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks. Not sure what I was thinking there…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-488035" data-commentid="488035" data-postid="3570" data-belowelement="comment-488035" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-491239" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-491239" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/996584fad86a4496c5e530674b46c15f.png" srcset="https://secure.gravatar.com/avatar/996584fad86a4496c5e530674b46c15f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Martin Muñoz Mandujano</span>
	                <span class="date">July 2, 2019 at 12:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-491239" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
what order is the AR model in the code?<br>
Or in what way is the order defined?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-491239" data-commentid="491239" data-postid="3570" data-belowelement="comment-491239" data-respondelement="respond" data-replyto="Reply to Martin Muñoz Mandujano" aria-label="Reply to Martin Muñoz Mandujano">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-491250" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-491250" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 2, 2019 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-491250" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Order is the number of lag observations considered by the model.</p>
<p>You can grid search different values or use an ACF/PACF plot to choose the value.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-491250" data-commentid="491250" data-postid="3570" data-belowelement="comment-491250" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494515" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-494515" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/306980400fd0c9a1c06d34a1422f23d3.png" srcset="https://secure.gravatar.com/avatar/306980400fd0c9a1c06d34a1422f23d3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ank</span>
	                <span class="date">July 28, 2019 at 7:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494515" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I am new to python, is it the update issue of pandas?</p>
<p>I cannot run the code for “Quick Check for Autocorrelation :” </p>
<p>unless adding the below 2 line of code</p>
<p>Data[‘Date’] = pd.to_datetime(Data[‘Date’])<br>
series=pd.Series(Data[‘Temp’])</p>
<p>lag_plot(series)<br>
pyplot.show()</p>
<p>thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494515" data-commentid="494515" data-postid="3570" data-belowelement="comment-494515" data-respondelement="respond" data-replyto="Reply to Ank" aria-label="Reply to Ank">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494570" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494570" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2019 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494570" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, what problem were you having exactly?</p>
<p>I have some suggestions here that might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494570" data-commentid="494570" data-postid="3570" data-belowelement="comment-494570" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494592" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494592" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/03f0c6fcdf665c9bf6c8e5179399de69.png" srcset="https://secure.gravatar.com/avatar/03f0c6fcdf665c9bf6c8e5179399de69?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.kaggle.com/lbarbosa" rel="external nofollow ugc" class="url">Leo Barbosa</a></span>
	                <span class="date">July 29, 2019 at 10:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494592" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for the tutorial, very helpful.  I have a question though</p>
<p>How is your last example (rolling forecast) different to what statsmodels.tsa.ar_model.AR.predict() would do when dynamic=False?<br>
The way I understand it, it would do what you did in your last example, but you are getting different results, so not sure what I am missing. </p>
<p>From statsmodels website:<br>
“The dynamic keyword affects in-sample prediction. If dynamic is False, then the in-sample lagged values are used for prediction. If dynamic is True, then in-sample forecasts are used in place of lagged dependent variables. The first forecasted value is start.”</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494592" data-commentid="494592" data-postid="3570" data-belowelement="comment-494592" data-respondelement="respond" data-replyto="Reply to Leo Barbosa" aria-label="Reply to Leo Barbosa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494612" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494612" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2019 at 2:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>I believe dynamic only effects “in sample” data, e.g. data within the scope of the training data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-494612" data-commentid="494612" data-postid="3570" data-belowelement="comment-494612" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500637" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-500637" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/e121bf1aa318f10e624391438cb6273f.png" srcset="https://secure.gravatar.com/avatar/e121bf1aa318f10e624391438cb6273f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manpreet Singh</span>
	                <span class="date">September 9, 2019 at 8:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500637" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for the tutorial, very helpful. I have a question though</p>
<p>You wrote that “the statsmodels library provides an autoregression model that automatically selects an appropriate lag value using statistical tests and trains a linear regression model.”</p>
<p>Is it using any model selection criteria like AIC, BIC to select the appropriate lag value or is it approximating all the models and picking the one with the least MSE?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500637" data-commentid="500637" data-postid="3570" data-belowelement="comment-500637" data-respondelement="respond" data-replyto="Reply to Manpreet Singh" aria-label="Reply to Manpreet Singh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500640" class="comment even depth-2 parent">

	      	<div id="li-comment-500640" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/e121bf1aa318f10e624391438cb6273f.png" srcset="https://secure.gravatar.com/avatar/e121bf1aa318f10e624391438cb6273f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manpreet Singh</span>
	                <span class="date">September 9, 2019 at 9:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500640" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>fit([maxlag, method, ic, trend, …])</p>
<p>Could you please explain what all inputs we’re giving in this in your example. What is the maxlag, method and ic when we do model.fit( )?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500640" data-commentid="500640" data-postid="3570" data-belowelement="comment-500640" data-respondelement="respond" data-replyto="Reply to Manpreet Singh" aria-label="Reply to Manpreet Singh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500670" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-500670" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2019 at 1:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500670" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>maxlag is the maximum input lag to consider when fitting the model.</p>
<p>The other parameters are described here:<br>
<a href="http://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit" rel="nofollow ugc">http://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500670" data-commentid="500670" data-postid="3570" data-belowelement="comment-500670" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500669" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-500669" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2019 at 1:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m glad it helped.</p>
<p>Good question, you can see more about how it works here:<br>
<a href="http://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit" rel="nofollow ugc">http://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500669" data-commentid="500669" data-postid="3570" data-belowelement="comment-500669" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500918" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-500918" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/8bdae9ad9f344efe41a77aeb15727f03.png" srcset="https://secure.gravatar.com/avatar/8bdae9ad9f344efe41a77aeb15727f03?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">George</span>
	                <span class="date">September 11, 2019 at 4:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500918" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br>
Do you know what the methods are for validating AR model?<br>
Specific tests that could be done to show the model developed in valid</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500918" data-commentid="500918" data-postid="3570" data-belowelement="comment-500918" data-respondelement="respond" data-replyto="Reply to George" aria-label="Reply to George">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500937" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-500937" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 11, 2019 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500937" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, walk-forward validation:<br>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow ugc">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-500937" data-commentid="500937" data-postid="3570" data-belowelement="comment-500937" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-502790" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-502790" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a5f5c21383035f9eafba4e49b2db4b88.png" srcset="https://secure.gravatar.com/avatar/a5f5c21383035f9eafba4e49b2db4b88?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Leo</span>
	                <span class="date">September 24, 2019 at 2:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-502790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for the tutorial, very helpful. I have a question that your ACF lag is big in this case and so as I. How can we decide to choose the ARIMA parameters if the lag of ACF or PACF is very big ? In my case , my ACF decay towards to zero at lag 1000, and PACF at lag 30.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-502790" data-commentid="502790" data-postid="3570" data-belowelement="comment-502790" data-respondelement="respond" data-replyto="Reply to Leo" aria-label="Reply to Leo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-502868" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-502868" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2019 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-502868" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, I give some general advice for choosing ARIMA parameters from ACF/PACF plots here:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow ugc">https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-502868" data-commentid="502868" data-postid="3570" data-belowelement="comment-502868" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505837" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-505837" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/96752e43ff47cddcd8857d3f4f7f24b8.png" srcset="https://secure.gravatar.com/avatar/96752e43ff47cddcd8857d3f4f7f24b8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Laguna</span>
	                <span class="date">October 16, 2019 at 4:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-505837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the article.<br>
Isn’t partial autocorrelation (PACF) plot supposed to be used to determine the statistically significant lag cofficients for an AR model. Isn’t ACF used for the Moving average part, not the AR part of an ARMA model? I was confused by the choice of using the ACF plot for the AR part of the model</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-505837" data-commentid="505837" data-postid="3570" data-belowelement="comment-505837" data-respondelement="respond" data-replyto="Reply to Laguna" aria-label="Reply to Laguna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505869" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-505869" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 16, 2019 at 8:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-505869" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this tutorial:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow ugc">https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-505869" data-commentid="505869" data-postid="3570" data-belowelement="comment-505869" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-521146" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-521146" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/095e3b8927b3a6855f2ebe3c5c716a84.png" srcset="https://secure.gravatar.com/avatar/095e3b8927b3a6855f2ebe3c5c716a84?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">karan</span>
	                <span class="date">February 10, 2020 at 6:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-521146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Very nice and clear explanation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-521146" data-commentid="521146" data-postid="3570" data-belowelement="comment-521146" data-respondelement="respond" data-replyto="Reply to karan" aria-label="Reply to karan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-521201" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-521201" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 11, 2020 at 5:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-521201" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-521201" data-commentid="521201" data-postid="3570" data-belowelement="comment-521201" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-524045" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-524045" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4f2b2c2a249ca1e029bdf569ca1e84ef.png" srcset="https://secure.gravatar.com/avatar/4f2b2c2a249ca1e029bdf569ca1e84ef?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Evan Berry</span>
	                <span class="date">March 2, 2020 at 8:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-524045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I was wondering if this technique of lag variables could be used for other features. So it seems like above you are predicting weather so you are using lag variables of weather data. What if we wanted to use lag variables of another variable such as total sunlight per day. Even though this is a different variable can you use the say technique in terms of lagging data to predict weather?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-524045" data-commentid="524045" data-postid="3570" data-belowelement="comment-524045" data-respondelement="respond" data-replyto="Reply to Evan Berry" aria-label="Reply to Evan Berry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-524050" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-524050" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 2, 2020 at 10:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-524050" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it can be useful for any time series data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-524050" data-commentid="524050" data-postid="3570" data-belowelement="comment-524050" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-527192" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-527192" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/d1c3ecced5a30ad38d733754972c1467.png" srcset="https://secure.gravatar.com/avatar/d1c3ecced5a30ad38d733754972c1467?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">March 28, 2020 at 1:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527192" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>I am trying to do a dynamic forecast using OLS.  The model has an AR(1) variable and n exdog variables.  </p>
<p>I use a for loop to run the regression many times for different combinations of the exdog variables and store the results.  I split into test/train sets and run a prediction on the test set and store the MAE and RMSE.  </p>
<p>The problem I have is the out of sample test is using the actual lagged AR(1) variable rather than dynamically generating it.  I want to use the realized values of the exdog variables but the dynamically estimated AR(1) variable.  </p>
<p>Do you have any thoughts on the best way of doing this please?  I have looked at SARIMAX as an alternative but wanted to use OLS ideally.</p>
<p>Also which of your books would you recommend for statsmodels/OLS/time series forecasting?</p>
<p>Do you also have anything on monte carlo in python?</p>
<p>Cheers</p>
<p>Mark</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527192" data-commentid="527192" data-postid="3570" data-belowelement="comment-527192" data-respondelement="respond" data-replyto="Reply to Mark" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527252" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-527252" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 28, 2020 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527252" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow the specific problem you’re having sorry. “generated” do you mean predicted as in a recursive model?</p>
<p>I cover the basics of time series forecasting with ARIMA in this book (no exog or sarima though):<br>
<a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" rel="nofollow ugc">https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/</a></p>
<p>Not much on MC in python:<br>
<a href="https://machinelearningmastery.com/monte-carlo-sampling-for-probability/" rel="nofollow ugc">https://machinelearningmastery.com/monte-carlo-sampling-for-probability/</a></p>
<p>And:<br>
<a href="https://machinelearningmastery.com/markov-chain-monte-carlo-for-probability/" rel="nofollow ugc">https://machinelearningmastery.com/markov-chain-monte-carlo-for-probability/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527252" data-commentid="527252" data-postid="3570" data-belowelement="comment-527252" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527270" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-527270" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/d1c3ecced5a30ad38d733754972c1467.png" srcset="https://secure.gravatar.com/avatar/d1c3ecced5a30ad38d733754972c1467?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mark</span>
	                <span class="date">March 28, 2020 at 9:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks of the links Jason.</p>
<p>I mean the standard way OLS works with statsmodels.predict() is to do a fixed forecast using the actual lagged dependent variables in the test data if there is a AR term in the equation.  For a true out of sample forecast, for a given assumed exog data set or scenario, I want the forecast to be dynamic with regard to the AR term in the equation.  Otherwise it looks better at out of sample forecasting than it really is.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527270" data-commentid="527270" data-postid="3570" data-belowelement="comment-527270" data-respondelement="respond" data-replyto="Reply to Mark" aria-label="Reply to Mark">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527374" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-527374" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2020 at 5:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527374" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow, sorry. Perhaps you can rephrase your question/issue?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527374" data-commentid="527374" data-postid="3570" data-belowelement="comment-527374" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-527892" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-527892" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c5c3e512f5dded3549eb7ae8ac5bbc92.png" srcset="https://secure.gravatar.com/avatar/c5c3e512f5dded3549eb7ae8ac5bbc92?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vasiliki Voukelatou</span>
	                <span class="date">April 1, 2020 at 12:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mark amazing tutorial many thanks, </p>
<p>When using plot_acf(series, lags=30), I don’t see why the autocorrelation plot appears 2 times.<br>
Is there a bug?</p>
<p>Thank you in advance for your reply.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527892" data-commentid="527892" data-postid="3570" data-belowelement="comment-527892" data-respondelement="respond" data-replyto="Reply to Vasiliki Voukelatou" aria-label="Reply to Vasiliki Voukelatou">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527932" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-527932" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 1, 2020 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527932" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Mark?</p>
<p>Sorry to hear that you’re having trouble, perhaps this will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-527932" data-commentid="527932" data-postid="3570" data-belowelement="comment-527932" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-528011" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-528011" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c5c3e512f5dded3549eb7ae8ac5bbc92.png" srcset="https://secure.gravatar.com/avatar/c5c3e512f5dded3549eb7ae8ac5bbc92?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vasiliki Voukelatou</span>
	                <span class="date">April 1, 2020 at 9:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-528011" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason :), who said Mark :P,</p>
<p>Thanks a lot, solved 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-528011" data-commentid="528011" data-postid="3570" data-belowelement="comment-528011" data-respondelement="respond" data-replyto="Reply to Vasiliki Voukelatou" aria-label="Reply to Vasiliki Voukelatou">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-528062" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-528062" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 2, 2020 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-528062" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You did in your comment:</p>
<p>“Hi Mark amazing tutorial many thanks,”</p>
<p>Happy to hear you solved your problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-528062" data-commentid="528062" data-postid="3570" data-belowelement="comment-528062" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530180" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-530180" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/39396e38f0ae99234fc3f8e6a15e649c.png" srcset="https://secure.gravatar.com/avatar/39396e38f0ae99234fc3f8e6a15e649c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arabzai</span>
	                <span class="date">April 17, 2020 at 7:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530180" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
Can we fit Support vector regression instead of linear regression ?<br>
If possible , then what is the procedure and how we can get the residuals from SVR-AR(1) model ?<br>
Looking forward to hearing from you soon.<br>
Best,<br>
Arabzai</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530180" data-commentid="530180" data-postid="3570" data-belowelement="comment-530180" data-respondelement="respond" data-replyto="Reply to Arabzai" aria-label="Reply to Arabzai">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530265" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-530265" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 18, 2020 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530265" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, use this to prepare your data:<br>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow ugc">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530265" data-commentid="530265" data-postid="3570" data-belowelement="comment-530265" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530420" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-530420" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/04842e726bc8602337ed4b4fc6b7af30.png" srcset="https://secure.gravatar.com/avatar/04842e726bc8602337ed4b4fc6b7af30?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Olly Price</span>
	                <span class="date">April 19, 2020 at 7:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, do you know what statistical method statsmodels.tsa.ar_model.AR( ) uses under the hood to determine the optimal order for the AR? (Can’t seem to find anything on the documentation.)</p>
<p>If not, are there any models you recommend me reading up on? I appreciate that you can observe an ACF and qualitatively decide a rough number.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530420" data-commentid="530420" data-postid="3570" data-belowelement="comment-530420" data-respondelement="respond" data-replyto="Reply to Olly Price" aria-label="Reply to Olly Price">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530423" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-530423" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 19, 2020 at 8:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The AR model does not optimize the order, you must specify the order when calling the fit() function.</p>
<p>You can use a grid search to tune the model on your data, here is an example:<br>
<a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" rel="nofollow ugc">https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530423" data-commentid="530423" data-postid="3570" data-belowelement="comment-530423" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530429" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-530429" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/04842e726bc8602337ed4b4fc6b7af30.png" srcset="https://secure.gravatar.com/avatar/04842e726bc8602337ed4b4fc6b7af30?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Olly Price</span>
	                <span class="date">April 19, 2020 at 8:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530429" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If the AR model doesn’t optimise the order, then where does model.fit.k_ar come from?</p>
<p>In the tutorial:</p>
<p>model = AR(train)<br>
model_fit = model.fit( )<br>
print(“Lag: %s” % model_fit.k_ar)<br>
&gt;&gt;&gt; Lag: 29</p>
<p>Where does the lag of 29 come from?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530429" data-commentid="530429" data-postid="3570" data-belowelement="comment-530429" data-respondelement="respond" data-replyto="Reply to Olly Price" aria-label="Reply to Olly Price">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530432" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-530432" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 19, 2020 at 9:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>looks like it tests different lag values using a configured criterion, learn more here:<br>
<a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit" rel="nofollow ugc">https://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AR.fit.html#statsmodels.tsa.ar_model.AR.fit</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-530432" data-commentid="530432" data-postid="3570" data-belowelement="comment-530432" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-535006" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-535006" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/7a283f146e8ca19c0813f2df7a1d5cab.png" srcset="https://secure.gravatar.com/avatar/7a283f146e8ca19c0813f2df7a1d5cab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Robert Gadzai</span>
	                <span class="date">May 17, 2020 at 2:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-535006" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much Jason, you saved my day</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-535006" data-commentid="535006" data-postid="3570" data-belowelement="comment-535006" data-respondelement="respond" data-replyto="Reply to Robert Gadzai" aria-label="Reply to Robert Gadzai">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535046" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-535046" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 17, 2020 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-535046" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-535046" data-commentid="535046" data-postid="3570" data-belowelement="comment-535046" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-538534" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-538534" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0803c3cd8556202492e3caa1d7d400a.png" srcset="https://secure.gravatar.com/avatar/a0803c3cd8556202492e3caa1d7d400a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lucas</span>
	                <span class="date">June 7, 2020 at 7:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-538534" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, </p>
<p>I am trying to follow the precedure, but I am having problems with statsmodels. All my dependencies are upto date, but I cannot import statsmodels, raising the error:<br>
ImportError: cannot import name ‘assert_equal’ from ‘statsmodels.compat.pandas’</p>
<p>Do you know what am I supposed to do?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-538534" data-commentid="538534" data-postid="3570" data-belowelement="comment-538534" data-respondelement="respond" data-replyto="Reply to Lucas" aria-label="Reply to Lucas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-538591" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-538591" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 8, 2020 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-538591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps confirm that pandas and statsmodels are up to date again?</p>
<p>My versions are:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-61775fc358c72498653640" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">pandas: 1.0.3
statsmodels: 0.11.1</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-61775fc358c72498653640-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-61775fc358c72498653640-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-61775fc358c72498653640-1"><span class="crayon-v">pandas</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.0.3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-61775fc358c72498653640-2"><span class="crayon-v">statsmodels</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.11.1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-538591" data-commentid="538591" data-postid="3570" data-belowelement="comment-538591" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-541107" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-541107" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/e2dd0c7c316c4a4e6a10ee7afd02b360.png" srcset="https://secure.gravatar.com/avatar/e2dd0c7c316c4a4e6a10ee7afd02b360?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ashwin</span>
	                <span class="date">June 25, 2020 at 11:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541107" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I wanted to ask is AR(lags=10) model is equal to an ARMA(10,0)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541107" data-commentid="541107" data-postid="3570" data-belowelement="comment-541107" data-respondelement="respond" data-replyto="Reply to Ashwin" aria-label="Reply to Ashwin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-541165" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-541165" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 26, 2020 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541165" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I would expect so.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541165" data-commentid="541165" data-postid="3570" data-belowelement="comment-541165" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-541942" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-541942" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9a44e8f53e7df3d541df37a2b204698c.png" srcset="https://secure.gravatar.com/avatar/9a44e8f53e7df3d541df37a2b204698c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Emy</span>
	                <span class="date">June 30, 2020 at 12:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541942" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi how can i know numbre off the correct lag?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541942" data-commentid="541942" data-postid="3570" data-belowelement="comment-541942" data-respondelement="respond" data-replyto="Reply to Emy" aria-label="Reply to Emy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-541995" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-541995" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 30, 2020 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541995" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you’re unsure test a suite of values and use a number of lag obs that results in a model with the best performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-541995" data-commentid="541995" data-postid="3570" data-belowelement="comment-541995" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-557042" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-557042" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/504bdb53875062fb8e8cf48b2b4e3b7b.png" srcset="https://secure.gravatar.com/avatar/504bdb53875062fb8e8cf48b2b4e3b7b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Cyril</span>
	                <span class="date">September 2, 2020 at 3:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-557042" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Would you recommend using “statsmodels.tsa.ar_model.ar_select_order” to select best lag periods as “statsmodels.tsa.ar_model.AR” is now depreciated?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-557042" data-commentid="557042" data-postid="3570" data-belowelement="comment-557042" data-respondelement="respond" data-replyto="Reply to Cyril" aria-label="Reply to Cyril">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-557181" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-557181" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 2, 2020 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-557181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not familiar with statsmodels.tsa.ar_model.ar_select_order</p>
<p>AutoReg is an appropriate replacement:<br>
<a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AutoReg.html" rel="nofollow ugc">https://www.statsmodels.org/stable/generated/statsmodels.tsa.ar_model.AutoReg.html</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-557181" data-commentid="557181" data-postid="3570" data-belowelement="comment-557181" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-542810" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-542810" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/9c64c9b41eb06d4315b5f8f0c5da8522.png" srcset="https://secure.gravatar.com/avatar/9c64c9b41eb06d4315b5f8f0c5da8522?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">krishnadas</span>
	                <span class="date">July 5, 2020 at 3:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-542810" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice example. This one helped me to start my VAR model project. Here, I’m using multivariate time series and statsmodel’s VAR model. As you mentioned the API won’t update the coefficients for new observations. Since it’s a multivariate time series, what can I do get the prediction for a long time (say 6 months)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-542810" data-commentid="542810" data-postid="3570" data-belowelement="comment-542810" data-respondelement="respond" data-replyto="Reply to krishnadas" aria-label="Reply to krishnadas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-542844" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-542844" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 5, 2020 at 7:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-542844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe you can call forecast() and predict as long as you like.</p>
<p>Then re-fit the model as you get new data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-542844" data-commentid="542844" data-postid="3570" data-belowelement="comment-542844" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-546199" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-546199" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/c5842bc37ab1c711ec18ef7eda44762c.png" srcset="https://secure.gravatar.com/avatar/c5842bc37ab1c711ec18ef7eda44762c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://na/" rel="external nofollow ugc" class="url">Dilip Thosar</a></span>
	                <span class="date">July 27, 2020 at 10:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-546199" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In most practical cases, we have some “regressable” variables in addition to the time series.<br>
Variables that are not uniformly periodic (seasonal) and generally in our control. eg. In a retail store sales forecasting application, “gift promotion scheme on (Y/N)” or “scheme discount percentage offered (% or $)” may be significantly affecting the output variable, sales. Just running a timeseries model will ignore the effects of the schemes. How are these situations to be handled?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-546199" data-commentid="546199" data-postid="3570" data-belowelement="comment-546199" data-respondelement="respond" data-replyto="Reply to Dilip Thosar" aria-label="Reply to Dilip Thosar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546232" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-546232" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 28, 2020 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-546232" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They can be included as exogenous variables to a linear model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-546232" data-commentid="546232" data-postid="3570" data-belowelement="comment-546232" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-550430" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-550430" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/3541345e0f5cf52ab1fd22a74bb0dda4.png" srcset="https://secure.gravatar.com/avatar/3541345e0f5cf52ab1fd22a74bb0dda4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sada Narayanappa</span>
	                <span class="date">August 21, 2020 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-550430" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When I run</p>
<p>from pandas import read_csv<br>
from matplotlib import pyplot<br>
from statsmodels.tsa.ar_model import AutoReg<br>
from sklearn.metrics import mean_squared_error<br>
from math import sqrt<br>
# load dataset<br>
series = read_csv(‘daily-minimum-temperatures.csv’, header=0, index_col=0, parse_dates=True, squeeze=True)<br>
# split dataset<br>
X = series.values<br>
train, test = X[1:len(X)-7], X[len(X)-7:]<br>
# train autoregression<br>
model = AutoReg(train, lags=29)</p>
<p>I get the following error</p>
<p>—————————————————————————<br>
TypeError                                 Traceback (most recent call last)<br>
 in<br>
     11 train, test = X[1:len(X)-7], X[len(X)-7:]<br>
     12 # train autoregression<br>
—&gt; 13 model = AutoReg(train, lags=29)<br>
     14 model_fit = model.fit()<br>
     15 print(‘Coefficients: %s’ % model_fit.params)</p>
<p>~/anaconda3/lib/python3.7/site-packages/statsmodels/tsa/ar_model.py in __init__(self, endog, lags, trend, seasonal, exog, hold_back, period, missing)<br>
    163                  hold_back=None, period=None, missing=’none’):<br>
    164         super(AutoReg, self).__init__(endog, exog, None, None,<br>
–&gt; 165                                       missing=missing)<br>
    166         self._trend = string_like(trend, ‘trend’,<br>
    167                                   options=(‘n’, ‘c’, ‘t’, ‘ct’))</p>
<p>~/anaconda3/lib/python3.7/site-packages/statsmodels/tsa/base/tsa_model.py in __init__(self, endog, exog, dates, freq, missing, **kwargs)<br>
     44     def __init__(self, endog, exog=None, dates=None, freq=None,<br>
     45                  missing=’none’, **kwargs):<br>
—&gt; 46         super(TimeSeriesModel, self).__init__(endog, exog, missing=missing,<br>
     47                                               **kwargs)<br>
     48 </p>
<p>TypeError: super(type, obj): obj must be an instance or subtype of type</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-550430" data-commentid="550430" data-postid="3570" data-belowelement="comment-550430" data-respondelement="respond" data-replyto="Reply to Sada Narayanappa" aria-label="Reply to Sada Narayanappa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-550432" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-550432" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2020 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-550432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that.</p>
<p>This may help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-550432" data-commentid="550432" data-postid="3570" data-belowelement="comment-550432" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-567119" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-567119" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/0bfe4d17497c71d29b1a961362c43b3b.png" srcset="https://secure.gravatar.com/avatar/0bfe4d17497c71d29b1a961362c43b3b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://medium.com/@cannydatascience" rel="external nofollow ugc" class="url">Giuseppe</a></span>
	                <span class="date">October 14, 2020 at 1:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-567119" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the article.</p>
<p>I have a question, in the istruction  AutoReg(train, lags=29) the lags parameter is equal to 29 because in the ACF graph we notice that there is a strong correlation up to 29 time?<br>
Wouldn’t it be better to consider the PACF graph?</p>
<p>Thank you for your answer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-567119" data-commentid="567119" data-postid="3570" data-belowelement="comment-567119" data-respondelement="respond" data-replyto="Reply to Giuseppe" aria-label="Reply to Giuseppe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-567164" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-567164" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2020 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-567164" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Correct.</p>
<p>See this on ACF/PACF plots:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow ugc">https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-567164" data-commentid="567164" data-postid="3570" data-belowelement="comment-567164" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-581188" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-581188" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/1e1782f11580fa78f886c28b6213f4c1.png" srcset="https://secure.gravatar.com/avatar/1e1782f11580fa78f886c28b6213f4c1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Muhammad Zubair</span>
	                <span class="date">December 6, 2020 at 3:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-581188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Nice explanation but I want to clarify that the time lags t-1 refers to one lag of time and the current time you are referring to is t+1. Then why don’t you take it as t and t+1 or t-1 and t.</p>
<p>I know this is a very basic question but Appreciate your answer on it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-581188" data-commentid="581188" data-postid="3570" data-belowelement="comment-581188" data-respondelement="respond" data-replyto="Reply to Muhammad Zubair" aria-label="Reply to Muhammad Zubair">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581228" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-581228" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 6, 2020 at 7:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-581228" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is a good idea, I should do that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-581228" data-commentid="581228" data-postid="3570" data-belowelement="comment-581228" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-601558" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-601558" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/2e31fb7eca7272d77ae6808844100d0c.png" srcset="https://secure.gravatar.com/avatar/2e31fb7eca7272d77ae6808844100d0c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Girish</span>
	                <span class="date">March 21, 2021 at 1:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-601558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for very nice article. I am trying to perform the following , could you please suggest/guide me.</p>
<p>My original data is like below</p>
<p>Month           Price<br>
2011-01-01  1405.07<br>
2011-02-01   408.58<br>
2011-03-01   277.75<br>
2011-04-01   294.81<br>
2011-05-01   511.77<br>
2011-06-01   515.90</p>
<p>I have to predict the price (by regression)  considering lag of 5, with the  rebuilt the data set as below I need to predict the value for 5th element (X) </p>
<p>Dataset = [1405,408,277,294,X]<br>
                [408,277,294,511,X]<br>
                [277,294,511,515,X]</p>
<p>How I can achieve the same?</p>
<p>Thanks in advance<br>
-Girish</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-601558" data-commentid="601558" data-postid="3570" data-belowelement="comment-601558" data-respondelement="respond" data-replyto="Reply to Girish" aria-label="Reply to Girish">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-601586" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-601586" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 21, 2021 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-601586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps get started with time series forecasting generally here:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-601586" data-commentid="601586" data-postid="3570" data-belowelement="comment-601586" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-608240" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-608240" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/870817be1c98e65d3f54e72955cad6f0.png" srcset="https://secure.gravatar.com/avatar/870817be1c98e65d3f54e72955cad6f0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adarsh Krishna S</span>
	                <span class="date">May 6, 2021 at 11:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608240" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi,</p>
<p>   I want a code for EEG signal prediction with autoregressive model , so what should be the changes in this temperature prediction .I am doing in jupyter notebook with MNE and Pandas.<br>
Please help me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608240" data-commentid="608240" data-postid="3570" data-belowelement="comment-608240" data-respondelement="respond" data-replyto="Reply to Adarsh Krishna S" aria-label="Reply to Adarsh Krishna S">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-608283" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-608283" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 7, 2021 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608283" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try developing an ARIMA or SARIMA model for your dataset and compare the results to other methods.</p>
<p>This might be a good place to start:<br>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#timeseries</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608283" data-commentid="608283" data-postid="3570" data-belowelement="comment-608283" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-608333" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-608333" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/870817be1c98e65d3f54e72955cad6f0.png" srcset="https://secure.gravatar.com/avatar/870817be1c98e65d3f54e72955cad6f0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adarsh</span>
	                <span class="date">May 7, 2021 at 3:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608333" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir it’s my project. I want code for EAR model to do my project. So I was searching for AR model related to EEG and to modify AR to EAR but I am not getting code related to EEG .can u help me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608333" data-commentid="608333" data-postid="3570" data-belowelement="comment-608333" data-respondelement="respond" data-replyto="Reply to Adarsh" aria-label="Reply to Adarsh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-608395" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-608395" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 8, 2021 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot write code for you. </p>
<p>Perhaps you can adapt an example on the blog for your specific dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608395" data-commentid="608395" data-postid="3570" data-belowelement="comment-608395" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-608634" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-608634" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/870817be1c98e65d3f54e72955cad6f0.png" srcset="https://secure.gravatar.com/avatar/870817be1c98e65d3f54e72955cad6f0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adarsh Krishna S</span>
	                <span class="date">May 10, 2021 at 4:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608634" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir,<br>
    I tried with EEG dataset with your autoregressive code and the output is fully different from expected and predicted values . Any solution?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608634" data-commentid="608634" data-postid="3570" data-belowelement="comment-608634" data-respondelement="respond" data-replyto="Reply to Adarsh Krishna S" aria-label="Reply to Adarsh Krishna S">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-608687" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-608687" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 11, 2021 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608687" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try some data preparation?<br>
Perhaps try an alternate configuration?<br>
Perhaps try an alternate model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-608687" data-commentid="608687" data-postid="3570" data-belowelement="comment-608687" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-610444" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-610444" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/b69ec2ce46b63bf86f1bbf24fb9b0a82.png" srcset="https://secure.gravatar.com/avatar/b69ec2ce46b63bf86f1bbf24fb9b0a82?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Will Zhao</span>
	                <span class="date">May 23, 2021 at 7:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-610444" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Do you know how to modify the model set up so that we can put constraints on the coefficient matrix A? For example, in VAR(1), Yt = (A1) (Yt-1) + E, A1= [a11, a12; a21, a22], how to impose a21 = 0 since I already know one granger cause the other, but not the other way around before running the model? I also want granger causality test to reflect that too. Do you know the solution?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-610444" data-commentid="610444" data-postid="3570" data-belowelement="comment-610444" data-respondelement="respond" data-replyto="Reply to Will Zhao" aria-label="Reply to Will Zhao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-610531" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-610531" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 24, 2021 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-610531" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not off hand, sorry. It may require custom code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-610531" data-commentid="610531" data-postid="3570" data-belowelement="comment-610531" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-614626" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-614626" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/df50881edff3744acf4e0274bac67775.png" srcset="https://secure.gravatar.com/avatar/df50881edff3744acf4e0274bac67775?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shushman</span>
	                <span class="date">June 26, 2021 at 4:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-614626" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks so much for the useful primer! I found lines 18-30 of the final code chunk a bit more verbose than necessary, in part because history ends up being an array of 1-length arrays rather than a flat array.<br>
I rewrote that chunk as follows to get the same output:</p>
<p><code></code><code><br>
history = train[len(train)-window:].flatten()<br>
predictions = list()<br>
for (t, obs) in enumerate(test.flatten()):<br>
    hist_len = len(history)<br>
    lag = np.concatenate(([1.0], np.flip(history[hist_len-window:])))<br>
    prediction = np.dot(coef, lag)<br>
    predictions.append(prediction)<br>
    history = np.append(history, obs)<br>
    print('predicted=%f, expected=%f' % (prediction, obs))<br>
</code><code></code></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-614626" data-commentid="614626" data-postid="3570" data-belowelement="comment-614626" data-respondelement="respond" data-replyto="Reply to Shushman" aria-label="Reply to Shushman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-614636" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-614636" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 26, 2021 at 5:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-614636" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>Thanks for sharing!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-614636" data-commentid="614636" data-postid="3570" data-belowelement="comment-614636" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-620977" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-620977" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/27f6fd539e9319a618ce93b0923c23ad.png" srcset="https://secure.gravatar.com/avatar/27f6fd539e9319a618ce93b0923c23ad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Naser</span>
	                <span class="date">August 9, 2021 at 6:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-620977" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can we have scenario generations with this method? I mean several stochastic scenarios.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-620977" data-commentid="620977" data-postid="3570" data-belowelement="comment-620977" data-respondelement="respond" data-replyto="Reply to Naser" aria-label="Reply to Naser">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-621084" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-621084" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/a0942b56b07831ac15d4a168a750e34a(1).png" srcset="https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 10, 2021 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-621084" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, there are many examples on the blog, you can use the search box.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-621084" data-commentid="621084" data-postid="3570" data-belowelement="comment-621084" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-622970" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-622970" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/49a316f15dcda3d7380178f133bd0527.png" srcset="https://secure.gravatar.com/avatar/49a316f15dcda3d7380178f133bd0527?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jason</span>
	                <span class="date">August 22, 2021 at 3:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-622970" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this. Really good explanation of the AR model given that the article is 4yrs old. I do have a question tho, I have beed using the ARIMA function on statsmodel, the lags and order the same? Meaning you are using the autocorrelations of the past 29 time series to predict the next value? So this comes out as an AR(29) model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-622970" data-commentid="622970" data-postid="3570" data-belowelement="comment-622970" data-respondelement="respond" data-replyto="Reply to Jason" aria-label="Reply to Jason">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-623313" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-623313" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/73a7f07e8fec40c74d091917c1108f7b.png" srcset="https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">August 23, 2021 at 5:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-623313" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you’re referring to one of the example there, you’re correct.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-623313" data-commentid="623313" data-postid="3570" data-belowelement="comment-623313" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-625982" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-625982" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/4de0e1003a8bdcf2066e6f00c2e1fed0.png" srcset="https://secure.gravatar.com/avatar/4de0e1003a8bdcf2066e6f00c2e1fed0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alfred Newerla</span>
	                <span class="date">September 7, 2021 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-625982" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this great tutorial.<br>
Please either correct the filename in the code pieces to read the CSV file<br>
series = read_csv(‘daily-minimum-temperatures.csv’, header=0, index_col=0)<br>
or rename the CSV file itself (currently: daily-min-temperatures.csv) to make filenames consistent and therefore avoiding Python error to not find the file.<br>
Took me a little bit of time to realize why Python couldn’t find the file after downloading and putting in the working directory.<br>
Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-625982" data-commentid="625982" data-postid="3570" data-belowelement="comment-625982" data-respondelement="respond" data-replyto="Reply to Alfred Newerla" aria-label="Reply to Alfred Newerla">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-625997" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-625997" class="comment-container">

					                <div class="avatar"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/73a7f07e8fec40c74d091917c1108f7b.png" srcset="https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40" loading="lazy"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">September 7, 2021 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-625997" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good catch. Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#comment-625997" data-commentid="625997" data-postid="3570" data-belowelement="comment-625997" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="3570" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4b138b35f8"></p><p style="display: none !important;"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js" name="ak_js" value="1635585314098"><script>document.getElementById( "ak_js" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt="" src="./Autoregression Models for Time Series Forecasting With Python_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=176&amp;d=mm&amp;r=g 2x" class="avatar avatar-88 photo" height="88" width="88" loading="lazy"></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="https://machinelearningmastery.com/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 10px; width: 306.325px; height: 68.4px; visibility: hidden;"></div><div id="custom_html-89" class="widget_text widget widget_custom_html" style="top: 10px; width: 306.325px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img width="30" height="30" src="./Autoregression Models for Time Series Forecasting With Python_files/small_icon_blue_linkedin3.webp" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img width="30" height="30" src="./Autoregression Models for Time Series Forecasting With Python_files/small_icon_blue_twitter3.webp" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img width="30" height="30" src="./Autoregression Models for Time Series Forecasting With Python_files/small_icon_blue_facebook3.webp" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/newsletter/"><img width="30" height="30" src="./Autoregression Models for Time Series Forecasting With Python_files/small_icon_blue_email3.webp" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img width="30" height="30" src="./Autoregression Models for Time Series Forecasting With Python_files/small_icon_blue_rss3.webp" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-53_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 108.4px; width: 306.325px; height: 408.4px; visibility: hidden;"></div><div id="custom_html-53" class="widget_text widget widget_custom_html" style="top: 108.4px; width: 306.325px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/"><img width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/ARIMA-Rolling-Forecast-Line-Plot-150x150.webp" class="attachment-thumbnail size-thumbnail wp-post-image" alt="ARIMA Rolling Forecast Line Plot" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/" rel="nofollow">How to Create an ARIMA Model for Time Series Forecasting in Python</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/"><img width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Convert a Time Series to a Supervised Learning Problem in Python" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">How to Convert a Time Series to a Supervised Learning Problem in Python</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/"><img width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" rel="nofollow">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/"><img width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/Time-Series-Forecasting-as-Supervised-Learning-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Time Series Forecasting as Supervised Learning" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">Time Series Forecasting as Supervised Learning</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/"><img width="150" height="150" src="./Autoregression Models for Time Series Forecasting With Python_files/How-To-Backtest-Machine-Learning-Models-for-Time-Series-Forecasting-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How To Backtest Machine Learning Models for Time Series Forecasting" loading="lazy"></a> <a class="title" href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">How To Backtest Machine Learning Models for Time Series Forecasting</a></div></div></div></div><div id="custom_html-18_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 546.8px; width: 306.325px; height: 138.4px; visibility: hidden;"></div><div id="custom_html-18" class="widget_text widget widget_custom_html" style="top: 546.8px; width: 306.325px; position: fixed;"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p></p><h4>Loving the Tutorials?</h4><p></p>

<p>The <a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" rel="nofollow">Time Series with Python</a> EBook is <br>where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" class="woo-sc-button  red"><span class="woo-">&gt;&gt; See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
<script src="./Autoregression Models for Time Series Forecasting With Python_files/embed.js(1).download" data-bar="EKEpUWnBPSNWfo6eafZGYE" data-bar-domain="machinelearningmastery.lpages.co" async="" defer=""></script><script>window.addEventListener('LPBarsReady', function() {
    LPBars.addDelayedBar('EKEpUWnBPSNWfo6eafZGYE', {
      delay:'0s',
      views:0,
      dontShowFor:'0d',
      autoUse: true,
      domain:'machinelearningmastery.lpages.co'});
  });</script>	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2021 Machine Learning Mastery. All Rights Reserved.<br>
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="https://machinelearningmastery.com/newsletter/">Newsletter</a> |
<a href="https://machinelearningmastery.com/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/sitemap/">Sitemap</a> |
<a href="https://machinelearningmastery.com/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script data-cfasync="false" type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/comment-reply.min.js.download" id="comment-reply-js" defer=""></script>
<script data-minify="1" type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/tex-chtml.js.download" id="mathjax-js" defer=""></script>
<script type="text/javascript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="text/javascript" id="rocket-preload-links-js-extra">
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/register\/machine-learning-university\/|\/courses\/\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/|\/courses\/course-get-started\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/lessons\/why-machine-learning-does-not-have-to-be-so-hard\/|\/courses\/course-get-started\/lessons\/how-to-think-about-machine-learning\/|\/courses\/course-get-started\/lessons\/find-your-machine-learning-tribe\/|\/courses\/step-by-step-process\/|\/courses\/probability-for-machine-learning\/|\/account\/|\/register\/|\/courses\/|\/machine-learning-mastery-university-registration\/|\/register\/|\/newsletter\/|\/(.+\/)?feed\/?.+\/?|\/(?:.+\/)?embed\/|\/(index\\.php\/)?wp\\-json(\/.*|$)|\/wp-admin\/|\/logout\/|\/login\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|php|pdf|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="text/javascript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>
<script type="text/javascript" id="q2w3_fixed_widget-js-extra">
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"primary","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":400,"screen_max_height":0,"width_inherit":false,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["custom_html-89","custom_html-50","custom_html-90","custom_html-91","custom_html-58","custom_html-60","custom_html-59","custom_html-84","custom_html-51","custom_html-56","custom_html-55","custom_html-57","custom_html-53","custom_html-54","custom_html-52","custom_html-48","custom_html-49","custom_html-80","custom_html-47","custom_html-85","custom_html-30","custom_html-29","custom_html-28","custom_html-27","custom_html-3","custom_html-24","custom_html-23","custom_html-22","custom_html-21","custom_html-20","custom_html-19","custom_html-18","custom_html-17","custom_html-16","custom_html-15","custom_html-14","custom_html-13","custom_html-11","custom_html-10","custom_html-5","custom_html-9","custom_html-61","custom_html-81","custom_html-86","custom_html-92","custom_html-97"]}];
/* ]]> */
</script>
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/q2w3-fixed-widget.min.js.download" id="q2w3_fixed_widget-js" defer=""></script>
<script type="text/javascript" src="./Autoregression Models for Time Series Forecasting With Python_files/wp-embed.min.js.download" id="wp-embed-js" defer=""></script>
<script type="text/javascript">function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script><script type="text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script async="" data-no-minify="1" src="./Autoregression Models for Time Series Forecasting With Python_files/lazyload.min.js.download" type="text/javascript"></script>

<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me --><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./Autoregression Models for Time Series Forecasting With Python_files/widget_iframe.a53eecb4584348a2ad32ec2ae21f6eae.html" title="Twitter settings iframe" style="display: none;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image classic">
    <div id="drip-header-2211" class="drip-header">
      <a href="https://machinelearningmastery.com/autoregression-models-time-series-forecasting-python/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Start Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -497px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Start Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without math or fancy degrees</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em>&nbsp;course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
              
            </div>
            <dl class="no-labels">
                  <dt class="label-for-type-email">
    Email Address
      <span title="Required"> *</span>
  </dt>
  <dd>
    <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field" id="drip-email-field-2211" tabindex="0">
<div id="drip-errors-for-email-2211" class="drip-errors"></div>

  </dd>

                  <dt class="label-for-type-eu_consent">
    
  </dt>
  <dd>
      <div class="classic--checkbox hidden" data-container="eu-checkbox">
    <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-2211-denied" value="denied" disabled="disabled">
    <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent-2211" value="granted" disabled="disabled">
    <label for="drip-field-eu_consent-2211">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
  </div>

  </dd>

                <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/)." tabindex="-1">

              <div style="display: none;" aria-hidden="true">
  <dt for="website">Website</dt>
  <dd>
    <input type="text" id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false" value="">
  </dd>
</div>

            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
            <div id="drip-errors-for-base-2211" class="drip-errors dfwid-error"></div>

          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix drip-form-success-message" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>
    </div>
  </div>
</div><div class="lp-popup__iframe-wrapper" style="width: 100%;
  height: 100%;
  position: fixed;
  display: none;
  right: 0;
  bottom: 0;
  left: 0;
  top: 0;
  z-index: 999999999;
  box-sizing: border-box;"><iframe class="lp-popup__iframe" scrolling="no" style="width: 100%;
  height: 100%;
  border: none;
  margin: 0;
  padding: 0;" src="./Autoregression Models for Time Series Forecasting With Python_files/saved_resource(1).html" data-leadbox-frame-id="XzMsunYnjcfQ5t8Csvp7z4" data-leadbox-frame-params-key="NO_PARAMS_20160921"></iframe></div><div class="lp-popup__iframe-wrapper" style="width: 100%;
  height: 100%;
  position: fixed;
  display: none;
  right: 0;
  bottom: 0;
  left: 0;
  top: 0;
  z-index: 999999999;
  box-sizing: border-box;"><iframe class="lp-popup__iframe" scrolling="no" style="width: 100%;
  height: 100%;
  border: none;
  margin: 0;
  padding: 0;" src="./Autoregression Models for Time Series Forecasting With Python_files/saved_resource(2).html" data-leadbox-frame-id="7U3pw6gCGRCSM5PTLfhiKQ" data-leadbox-frame-params-key="NO_PARAMS_20160921"></iframe></div><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./Autoregression Models for Time Series Forecasting With Python_files/saved_resource(3).html"></iframe></body></html>